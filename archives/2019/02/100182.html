<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.2.3">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="https://www.ljjyy.com">
    <!--SEO-->

    <meta name="keywords" content="web,javascript,dom">


    <meta name="description" content="前言本文主要介绍DOM事件级别、DOM事件模型、事件流、事件代理和Event对象常见的应用，希望对你们有些帮助和启发！
一、DOM事件级别DOM级别一共可以分为四个级别：DOM0级、DOM1级、...">



<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">

    <!--Title-->


<title>全面阐析Javascript DOM事件机制 | 来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</title>


    <link rel="alternate" href="/atom.xml" title="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
	<div class="hide">
        <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
        <script>LA.init({id: "JgbNOaw1xxsmUUsQ",ck: "JgbNOaw1xxsmUUsQ"})</script>
	</div>






    
    <meta name="baidu-site-verification" content="dTHILoORpx">


    <script>
        (function(){
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  >
    <div class="main-header-box">
        <!--a class="header-avatar" href="/" title='Ljjyy.com'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a-->
        <div class="branding">
            
                <h2> 多读书多实践，勤思考善领悟 </h2>
            
    	  </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">

        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="web-logo"  href="/" title='Ljjyy.com'></a>
                    <!--a class="navbar-brand" href="https://www.ljjyy.com">来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</a-->
                </div>
                <div class="collapse navbar-collapse" id="main-menu" style="">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/cloud/"><i class="fa "></i>云计算</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/front/"><i class="fa "></i>前端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/back/"><i class="fa "></i>后端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/devops/"><i class="fa "></i>运维</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/crack/"><i class="fa "></i>破解</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/penetration/"><i class="fa "></i>渗透</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/tool/"><i class="fa "></i>工具</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/other/"><i class="fa "></i>其他</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="全面阐析Javascript DOM事件机制">
            
	            全面阐析Javascript DOM事件机制
            
        </h1>
        <div class="post-meta">
    
        <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
            <a class="category-link" href="/categories/front/">前端</a>
        </span>
    

    
        <span class="fa-wrap">
            <i class="fa fa-tags"></i>
            <span class="tags-meta">
                
                    <a class="tag-link" href="/tags/dom/">dom</a> <a class="tag-link" href="/tags/javascript/">javascript</a> <a class="tag-link" href="/tags/web/">web</a>
                
            </span>
        </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2019/02/08</span>
        </span>
        
    
</div>
            
            
            <p class="fa fa-exclamation-triangle warning">
                本文于<strong>1985</strong>天之前发表，文中内容可能已经过时。
            </p>
        
    </div>
    
    <div class="post-body post-content">
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文主要介绍DOM事件级别、DOM事件模型、事件流、事件代理和Event对象常见的应用，希望对你们有些帮助和启发！</p>
<h2 id="一、DOM事件级别"><a href="#一、DOM事件级别" class="headerlink" title="一、DOM事件级别"></a>一、DOM事件级别</h2><p>DOM级别一共可以分为四个级别：DOM0级、DOM1级、DOM2级和DOM3级。而<strong>DOM事件分为3个级别：DOM 0级事件处理，DOM 2级事件处理和DOM 3级事件处理</strong>。由于DOM 1级中没有事件的相关内容，所以没有DOM 1级事件。</p>
<h3 id="1-DOM-0级事件"><a href="#1-DOM-0级事件" class="headerlink" title="1.DOM 0级事件"></a>1.DOM 0级事件</h3><p><strong>el.onclick=function(){}</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例1</span></span><br><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>);</span><br><span class="line"> btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     alert(<span class="keyword">this</span>.innerHTML);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><strong>当希望为同一个元素/标签绑定多个同类型事件的时候（如给上面的这个btn元素绑定3个点击事件），是不被允许的</strong>。DOM0事件绑定，给元素的事件行为绑定方法，<strong>这些方法都是在当前元素事件行为的冒泡阶段(或者目标阶段)执行的</strong>。</p>
<h3 id="2-DOM-2级事件"><a href="#2-DOM-2级事件" class="headerlink" title="2.DOM 2级事件"></a>2.DOM 2级事件</h3><p><strong>el.addEventListener(event-name, callback, useCapture)</strong></p>
<ul>
<li>event-name: 事件名称，可以是标准的DOM事件</li>
<li>callback: 回调函数，当事件触发时，函数会被注入一个参数为当前的事件对象 event</li>
<li><strong>useCapture: 默认是false，代表事件句柄在冒泡阶段执行</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例2</span></span><br><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>);</span><br><span class="line">btn.addEventListener(<span class="string">"click"</span>, test, <span class="literal">false</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">	e = e || <span class="built_in">window</span>.event;</span><br><span class="line">    alert((e.target || e.srcElement).innerHTML);</span><br><span class="line">    btn.removeEventListener(<span class="string">"click"</span>, test)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//IE9-:attachEvent()与detachEvent()。</span></span><br><span class="line"><span class="comment">//IE9+/chrom/FF:addEventListener()和removeEventListener()</span></span><br></pre></td></tr></table></figure>
<p>IE9以下的IE浏览器不支持 addEventListener()和removeEventListener()，使用 attachEvent()与detachEvent() 代替，因为IE9以下是不支持事件捕获的，所以也没有第三个参数，第一个事件名称前要加on。</p>
<h3 id="3-DOM-3级事件"><a href="#3-DOM-3级事件" class="headerlink" title="3.DOM 3级事件"></a>3.DOM 3级事件</h3><p>在DOM 2级事件的基础上添加了更多的事件类型。</p>
<ul>
<li>UI事件，当用户与页面上的元素交互时触发，如：load、scroll</li>
<li>焦点事件，当元素获得或失去焦点时触发，如：blur、focus</li>
<li>鼠标事件，当用户通过鼠标在页面执行操作时触发如：dblclick、mouseup</li>
<li>滚轮事件，当使用鼠标滚轮或类似设备时触发，如：mousewheel</li>
<li>文本事件，当在文档中输入文本时触发，如：textInput</li>
<li>键盘事件，当用户通过键盘在页面上执行操作时触发，如：keydown、keypress</li>
<li>合成事件，当为IME（输入法编辑器）输入字符时触发，如：compositionstart</li>
<li>变动事件，当底层DOM结构发生变化时触发，如：DOMsubtreeModified</li>
<li>同时DOM3级事件也允许使用者自定义一些事件。</li>
</ul>
<h2 id="二、DOM事件模型和事件流"><a href="#二、DOM事件模型和事件流" class="headerlink" title="二、DOM事件模型和事件流"></a>二、DOM事件模型和事件流</h2><p><strong>DOM事件模型分为捕获和冒泡</strong>。一个事件发生后，会在子元素和父元素之间传播（propagation）。这种传播分成三个阶段。</p>
<p>（1）捕获阶段：事件从window对象自上而下向目标节点传播的阶段；</p>
<p>（2）目标阶段：真正的目标节点正在处理事件的阶段；</p>
<p>（3）冒泡阶段：事件从目标节点自下而上向window对象传播的阶段。</p>
<h3 id="DOM事件捕获的具体流程"><a href="#DOM事件捕获的具体流程" class="headerlink" title="DOM事件捕获的具体流程"></a>DOM事件捕获的具体流程</h3><p><img src="/img/fronts/e6726733d3332363530.png" alt="img"></p>
<p>捕获是从上到下，事件先从window对象，然后再到document（对象），然后是html标签（通过document.documentElement获取html标签），然后是body标签（通过document.body获取body标签），然后按照普通的html结构一层一层往下传，最后到达目标元素。</p>
<p>而事件冒泡的流程刚好是事件捕获的逆过程。<br>接下来我们看个事件冒泡的例子：</p>
<figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例3</span></span><br><span class="line">&lt;div id=<span class="string">"outer"</span>&gt;</span><br><span class="line">    &lt;div id=<span class="string">"inner"</span>&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">......</span><br><span class="line">window.onclick = <span class="function"><span class="keyword">function</span><span class="params">()</span> &#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'window'</span>);</span><br><span class="line">&#125;;</span><br><span class="line">document.onclick = <span class="function"><span class="keyword">function</span><span class="params">()</span> &#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'document'</span>);</span><br><span class="line">&#125;;</span><br><span class="line">document.documentElement.onclick = <span class="function"><span class="keyword">function</span><span class="params">()</span> &#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'html'</span>);</span><br><span class="line">&#125;;</span><br><span class="line">document.body.onclick = <span class="function"><span class="keyword">function</span><span class="params">()</span> &#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'body'</span>);</span><br><span class="line">&#125;</span><br><span class="line">outer.onclick = <span class="function"><span class="keyword">function</span><span class="params">(ev)</span> &#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'outer'</span>);</span><br><span class="line">&#125;;</span><br><span class="line">inner.onclick = <span class="function"><span class="keyword">function</span><span class="params">(ev)</span> &#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'inner'</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="/img/fronts/06e6726733d33393936.png" alt="img"></p>
<p>正如我们上面提到的onclick给元素的事件行为绑定方法都是在当前元素事件行为的冒泡阶段(或者目标阶段)执行的。</p>
<h2 id="三、事件代理-事件委托"><a href="#三、事件代理-事件委托" class="headerlink" title="三、事件代理(事件委托)"></a>三、事件代理(事件委托)</h2><p>由于事件会在冒泡阶段向上传播到父节点，因此可以把子节点的监听函数定义在父节点上，由父节点的监听函数统一处理多个子元素的事件。这种方法叫做事件的代理（delegation）。</p>
<h3 id="1-优点"><a href="#1-优点" class="headerlink" title="1.优点"></a>1.优点</h3><ul>
<li>减少内存消耗，提高性能</li>
</ul>
<p>假设有一个列表，列表之中有大量的列表项，我们需要在点击每个列表项的时候响应一个事件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 例4</span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  ......</span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item n<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果给每个列表项一一都绑定一个函数，那对于内存消耗是非常大的，效率上需要消耗很多性能。借助事件代理，我们只需要给父容器ul绑定方法即可，这样不管点击的是哪一个后代元素，都会根据冒泡传播的传递机制，把容器的click行为触发，然后把对应的方法执行，根据事件源，我们可以知道点击的是谁，从而完成不同的事。</p>
<ul>
<li>动态绑定事件</li>
</ul>
<p>在很多时候，我们需要通过用户操作动态的增删列表项元素，如果一开始给每个子元素绑定事件，那么在列表发生变化时，就需要重新给新增的元素绑定事件，给即将删去的元素解绑事件，如果用事件代理就会省去很多这样麻烦。</p>
<h3 id="2-如何实现"><a href="#2-如何实现" class="headerlink" title="2.如何实现"></a>2.如何实现</h3><p>接下来我们来实现上例中父层元素 #list 下的 li 元素的事件委托到它的父层元素上：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 给父层元素绑定事件</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'list'</span>).addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 兼容性处理</span></span><br><span class="line">  <span class="keyword">var</span> event = e || <span class="built_in">window</span>.event;</span><br><span class="line">  <span class="keyword">var</span> target = event.target || event.srcElement;</span><br><span class="line">  <span class="comment">// 判断是否匹配目标元素</span></span><br><span class="line">  <span class="keyword">if</span> (target.nodeName.toLocaleLowerCase === <span class="string">'li'</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'the content is: '</span>, target.innerHTML);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="四、Event对象常见的应用"><a href="#四、Event对象常见的应用" class="headerlink" title="四、Event对象常见的应用"></a>四、Event对象常见的应用</h2><ul>
<li>event. preventDefault()</li>
</ul>
<p><strong>如果调用这个方法，默认事件行为将不再触发</strong>。什么是默认事件呢？例如表单一点击提交按钮(submit)跳转页面、a标签默认页面跳转或是锚点定位等。</p>
<p>很多时候我们使用a标签仅仅是想当做一个普通的按钮，点击实现一个功能，不想页面跳转，也不想锚点定位。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法一：</span></span><br><span class="line">&lt;<span class="selector-tag">a</span> href=<span class="string">"javascript:;"</span>&gt;链接&lt;/a&gt;</span><br></pre></td></tr></table></figure>
<p>也可以通过JS方法来阻止，给其click事件绑定方法，当我们点击A标签的时候，先触发click事件，其次才会执行自己的默认行为</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//方法二:</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"test"</span> <span class="attr">href</span>=<span class="string">"http://www.cnblogs.com"</span>&gt;</span>链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">test.onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">    e = e || <span class="built_in">window</span>.event;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">//方法三：</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"test"</span> <span class="attr">href</span>=<span class="string">"http://www.cnblogs.com"</span>&gt;</span>链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">test.onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">    e = e || <span class="built_in">window</span>.event;</span></span><br><span class="line"><span class="undefined">    e.preventDefault();</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>接下来我们看个例子：输入框最多只能输入六个字符，如何实现？</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 例5</span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">'tempInp'</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">    tempInp.onkeydown = <span class="function"><span class="keyword">function</span><span class="params">(ev)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        ev = ev || <span class="built_in">window</span>.event;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> val = <span class="keyword">this</span>.value.trim() <span class="comment">//trim去除字符串首位空格（不兼容）</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// this.value=this.value.replace(/^ +| +$/g,'') 兼容写法</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> len = val.length</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">if</span> (len &gt;= <span class="number">6</span>) &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.value = val.substr(<span class="number">0</span>, <span class="number">6</span>);</span></span><br><span class="line"><span class="actionscript">            <span class="comment">//阻止默认行为去除特殊按键（DELETE\BACK-SPACE\方向键...）</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">let</span> code = ev.which || ev.keyCode;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (!<span class="regexp">/^(46|8|37|38|39|40)$/</span>.test(code)) &#123;</span></span><br><span class="line"><span class="undefined">                ev.preventDefault()</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"> </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>event.stopPropagation() &amp; event.stopImmediatePropagation()</li>
</ul>
<p><strong>event.stopPropagation() 方法阻止事件冒泡到父元素，阻止任何父事件处理程序被执行</strong>。上面提到事件冒泡阶段是指事件从目标节点自下而上向window对象传播的阶段。<br>我们在例3的inner元素click事件上，添加<code>event.stopPropagation()</code>这句话后，就阻止了父事件的执行，最后只打印了’inner’。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> inner.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'inner'</span>);</span><br><span class="line">    ev.stopPropagation();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>stopImmediatePropagation 既能阻止事件向父元素冒泡，也能阻止元素同事件类型的其它监听器被触发。而 stopPropagation 只能实现前者的效果</strong>。我们来看个例子：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;button id=<span class="string">"btn"</span>&gt;click me to stop propagation&lt;/button&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">......</span><br><span class="line">const btn = <span class="built_in">document</span>.querySelector(<span class="string">'#btn'</span>);</span><br><span class="line">btn.addEventListener(<span class="string">'click'</span>, event =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'btn click 1'</span>);</span><br><span class="line">  event.stopImmediatePropagation();</span><br><span class="line">&#125;);</span><br><span class="line">btn.addEventListener(<span class="string">'click'</span>, event =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'btn click 2'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">document</span>.body.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'body click'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="regexp">//</span> btn click <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>如上所示，使用 stopImmediatePropagation后，点击按钮时，不仅body绑定事件不会触发，与此同时按钮的另一个点击事件也不触发。</p>
<ul>
<li>event.target &amp; event.currentTarget</li>
</ul>
<p>老实说这两者的区别，并不好用文字描述，我们先来看个例子：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="selector-tag">div</span> id=<span class="string">"a"</span>&gt;</span><br><span class="line">  &lt;<span class="selector-tag">div</span> id=<span class="string">"b"</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">div</span> id=<span class="string">"c"</span>&gt;&lt;<span class="selector-tag">div</span> id=<span class="string">"d"</span>&gt;&lt;/div&gt;&lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  document.getElementById(<span class="string">'a'</span>).addEventListener(<span class="string">'click'</span>, function(e) &#123;</span><br><span class="line">    console.log(</span><br><span class="line">      <span class="string">'target:'</span> + e<span class="selector-class">.target</span><span class="selector-class">.id</span> + <span class="string">'&amp;currentTarget:'</span> + e<span class="selector-class">.currentTarget</span><span class="selector-class">.id</span></span><br><span class="line">    )</span><br><span class="line">  &#125;)</span><br><span class="line">  document.getElementById(<span class="string">'b'</span>).addEventListener(<span class="string">'click'</span>, function(e) &#123;</span><br><span class="line">    console.log(</span><br><span class="line">      <span class="string">'target:'</span> + e<span class="selector-class">.target</span><span class="selector-class">.id</span> + <span class="string">'&amp;currentTarget:'</span> + e<span class="selector-class">.currentTarget</span><span class="selector-class">.id</span></span><br><span class="line">    )</span><br><span class="line">  &#125;)</span><br><span class="line">  document.getElementById(<span class="string">'c'</span>).addEventListener(<span class="string">'click'</span>, function(e) &#123;</span><br><span class="line">    console.log(</span><br><span class="line">      <span class="string">'target:'</span> + e<span class="selector-class">.target</span><span class="selector-class">.id</span> + <span class="string">'&amp;currentTarget:'</span> + e<span class="selector-class">.currentTarget</span><span class="selector-class">.id</span></span><br><span class="line">    )</span><br><span class="line">  &#125;)</span><br><span class="line">  document.getElementById(<span class="string">'d'</span>).addEventListener(<span class="string">'click'</span>, function(e) &#123;</span><br><span class="line">    console.log(</span><br><span class="line">      <span class="string">'target:'</span> + e<span class="selector-class">.target</span><span class="selector-class">.id</span> + <span class="string">'&amp;currentTarget:'</span> + e<span class="selector-class">.currentTarget</span><span class="selector-class">.id</span></span><br><span class="line">    )</span><br><span class="line">  &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/img/fronts/et313033313433.gif" alt="img"></p>
<p>当我们点击最里层的元素d的时候，会依次输出:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">target</span><span class="selector-pseudo">:d</span>&amp;<span class="selector-tag">currentTarget</span><span class="selector-pseudo">:d</span></span><br><span class="line"><span class="selector-tag">target</span><span class="selector-pseudo">:d</span>&amp;<span class="selector-tag">currentTarget</span><span class="selector-pseudo">:c</span></span><br><span class="line"><span class="selector-tag">target</span><span class="selector-pseudo">:d</span>&amp;<span class="selector-tag">currentTarget</span><span class="selector-pseudo">:b</span></span><br><span class="line"><span class="selector-tag">target</span><span class="selector-pseudo">:d</span>&amp;<span class="selector-tag">currentTarget</span><span class="selector-pseudo">:a</span></span><br></pre></td></tr></table></figure>
<p>从输出中我们可以看到，<code>event.target</code>指向引起触发事件的元素，而<code>event.currentTarget</code>则是事件绑定的元素，只有被点击的那个目标元素的<code>event.target</code>才会等于<code>event.currentTarget</code>。<strong>也就是说，event.currentTarget始终是监听事件者，而event.target是事件的真正发出者</strong>。</p>
<h2 id="五、参考文章"><a href="#五、参考文章" class="headerlink" title="五、参考文章"></a>五、参考文章</h2><ul>
<li><a href="https://www.jianshu.com/p/622d994906f7" target="_blank" rel="noopener">DOM级别与DOM事件</a></li>
<li><a href="http://coderlt.coding.me/2016/11/22/js-event/" target="_blank" rel="noopener">DOM事件机制解惑</a></li>
<li><a href="http://javascript.ruanyifeng.com/dom/event.html" target="_blank" rel="noopener">事件模型</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/26536815" target="_blank" rel="noopener">JavaScript 事件委托详解</a></li>
<li><a href="http://www.wenkanglin.com/2018/05/JavaScript事件的学与记：stopPropagation和stopImmediatePropagation/" target="_blank" rel="noopener">JavaScript 事件的学与记：stopPropagation 和 stopImmediatePropagation</a></li>
<li><a href="http://www.calledt.com/target-and-currenttarget/" target="_blank" rel="noopener">event.target和event.currentTarget的区别</a></li>
</ul>

    </div>
    
    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="/" target="_blank">Ljjyy.com</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/archives/2019/02/100183.html" class="pre-post btn btn-default" title='全面阐析JavaScript this关键字'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">全面阐析JavaScript this关键字</span>
        </a>
    
    
        <a href="/archives/2019/02/100181.html" class="next-post btn btn-default" title='全面阐析JavaScript垃圾回收和内存泄漏'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">全面阐析JavaScript垃圾回收和内存泄漏</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
    <div id="vcomments" class="valine"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>

    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: '5MzTXYXkt03k101j0PmSDN34-gzGzoHsz',
            appKey: 'iwjYgwno6qj3wtDVVSbe8nYQ',
            placeholder: '说点什么吧',
            notify: false,
            verify: true,
            avatar: 'mm',
            meta: 'nick,mail'.split(','),
            pageSize: '10',
            path: window.location.pathname,
            lang: 'zh-CN'.toLowerCase()
        })
    </script>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一、DOM事件级别"><span class="toc-text">一、DOM事件级别</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-DOM-0级事件"><span class="toc-text">1.DOM 0级事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-DOM-2级事件"><span class="toc-text">2.DOM 2级事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-DOM-3级事件"><span class="toc-text">3.DOM 3级事件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、DOM事件模型和事件流"><span class="toc-text">二、DOM事件模型和事件流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DOM事件捕获的具体流程"><span class="toc-text">DOM事件捕获的具体流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、事件代理-事件委托"><span class="toc-text">三、事件代理(事件委托)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-优点"><span class="toc-text">1.优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-如何实现"><span class="toc-text">2.如何实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、Event对象常见的应用"><span class="toc-text">四、Event对象常见的应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、参考文章"><span class="toc-text">五、参考文章</span></a></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2019-2024&emsp;<a href="/" class="copyright-links" target="_blank" rel="nofollow">Ljjyy.com</a>
                </span> |
                <span>
                    <a href="/about/" class="copyright-links" target="_blank" rel="nofollow">关于我们</a>
                </span> |                
                <span>
                    <a href="/sitemap.xml" class="copyright-links" target="_blank" rel="nofollow">网站地图</a>
                </span> |
                <span>
                    <a href="/archives/" class="copyright-links" target="_blank" rel="nofollow">时间轴</a>
                </span>              
            </div>
        </div>
    </div>
</div>







<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>