<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.2.3">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="https://www.ljjyy.com">
    <!--SEO-->

    <meta name="keywords" content="区块链,fabric">


    <meta name="description" content="
fabric v1.4 , 单机 多节点 kafka 手动部署, 所有服务均 开启 SSL 认证。

一. 部署 hyperledger-fabric v1.41. 环境规划
相关hostna...">



<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">

    <!--Title-->


<title>部署 hyperledger-fabric v1.4 | 来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</title>


    <link rel="alternate" href="/atom.xml" title="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
	<div class="hide">
        <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
        <script>LA.init({id: "JgbNOaw1xxsmUUsQ",ck: "JgbNOaw1xxsmUUsQ"})</script>
	</div>






    
    <meta name="baidu-site-verification" content="dTHILoORpx">


    <script>
        (function(){
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  >
    <div class="main-header-box">
        <!--a class="header-avatar" href="/" title='Ljjyy.com'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a-->
        <div class="branding">
            
                <h2> 多读书多实践，勤思考善领悟 </h2>
            
    	  </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">

        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="web-logo"  href="/" title='Ljjyy.com'></a>
                    <!--a class="navbar-brand" href="https://www.ljjyy.com">来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</a-->
                </div>
                <div class="collapse navbar-collapse" id="main-menu" style="">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/cloud/"><i class="fa "></i>云计算</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/front/"><i class="fa "></i>前端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/back/"><i class="fa "></i>后端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/devops/"><i class="fa "></i>运维</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/crack/"><i class="fa "></i>破解</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/penetration/"><i class="fa "></i>渗透</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/tool/"><i class="fa "></i>工具</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/other/"><i class="fa "></i>其他</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="部署 hyperledger-fabric v1.4">
            
	            部署 hyperledger-fabric v1.4
            
        </h1>
        <div class="post-meta">
    
        <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
            <a class="category-link" href="/categories/cloud/">云计算</a>
        </span>
    

    
        <span class="fa-wrap">
            <i class="fa fa-tags"></i>
            <span class="tags-meta">
                
                    <a class="tag-link" href="/tags/fabric/">fabric</a> <a class="tag-link" href="/tags/blockchain/">区块链</a>
                
            </span>
        </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2019/11/28</span>
        </span>
        
    
</div>
            
            
            <p class="fa fa-exclamation-triangle warning">
                本文于<strong>1225</strong>天之前发表，文中内容可能已经过时。
            </p>
        
    </div>
    
    <div class="post-body post-content">
        <blockquote>
<p>fabric v1.4 , 单机 多节点 kafka 手动部署, 所有服务均 开启 SSL 认证。</p>
</blockquote>
<h1 id="一-部署-hyperledger-fabric-v1-4"><a href="#一-部署-hyperledger-fabric-v1-4" class="headerlink" title="一. 部署 hyperledger-fabric v1.4"></a>一. 部署 hyperledger-fabric v1.4</h1><h2 id="1-环境规划"><a href="#1-环境规划" class="headerlink" title="1. 环境规划"></a>1. 环境规划</h2><blockquote>
<p>相关hostname 必须配置 dns</p>
<p>关于 orderer 集群</p>
<p>当orderer 向peer节点提交Transaction的时候，peer节点会得到或返回一个读写集结果，该结果会发送给orderer节点进行共识和排序，此时如果orderer节点突然down掉，就会使请求服务失效而引发的数据丢失等问题，且目前的sdk对orderer发送的Transaction的回调会占用极长的时间，当大批量数据导入的时候该回调可认为不可用。</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:left">节点标识</th>
<th style="text-align:left">hostname</th>
<th style="text-align:left">IP</th>
<th style="text-align:left">开放端口</th>
<th style="text-align:left">系统</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">orderer0节点</td>
<td style="text-align:left">orderer0.jicki.me</td>
<td style="text-align:left">192.168.100.100</td>
<td style="text-align:left">7050</td>
<td style="text-align:left">CentOS 7 x64</td>
</tr>
<tr>
<td style="text-align:left">peer0节点</td>
<td style="text-align:left">peer0.org1.jicki.me</td>
<td style="text-align:left">192.168.100.100</td>
<td style="text-align:left">7051, 7052, 7053</td>
<td style="text-align:left">CentOS 7 x64</td>
</tr>
<tr>
<td style="text-align:left">peer0节点</td>
<td style="text-align:left">peer0.org2.jicki.me</td>
<td style="text-align:left">192.168.100.100</td>
<td style="text-align:left">7051, 7052, 7053</td>
<td style="text-align:left">CentOS 7 x64</td>
</tr>
<tr>
<td style="text-align:left">zk0节点</td>
<td style="text-align:left">zookeeper0</td>
<td style="text-align:left">192.168.100.100</td>
<td style="text-align:left">2181</td>
<td style="text-align:left">CentOS 7 x64</td>
</tr>
<tr>
<td style="text-align:left">zk1节点</td>
<td style="text-align:left">zookeeper1</td>
<td style="text-align:left">192.168.100.100</td>
<td style="text-align:left">2181</td>
<td style="text-align:left">CentOS 7 x64</td>
</tr>
<tr>
<td style="text-align:left">zk2节点</td>
<td style="text-align:left">zookeeper2</td>
<td style="text-align:left">192.168.100.100</td>
<td style="text-align:left">2181</td>
<td style="text-align:left">CentOS 7 x64</td>
</tr>
<tr>
<td style="text-align:left">kafka0节点</td>
<td style="text-align:left">kafka0</td>
<td style="text-align:left">192.168.100.100</td>
<td style="text-align:left">9092</td>
<td style="text-align:left">CentOS 7 x64</td>
</tr>
<tr>
<td style="text-align:left">kafka1节点</td>
<td style="text-align:left">kafka1</td>
<td style="text-align:left">192.168.100.100</td>
<td style="text-align:left">9092</td>
<td style="text-align:left">CentOS 7 x64</td>
</tr>
<tr>
<td style="text-align:left">kafka2节点</td>
<td style="text-align:left">kafka2</td>
<td style="text-align:left">192.168.100.100</td>
<td style="text-align:left">9092</td>
<td style="text-align:left">CentOS 7 x64</td>
</tr>
</tbody>
</table>
<h2 id="2-官方地址"><a href="#2-官方地址" class="headerlink" title="2. 官方地址"></a>2. 官方地址</h2><blockquote>
<p>文档以官方文档为主 <a href="http://hyperledger-fabric.readthedocs.io/en/release-1.4/prereqs.html" target="_blank" rel="noopener">http://hyperledger-fabric.readthedocs.io/en/release-1.4/prereqs.html</a></p>
</blockquote>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 官网 github</span></span><br><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/hyperledger/</span>fabric</span><br></pre></td></tr></table></figure>
<h2 id="3-环境准备"><a href="#3-环境准备" class="headerlink" title="3. 环境准备"></a>3. 环境准备</h2><blockquote>
<p>所有机器 安装 Docker (用于 fabric 服务启动)</p>
</blockquote>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 导入 yum 源</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># 安装 yum-config-manager</span></span><br><span class="line"></span><br><span class="line">yum -y install yum-utils</span><br><span class="line"></span><br><span class="line"><span class="meta"># 导入</span></span><br><span class="line">yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https:<span class="comment">//download.docker.com/linux/centos/docker-ce.repo</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="meta"># 安装 docker</span></span><br><span class="line"></span><br><span class="line">yum -y install docker-ce</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动 docker </span></span><br><span class="line"></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl start docker</span><br><span class="line">systemctl <span class="builtin-name">enable</span> docker</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 docker 版本</span></span><br><span class="line"></span><br><span class="line"><span class="string">docker</span> <span class="string">version</span></span><br><span class="line"><span class="attr">Client:</span> <span class="string">Docker</span> <span class="string">Engine</span> <span class="bullet">-</span> <span class="string">Community</span></span><br><span class="line"><span class="attr"> Version:</span>           <span class="number">19.03</span><span class="number">.4</span></span><br><span class="line"> <span class="string">API</span> <span class="attr">version:</span>       <span class="number">1.40</span></span><br><span class="line"> <span class="string">Go</span> <span class="attr">version:</span>        <span class="string">go1.12.10</span></span><br><span class="line"> <span class="string">Git</span> <span class="attr">commit:</span>        <span class="number">9013</span><span class="string">bf583a</span></span><br><span class="line"><span class="attr"> Built:</span>             <span class="string">Fri</span> <span class="string">Oct</span> <span class="number">18</span> <span class="number">15</span><span class="string">:52:22</span> <span class="number">2019</span></span><br><span class="line"> <span class="string">OS/Arch:</span>           <span class="string">linux/amd64</span></span><br><span class="line"><span class="attr"> Experimental:</span>      <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Server:</span> <span class="string">Docker</span> <span class="string">Engine</span> <span class="bullet">-</span> <span class="string">Community</span></span><br><span class="line"><span class="attr"> Engine:</span></span><br><span class="line"><span class="attr">  Version:</span>          <span class="number">19.03</span><span class="number">.4</span></span><br><span class="line">  <span class="string">API</span> <span class="attr">version:</span>      <span class="number">1.40</span> <span class="string">(minimum</span> <span class="string">version</span> <span class="number">1.12</span><span class="string">)</span></span><br><span class="line">  <span class="string">Go</span> <span class="attr">version:</span>       <span class="string">go1.12.10</span></span><br><span class="line">  <span class="string">Git</span> <span class="attr">commit:</span>       <span class="number">9013</span><span class="string">bf583a</span></span><br><span class="line"><span class="attr">  Built:</span>            <span class="string">Fri</span> <span class="string">Oct</span> <span class="number">18</span> <span class="number">15</span><span class="string">:50:54</span> <span class="number">2019</span></span><br><span class="line">  <span class="string">OS/Arch:</span>          <span class="string">linux/amd64</span></span><br><span class="line"><span class="attr">  Experimental:</span>     <span class="literal">false</span></span><br><span class="line"><span class="attr"> containerd:</span></span><br><span class="line"><span class="attr">  Version:</span>          <span class="number">1.2</span><span class="number">.10</span></span><br><span class="line"><span class="attr">  GitCommit:</span>        <span class="string">b34a5c8af56e510852c35414db4c1f4fa6172339</span></span><br><span class="line"><span class="attr"> runc:</span></span><br><span class="line"><span class="attr">  Version:</span>          <span class="number">1.0</span><span class="number">.0</span><span class="bullet">-rc8+dev</span></span><br><span class="line"><span class="attr">  GitCommit:</span>        <span class="number">3e425</span><span class="string">f80a8c931f88e6d94a8c831b9d5aa481657</span></span><br><span class="line"><span class="attr"> docker-init:</span></span><br><span class="line"><span class="attr">  Version:</span>          <span class="number">0.18</span><span class="number">.0</span></span><br><span class="line"><span class="attr">  GitCommit:</span>        <span class="string">fec3683</span></span><br></pre></td></tr></table></figure>
<ul>
<li>安装 Docker-compose (用于 docker 容器服务统一管理 编排)</li>
</ul>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 pip</span></span><br><span class="line"></span><br><span class="line"><span class="string">curl </span><span class="string">https:</span>//<span class="string">bootstrap.</span><span class="string">pypa.</span><span class="string">io/</span><span class="built_in">get-pip.py</span> -o <span class="built_in">get-pip.py</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="built_in">python</span> <span class="built_in">get-pip.py</span></span><br></pre></td></tr></table></figure>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 docker-compose</span></span><br><span class="line"></span><br><span class="line">pip <span class="keyword">install </span>docker-compose --ignore-<span class="keyword">installed </span>requests</span><br></pre></td></tr></table></figure>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -L <span class="string">"https://github.com/docker/compose/releases/download/1.25.0/docker-compose-$(uname -s)-$(uname -m)"</span> -o <span class="regexp">/usr/</span>local<span class="regexp">/bin/</span>docker-compose</span><br><span class="line"></span><br><span class="line">chmod +x <span class="regexp">/usr/</span>local<span class="regexp">/bin/</span>docker-compose</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">docker-compose</span> <span class="selector-tag">version</span></span><br><span class="line"><span class="selector-tag">docker-compose</span> <span class="selector-tag">version</span> 1<span class="selector-class">.24</span><span class="selector-class">.1</span>, <span class="selector-tag">build</span> 4667896</span><br><span class="line"><span class="selector-tag">docker-py</span> <span class="selector-tag">version</span>: 3<span class="selector-class">.7</span><span class="selector-class">.3</span></span><br><span class="line"><span class="selector-tag">CPython</span> <span class="selector-tag">version</span>: 2<span class="selector-class">.7</span><span class="selector-class">.5</span></span><br><span class="line"><span class="selector-tag">OpenSSL</span> <span class="selector-tag">version</span>: <span class="selector-tag">OpenSSL</span> 1<span class="selector-class">.0</span><span class="selector-class">.2k-fips</span>  26 <span class="selector-tag">Jan</span> 2017</span><br></pre></td></tr></table></figure>
<h2 id="4-Hyperledger-Fabric-源码"><a href="#4-Hyperledger-Fabric-源码" class="headerlink" title="4. Hyperledger Fabric 源码"></a>4. Hyperledger Fabric 源码</h2><blockquote>
<p>fabric 源码用于 cli 智能合约安装时的依赖, 这里只用于第一个节点</p>
</blockquote>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载 Fabric 源码, 源码中 import 的路径为github.com/hyperledger/fabric ,所以我们要按照这个路径</span></span><br><span class="line"></span><br><span class="line">mkdir -p /opt/gopath/src/github.com/hyperledger</span><br><span class="line"></span><br><span class="line">cd /opt/gopath/src/github.com/hyperledger</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">git clone https://github.com/hyperledger/fabric</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看分支</span></span><br><span class="line">git branch -a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看本地分支</span></span><br><span class="line">git branch</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换分支</span></span><br><span class="line">git checkout -b release-1.4 remotes/origin/release-1.4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件如下:</span></span><br><span class="line"></span><br><span class="line">[root@localhost fabric]<span class="comment"># ls -lt</span></span><br><span class="line">total 1420</span><br><span class="line">drwxr-xr-x <span class="number"> 3 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>11:19 sampleconfig</span><br><span class="line">drwxr-xr-x <span class="number"> 9 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 vendor</span><br><span class="line">drwxr-xr-x <span class="number"> 8 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 token</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root   <span class="number"> 495 </span>Oct<span class="number"> 29 </span>09:48 tox.ini</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 unit-test</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root  <span class="number"> 3816 </span>Oct<span class="number"> 29 </span>09:48 testingInfo.rst</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root<span class="number"> 438053 </span>Oct<span class="number"> 29 </span>09:48 test-pyramid.png</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 scripts</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root   <span class="number"> 316 </span>Oct<span class="number"> 29 </span>09:48 settings.gradle</span><br><span class="line">drwxr-xr-x <span class="number"> 3 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 release</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 release_notes</span><br><span class="line">drwxr-xr-x<span class="number"> 14 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 protos</span><br><span class="line">drwxr-xr-x<span class="number"> 11 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 peer</span><br><span class="line">drwxr-xr-x <span class="number"> 6 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 orderer</span><br><span class="line">drwxr-xr-x <span class="number"> 6 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 msp</span><br><span class="line">drwxr-xr-x<span class="number"> 13 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 integration</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 idemix</span><br><span class="line">drwxr-xr-x <span class="number"> 8 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 images</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root  <span class="number"> 2999 </span>Oct<span class="number"> 29 </span>09:48 gotools.mk</span><br><span class="line">drwxr-xr-x<span class="number"> 17 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 gossip</span><br><span class="line">drwxr-xr-x <span class="number"> 7 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 examples</span><br><span class="line">drwxr-xr-x <span class="number"> 5 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 docs</span><br><span class="line">drwxr-xr-x <span class="number"> 7 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 discovery</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root  <span class="number"> 3355 </span>Oct<span class="number"> 29 </span>09:48 docker-env.mk</span><br><span class="line">drwxr-xr-x <span class="number"> 4 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 devenv</span><br><span class="line">drwxr-xr-x<span class="number"> 24 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 core</span><br><span class="line">drwxr-xr-x<span class="number"> 28 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 common</span><br><span class="line">drwxr-xr-x <span class="number"> 4 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 cmd</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root    <span class="number"> 14 </span>Oct<span class="number"> 29 </span>09:48 ci.properties</span><br><span class="line">drwxr-xr-x <span class="number"> 9 </span>root root  <span class="number"> 4096 </span>Oct<span class="number"> 29 </span>09:48 bccsp</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root <span class="number"> 29937 </span>Oct<span class="number"> 29 </span>09:48 Gopkg.lock</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root  <span class="number"> 3849 </span>Oct<span class="number"> 29 </span>09:48 Gopkg.toml</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root <span class="number"> 11358 </span>Oct<span class="number"> 29 </span>09:48 LICENSE</span><br><span class="line">-rwxr-xr-x <span class="number"> 1 </span>root root <span class="number"> 17474 </span>Oct<span class="number"> 29 </span>09:48 Makefile</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root  <span class="number"> 7391 </span>Oct<span class="number"> 29 </span>09:48 README.md</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root  <span class="number"> 1035 </span>Oct<span class="number"> 29 </span>09:48 SECURITY.md</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root<span class="number"> 804634 </span>Oct<span class="number"> 29 </span>09:48 CHANGELOG.md</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root   <span class="number"> 597 </span>Oct<span class="number"> 29 </span>09:48 CODE_OF_CONDUCT.md</span><br><span class="line">-rw-r--r-- <span class="number"> 1 </span>root root   <span class="number"> 661 </span>Oct<span class="number"> 29 </span>09:48 CONTRIBUTING.md</span><br></pre></td></tr></table></figure>
<h2 id="5-生成-Hyperledger-Fabric-证书"><a href="#5-生成-Hyperledger-Fabric-证书" class="headerlink" title="5. 生成 Hyperledger Fabric 证书"></a>5. 生成 Hyperledger Fabric 证书</h2><blockquote>
<p>证书生成只需要生成一次，这里只在第一个节点配置</p>
</blockquote>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载官方证书生成软件(均为二进制文件)</span></span><br><span class="line"><span class="comment"># 官方离线下载地址为 https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择相应版本 CentOS 选择 linux-amd64-1.4.0  Mac 选择 darwin-amd64-1.4.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载地址为: https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.4.0/hyperledger-fabric-linux-amd64-1.4.0.tar.gz</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mkdir /opt/jicki/</span><br><span class="line"></span><br><span class="line">cd /opt/jicki</span><br><span class="line"></span><br><span class="line">wget <span class="symbol">https:</span>/<span class="regexp">/nexus.hyperledger.org/content</span><span class="regexp">/repositories/releases</span><span class="regexp">/org/hyperledger</span><span class="regexp">/fabric/hyperledger</span>-fabric/linux-amd64-<span class="number">1.4</span>.<span class="number">0</span>/hyperledger-fabric-linux-amd64-<span class="number">1.4</span>.<span class="number">0</span>.tar.gz</span><br><span class="line"></span><br><span class="line">tar zxvf hyperledger-fabric-linux-amd64-<span class="number">1.4</span>.<span class="number">0</span>.tar.gz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压后是 一个 bin 与 一个 config 目录</span></span><br><span class="line"></span><br><span class="line">[root<span class="variable">@localhost</span> jicki]<span class="comment"># tree</span></span><br><span class="line">.</span><br><span class="line">└── bin</span><br><span class="line">    ├── configtxgen</span><br><span class="line">    ├── configtxlator</span><br><span class="line">    ├── cryptogen</span><br><span class="line">    ├── discover</span><br><span class="line">    ├── get-docker-images.sh</span><br><span class="line">    ├── idemixgen</span><br><span class="line">    ├── orderer</span><br><span class="line">    └── peer</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> directory, <span class="number">8</span> files</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># 为方便使用 我们配置一个 环境变量</span></span><br><span class="line"></span><br><span class="line">vi /etc/profile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># fabric env</span></span><br><span class="line">export PATH=<span class="variable">$PATH</span><span class="symbol">:/opt/jicki/bin</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使文件生效</span></span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建 cryptogen.yaml 文件</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">OrdererOrgs:</span></span><br><span class="line"><span class="attr">  - Name:</span> <span class="string">Orderer</span></span><br><span class="line"><span class="attr">    Domain:</span> <span class="string">jicki.me</span></span><br><span class="line"><span class="attr">    CA:</span></span><br><span class="line"><span class="attr">        Country:</span> <span class="string">CN</span></span><br><span class="line"><span class="attr">        Province:</span> <span class="string">GuangDong</span></span><br><span class="line"><span class="attr">        Locality:</span> <span class="string">ShenZhen</span></span><br><span class="line"><span class="attr">    Specs:</span></span><br><span class="line"><span class="attr">      - Hostname:</span> <span class="string">orderer0</span></span><br><span class="line">      </span><br><span class="line"><span class="attr">PeerOrgs:</span></span><br><span class="line"><span class="attr">  - Name:</span> <span class="string">Org1</span></span><br><span class="line"><span class="attr">    Domain:</span> <span class="string">org1.jicki.me</span></span><br><span class="line"><span class="attr">    EnableNodeOUs:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    CA:</span></span><br><span class="line"><span class="attr">        Country:</span> <span class="string">CN</span></span><br><span class="line"><span class="attr">        Province:</span> <span class="string">GuangDong</span></span><br><span class="line"><span class="attr">        Locality:</span> <span class="string">ShenZhen</span></span><br><span class="line"><span class="attr">    Template:</span></span><br><span class="line"><span class="attr">      Count:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">    Users:</span></span><br><span class="line"><span class="attr">      Count:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  - Name:</span> <span class="string">Org2</span></span><br><span class="line"><span class="attr">    Domain:</span> <span class="string">org2.jicki.me</span></span><br><span class="line"><span class="attr">    EnableNodeOUs:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    CA:</span></span><br><span class="line"><span class="attr">        Country:</span> <span class="string">CN</span></span><br><span class="line"><span class="attr">        Province:</span> <span class="string">GuangDong</span></span><br><span class="line"><span class="attr">        Locality:</span> <span class="string">ShenZhen</span></span><br><span class="line"><span class="attr">    Template:</span></span><br><span class="line"><span class="attr">      Count:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">    Users:</span></span><br><span class="line"><span class="attr">      Count:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br></pre></td><td class="code"><pre><span class="line"># 然后这里使用 cryptogen 软件来生成相应的证书了</span><br><span class="line"></span><br><span class="line">[root@localhost jicki]# cryptogen generate --config=./cryptogen.yaml</span><br><span class="line">org1.jicki.<span class="keyword">me</span></span><br><span class="line">org2.jicki.<span class="keyword">me</span></span><br><span class="line"></span><br><span class="line"># 生成一个 crypto-config 证书目录</span><br><span class="line"></span><br><span class="line">[root@payment jicki]# tree crypto-config</span><br><span class="line">crypto-config</span><br><span class="line">├── ordererOrganizations</span><br><span class="line">│   └── jicki.<span class="keyword">me</span></span><br><span class="line">│       ├── <span class="keyword">ca</span></span><br><span class="line">│       │   ├── <span class="number">87</span>fcad73e61dbc5e267d0b56e991e2ef445407ddf89924debc299cf42dde53aa_sk</span><br><span class="line">│       │   └── <span class="keyword">ca</span>.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│       ├── msp</span><br><span class="line">│       │   ├── admincerts</span><br><span class="line">│       │   │   └── Admin@jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│       │   ├── cacerts</span><br><span class="line">│       │   │   └── <span class="keyword">ca</span>.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│       │   └── tlscacerts</span><br><span class="line">│       │       └── tlsca.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│       ├── orderers</span><br><span class="line">│       │   └── orderer0.jicki.<span class="keyword">me</span></span><br><span class="line">│       │       ├── msp</span><br><span class="line">│       │       │   ├── admincerts</span><br><span class="line">│       │       │   │   └── Admin@jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│       │       │   ├── cacerts</span><br><span class="line">│       │       │   │   └── <span class="keyword">ca</span>.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│       │       │   ├── keystore</span><br><span class="line">│       │       │   │   └── <span class="number">8</span>b8f847af6be4f902f4a85236155a0b9ee37d17edee74ee56212d84cb4b52219_sk</span><br><span class="line">│       │       │   ├── signcerts</span><br><span class="line">│       │       │   │   └── orderer0.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│       │       │   └── tlscacerts</span><br><span class="line">│       │       │       └── tlsca.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│       │       └── tls</span><br><span class="line">│       │           ├── <span class="keyword">ca</span>.crt</span><br><span class="line">│       │           ├── server.crt</span><br><span class="line">│       │           └── server.key</span><br><span class="line">│       ├── tlsca</span><br><span class="line">│       │   ├── d13f753996d547371bcecc387472e88b95cc790dbcbb59a914f6aa05531e8a18_sk</span><br><span class="line">│       │   └── tlsca.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│       └── users</span><br><span class="line">│           └── Admin@jicki.<span class="keyword">me</span></span><br><span class="line">│               ├── msp</span><br><span class="line">│               │   ├── admincerts</span><br><span class="line">│               │   │   └── Admin@jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│               │   ├── cacerts</span><br><span class="line">│               │   │   └── <span class="keyword">ca</span>.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│               │   ├── keystore</span><br><span class="line">│               │   │   └── <span class="number">7</span>dfa64d80276527ed1c4ffd030c8b1f4fda213c85396ac3e06794d3957d825bc_sk</span><br><span class="line">│               │   ├── signcerts</span><br><span class="line">│               │   │   └── Admin@jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│               │   └── tlscacerts</span><br><span class="line">│               │       └── tlsca.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">│               └── tls</span><br><span class="line">│                   ├── <span class="keyword">ca</span>.crt</span><br><span class="line">│                   ├── client.crt</span><br><span class="line">│                   └── client.key</span><br><span class="line">└── peerOrganizations</span><br><span class="line">    ├── org1.jicki.<span class="keyword">me</span></span><br><span class="line">    │   ├── <span class="keyword">ca</span></span><br><span class="line">    │   │   ├── <span class="number">3</span>a233ccbd6706cee4c66a320e43bedad3e72b6f68e831ce121f35760eb1ac275_sk</span><br><span class="line">    │   │   └── <span class="keyword">ca</span>.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   ├── msp</span><br><span class="line">    │   │   ├── admincerts</span><br><span class="line">    │   │   │   └── Admin@org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   │   ├── cacerts</span><br><span class="line">    │   │   │   └── <span class="keyword">ca</span>.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   │   ├── config.yaml</span><br><span class="line">    │   │   └── tlscacerts</span><br><span class="line">    │   │       └── tlsca.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   ├── peers</span><br><span class="line">    │   │   ├── peer0.org1.jicki.<span class="keyword">me</span></span><br><span class="line">    │   │   │   ├── msp</span><br><span class="line">    │   │   │   │   ├── admincerts</span><br><span class="line">    │   │   │   │   │   └── Admin@org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   │   │   │   ├── cacerts</span><br><span class="line">    │   │   │   │   │   └── <span class="keyword">ca</span>.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   │   │   │   ├── config.yaml</span><br><span class="line">    │   │   │   │   ├── keystore</span><br><span class="line">    │   │   │   │   │   └── eecd3dec5e6ba609a931d94bf0a1fb9defe047e68e1437fd1fec5fcfbe7dea23_sk</span><br><span class="line">    │   │   │   │   ├── signcerts</span><br><span class="line">    │   │   │   │   │   └── peer0.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   │   │   │   └── tlscacerts</span><br><span class="line">    │   │   │   │       └── tlsca.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   │   │   └── tls</span><br><span class="line">    │   │   │       ├── <span class="keyword">ca</span>.crt</span><br><span class="line">    │   │   │       ├── server.crt</span><br><span class="line">    │   │   │       └── server.key</span><br><span class="line">    │   │   └── peer1.org1.jicki.<span class="keyword">me</span></span><br><span class="line">    │   │       ├── msp</span><br><span class="line">    │   │       │   ├── admincerts</span><br><span class="line">    │   │       │   │   └── Admin@org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   │       │   ├── cacerts</span><br><span class="line">    │   │       │   │   └── <span class="keyword">ca</span>.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   │       │   ├── config.yaml</span><br><span class="line">    │   │       │   ├── keystore</span><br><span class="line">    │   │       │   │   └── d5a32a61b164604e6352a783f843e00c46ca2dfcefbc1b78c3ea14536483169b_sk</span><br><span class="line">    │   │       │   ├── signcerts</span><br><span class="line">    │   │       │   │   └── peer1.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   │       │   └── tlscacerts</span><br><span class="line">    │   │       │       └── tlsca.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   │       └── tls</span><br><span class="line">    │   │           ├── <span class="keyword">ca</span>.crt</span><br><span class="line">    │   │           ├── server.crt</span><br><span class="line">    │   │           └── server.key</span><br><span class="line">    │   ├── tlsca</span><br><span class="line">    │   │   ├── d17dbbb6206ef972706c17f25b77bd9482b9e1606cfa88ef90dbba179d4a86f7_sk</span><br><span class="line">    │   │   └── tlsca.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │   └── users</span><br><span class="line">    │       ├── Admin@org1.jicki.<span class="keyword">me</span></span><br><span class="line">    │       │   ├── msp</span><br><span class="line">    │       │   │   ├── admincerts</span><br><span class="line">    │       │   │   │   └── Admin@org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │       │   │   ├── cacerts</span><br><span class="line">    │       │   │   │   └── <span class="keyword">ca</span>.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │       │   │   ├── keystore</span><br><span class="line">    │       │   │   │   └── <span class="number">5420790271603</span>cc3da1ec2a4e0c45e30fb6ebb00a001021b9e0a4d29ad4d19cc_sk</span><br><span class="line">    │       │   │   ├── signcerts</span><br><span class="line">    │       │   │   │   └── Admin@org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │       │   │   └── tlscacerts</span><br><span class="line">    │       │   │       └── tlsca.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │       │   └── tls</span><br><span class="line">    │       │       ├── <span class="keyword">ca</span>.crt</span><br><span class="line">    │       │       ├── client.crt</span><br><span class="line">    │       │       └── client.key</span><br><span class="line">    │       └── User1@org1.jicki.<span class="keyword">me</span></span><br><span class="line">    │           ├── msp</span><br><span class="line">    │           │   ├── admincerts</span><br><span class="line">    │           │   │   └── User1@org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │           │   ├── cacerts</span><br><span class="line">    │           │   │   └── <span class="keyword">ca</span>.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │           │   ├── keystore</span><br><span class="line">    │           │   │   └── <span class="number">43</span>e76b981378f4820bdc3cf7a690e42c018e0cb69cf097dba4bbe0d8f8188cfa_sk</span><br><span class="line">    │           │   ├── signcerts</span><br><span class="line">    │           │   │   └── User1@org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │           │   └── tlscacerts</span><br><span class="line">    │           │       └── tlsca.org1.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">    │           └── tls</span><br><span class="line">    │               ├── <span class="keyword">ca</span>.crt</span><br><span class="line">    │               ├── client.crt</span><br><span class="line">    │               └── client.key</span><br><span class="line">    └── org2.jicki.<span class="keyword">me</span></span><br><span class="line">        ├── <span class="keyword">ca</span></span><br><span class="line">        │   ├── <span class="number">7</span>ae61d566e35ebdcffa42a90e385d6698ffa457b69c3a56b94dfd77d8a2cfe96_sk</span><br><span class="line">        │   └── <span class="keyword">ca</span>.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        ├── msp</span><br><span class="line">        │   ├── admincerts</span><br><span class="line">        │   │   └── Admin@org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        │   ├── cacerts</span><br><span class="line">        │   │   └── <span class="keyword">ca</span>.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        │   ├── config.yaml</span><br><span class="line">        │   └── tlscacerts</span><br><span class="line">        │       └── tlsca.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        ├── peers</span><br><span class="line">        │   ├── peer0.org2.jicki.<span class="keyword">me</span></span><br><span class="line">        │   │   ├── msp</span><br><span class="line">        │   │   │   ├── admincerts</span><br><span class="line">        │   │   │   │   └── Admin@org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        │   │   │   ├── cacerts</span><br><span class="line">        │   │   │   │   └── <span class="keyword">ca</span>.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        │   │   │   ├── config.yaml</span><br><span class="line">        │   │   │   ├── keystore</span><br><span class="line">        │   │   │   │   └── <span class="number">753</span>d7217f9cbabdffbc69b74a38efedb70ab80b183cf50d78669fe0d19503aed_sk</span><br><span class="line">        │   │   │   ├── signcerts</span><br><span class="line">        │   │   │   │   └── peer0.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        │   │   │   └── tlscacerts</span><br><span class="line">        │   │   │       └── tlsca.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        │   │   └── tls</span><br><span class="line">        │   │       ├── <span class="keyword">ca</span>.crt</span><br><span class="line">        │   │       ├── server.crt</span><br><span class="line">        │   │       └── server.key</span><br><span class="line">        │   └── peer1.org2.jicki.<span class="keyword">me</span></span><br><span class="line">        │       ├── msp</span><br><span class="line">        │       │   ├── admincerts</span><br><span class="line">        │       │   │   └── Admin@org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        │       │   ├── cacerts</span><br><span class="line">        │       │   │   └── <span class="keyword">ca</span>.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        │       │   ├── config.yaml</span><br><span class="line">        │       │   ├── keystore</span><br><span class="line">        │       │   │   └── <span class="number">3</span>ab2f929ddbe609cb587a55ac8f5bca4d47734db2c5bfed0221ef90ea73cb994_sk</span><br><span class="line">        │       │   ├── signcerts</span><br><span class="line">        │       │   │   └── peer1.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        │       │   └── tlscacerts</span><br><span class="line">        │       │       └── tlsca.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        │       └── tls</span><br><span class="line">        │           ├── <span class="keyword">ca</span>.crt</span><br><span class="line">        │           ├── server.crt</span><br><span class="line">        │           └── server.key</span><br><span class="line">        ├── tlsca</span><br><span class="line">        │   ├── <span class="number">413</span>aa8963bb8d193e91d7b54ccc699f32f293726e342ca102ea648e73d74813e_sk</span><br><span class="line">        │   └── tlsca.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">        └── users</span><br><span class="line">            ├── Admin@org2.jicki.<span class="keyword">me</span></span><br><span class="line">            │   ├── msp</span><br><span class="line">            │   │   ├── admincerts</span><br><span class="line">            │   │   │   └── Admin@org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">            │   │   ├── cacerts</span><br><span class="line">            │   │   │   └── <span class="keyword">ca</span>.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">            │   │   ├── keystore</span><br><span class="line">            │   │   │   └── <span class="number">08</span>f6865e8d30d2d326e9d04be8eea92e25b39128afba02652fa0f4ee3f0dc35a_sk</span><br><span class="line">            │   │   ├── signcerts</span><br><span class="line">            │   │   │   └── Admin@org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">            │   │   └── tlscacerts</span><br><span class="line">            │   │       └── tlsca.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">            │   └── tls</span><br><span class="line">            │       ├── <span class="keyword">ca</span>.crt</span><br><span class="line">            │       ├── client.crt</span><br><span class="line">            │       └── client.key</span><br><span class="line">            └── User1@org2.jicki.<span class="keyword">me</span></span><br><span class="line">                ├── msp</span><br><span class="line">                │   ├── admincerts</span><br><span class="line">                │   │   └── User1@org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">                │   ├── cacerts</span><br><span class="line">                │   │   └── <span class="keyword">ca</span>.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">                │   ├── keystore</span><br><span class="line">                │   │   └── d5ac39f341b6e0ea2e50646dcabd132dcb002da31760a02e376d55669a30e885_sk</span><br><span class="line">                │   ├── signcerts</span><br><span class="line">                │   │   └── User1@org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">                │   └── tlscacerts</span><br><span class="line">                │       └── tlsca.org2.jicki.<span class="keyword">me</span>-cert.pem</span><br><span class="line">                └── tls</span><br><span class="line">                    ├── <span class="keyword">ca</span>.crt</span><br><span class="line">                    ├── client.crt</span><br><span class="line">                    └── client.key</span><br><span class="line"></span><br><span class="line"><span class="number">109</span> directories, <span class="number">107</span> <span class="keyword">files</span></span><br></pre></td></tr></table></figure>
<h2 id="6-生成-Hyperledger-Fabric-创世区块"><a href="#6-生成-Hyperledger-Fabric-创世区块" class="headerlink" title="6. 生成 Hyperledger Fabric 创世区块"></a>6. 生成 Hyperledger Fabric 创世区块</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这里使用 configtxgen 来创建 创世区块</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 首先需要创建一个文件夹</span></span><br><span class="line"><span class="string">mkdir</span> <span class="bullet">-p</span> <span class="string">/opt/jicki/channel-artifacts</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 完整 configtx.yaml 如下: </span></span><br><span class="line"><span class="comment"># configtx.yaml 文件格式 请千万注意 空格 与 tab 键 里的缩进，否则会报错。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Organizations:</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">    -</span> <span class="meta">&amp;OrdererOrg</span></span><br><span class="line"><span class="attr">        Name:</span> <span class="string">OrdererMSP</span></span><br><span class="line"><span class="attr">        ID:</span> <span class="string">OrdererMSP</span></span><br><span class="line"><span class="attr">        MSPDir:</span> <span class="string">crypto-config/ordererOrganizations/jicki.me/msp</span></span><br><span class="line"><span class="attr">        Policies:</span></span><br><span class="line"><span class="attr">            Readers:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('OrdererMSP.member')"</span></span><br><span class="line"><span class="attr">            Writers:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('OrdererMSP.member')"</span></span><br><span class="line"><span class="attr">            Admins:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('OrdererMSP.admin')"</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">    -</span> <span class="meta">&amp;Org1</span></span><br><span class="line"><span class="attr">        Name:</span> <span class="string">Org1MSP</span></span><br><span class="line"><span class="attr">        ID:</span> <span class="string">Org1MSP</span></span><br><span class="line"><span class="attr">        MSPDir:</span> <span class="string">crypto-config/peerOrganizations/org1.jicki.me/msp</span></span><br><span class="line"><span class="attr">        Policies:</span></span><br><span class="line"><span class="attr">            Readers:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('Org1MSP.admin', 'Org1MSP.peer', 'Org1MSP.client')"</span></span><br><span class="line"><span class="attr">            Writers:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('Org1MSP.admin', 'Org1MSP.client')"</span></span><br><span class="line"><span class="attr">            Admins:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('Org1MSP.admin')"</span></span><br><span class="line"></span><br><span class="line"><span class="attr">        AnchorPeers:</span></span><br><span class="line"><span class="attr">            - Host:</span> <span class="string">peer0.org1.jicki.me</span></span><br><span class="line"><span class="attr">              Port:</span> <span class="number">7051</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">    -</span> <span class="meta">&amp;Org2</span></span><br><span class="line"><span class="attr">        Name:</span> <span class="string">Org2MSP</span></span><br><span class="line"><span class="attr">        ID:</span> <span class="string">Org2MSP</span></span><br><span class="line"><span class="attr">        MSPDir:</span> <span class="string">crypto-config/peerOrganizations/org2.jicki.me/msp</span></span><br><span class="line"><span class="attr">        Policies:</span></span><br><span class="line"><span class="attr">            Readers:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('Org2MSP.admin', 'Org2MSP.peer', 'Org2MSP.client')"</span></span><br><span class="line"><span class="attr">            Writers:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('Org2MSP.admin', 'Org2MSP.client')"</span></span><br><span class="line"><span class="attr">            Admins:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('Org2MSP.admin')"</span></span><br><span class="line"></span><br><span class="line"><span class="attr">        AnchorPeers:</span></span><br><span class="line"><span class="attr">            - Host:</span> <span class="string">peer0.org2.jicki.me</span></span><br><span class="line"><span class="attr">              Port:</span> <span class="number">7051</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Capabilities:</span></span><br><span class="line"><span class="attr">    Channel:</span> <span class="meta">&amp;ChannelCapabilities</span></span><br><span class="line"><span class="attr">        V1_3:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    Orderer:</span> <span class="meta">&amp;OrdererCapabilities</span></span><br><span class="line"><span class="attr">        V1_1:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    Application:</span> <span class="meta">&amp;ApplicationCapabilities</span></span><br><span class="line"><span class="attr">        V1_3:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">        V1_2:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">        V1_1:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Application:</span> <span class="meta">&amp;ApplicationDefaults</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    Organizations:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    Policies:</span></span><br><span class="line"><span class="attr">        Readers:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"ANY Readers"</span></span><br><span class="line"><span class="attr">        Writers:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"ANY Writers"</span></span><br><span class="line"><span class="attr">        Admins:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"MAJORITY Admins"</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    Capabilities:</span></span><br><span class="line">        <span class="string">&lt;&lt;:</span> <span class="meta">*ApplicationCapabilities</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Orderer:</span> <span class="meta">&amp;OrdererDefaults</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    OrdererType:</span> <span class="string">kafka</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    Addresses:</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">orderer0.jicki.me:7050</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    BatchTimeout:</span> <span class="number">2</span><span class="string">s</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    BatchSize:</span></span><br><span class="line"><span class="attr">        MaxMessageCount:</span> <span class="number">10</span></span><br><span class="line"><span class="attr">        AbsoluteMaxBytes:</span> <span class="number">99</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">        PreferredMaxBytes:</span> <span class="number">512</span> <span class="string">KB</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    Kafka:</span></span><br><span class="line"><span class="attr">        Brokers:</span></span><br><span class="line"><span class="attr">            - kafka0:</span><span class="number">9092</span></span><br><span class="line"><span class="attr">            - kafka1:</span><span class="number">9092</span></span><br><span class="line"><span class="attr">            - kafka2:</span><span class="number">9092</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    Organizations:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    Policies:</span></span><br><span class="line"><span class="attr">        Readers:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"ANY Readers"</span></span><br><span class="line"><span class="attr">        Writers:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"ANY Writers"</span></span><br><span class="line"><span class="attr">        Admins:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"MAJORITY Admins"</span></span><br><span class="line"><span class="attr">        BlockValidation:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"ANY Writers"</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Channel:</span> <span class="meta">&amp;ChannelDefaults</span></span><br><span class="line"><span class="attr">    Policies:</span></span><br><span class="line"><span class="attr">        Readers:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"ANY Readers"</span></span><br><span class="line"><span class="attr">        Writers:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"ANY Writers"</span></span><br><span class="line"><span class="attr">        Admins:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"MAJORITY Admins"</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    Capabilities:</span></span><br><span class="line">        <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelCapabilities</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Profiles:</span></span><br><span class="line"><span class="attr">    TwoOrgsOrdererGenesis:</span></span><br><span class="line">        <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelDefaults</span></span><br><span class="line"><span class="attr">        Orderer:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererDefaults</span></span><br><span class="line"><span class="attr">            Organizations:</span></span><br><span class="line"><span class="bullet">                -</span> <span class="meta">*OrdererOrg</span></span><br><span class="line"><span class="attr">            Capabilities:</span></span><br><span class="line">                <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererCapabilities</span></span><br><span class="line"><span class="attr">        Consortiums:</span></span><br><span class="line"><span class="attr">            SampleConsortium:</span></span><br><span class="line"><span class="attr">                Organizations:</span></span><br><span class="line"><span class="bullet">                    -</span> <span class="meta">*Org1</span></span><br><span class="line"><span class="bullet">                    -</span> <span class="meta">*Org2</span></span><br><span class="line"><span class="attr">    TwoOrgsChannel:</span></span><br><span class="line"><span class="attr">        Consortium:</span> <span class="string">SampleConsortium</span></span><br><span class="line"><span class="attr">        Application:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*ApplicationDefaults</span></span><br><span class="line"><span class="attr">            Organizations:</span></span><br><span class="line"><span class="bullet">                -</span> <span class="meta">*Org1</span></span><br><span class="line"><span class="bullet">                -</span> <span class="meta">*Org2</span></span><br><span class="line"><span class="attr">            Capabilities:</span></span><br><span class="line">                <span class="string">&lt;&lt;:</span> <span class="meta">*ApplicationCapabilities</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    SampleDevModeKafka:</span></span><br><span class="line">        <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelDefaults</span></span><br><span class="line"><span class="attr">        Capabilities:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelCapabilities</span></span><br><span class="line"><span class="attr">        Orderer:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererDefaults</span></span><br><span class="line"><span class="attr">            OrdererType:</span> <span class="string">kafka</span></span><br><span class="line"><span class="attr">            Kafka:</span></span><br><span class="line"><span class="attr">                Brokers:</span></span><br><span class="line"><span class="attr">                - kafka0:</span><span class="number">9092</span></span><br><span class="line"><span class="attr">                - kafka1:</span><span class="number">9092</span></span><br><span class="line"><span class="attr">                - kafka2:</span><span class="number">9092</span></span><br><span class="line"></span><br><span class="line"><span class="attr">            Organizations:</span></span><br><span class="line"><span class="bullet">            -</span> <span class="meta">*OrdererOrg</span></span><br><span class="line"><span class="attr">            Capabilities:</span></span><br><span class="line">                <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererCapabilities</span></span><br><span class="line"><span class="attr">        Application:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*ApplicationDefaults</span></span><br><span class="line"><span class="attr">            Organizations:</span></span><br><span class="line"><span class="bullet">            -</span> <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererOrg</span></span><br><span class="line"><span class="attr">        Consortiums:</span></span><br><span class="line"><span class="attr">            SampleConsortium:</span></span><br><span class="line"><span class="attr">                Organizations:</span></span><br><span class="line"><span class="bullet">                -</span> <span class="meta">*Org1</span></span><br><span class="line"><span class="bullet">                -</span> <span class="meta">*Org2</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># 首先需要创建一个文件夹</span><br><span class="line"></span><br><span class="line">mkdir -p /opt/jicki/channel-artifacts</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 创建 创世区块  TwoOrgsOrdererGenesis 名称为 configtx.yaml 中 Profiles 字段下的</span><br><span class="line"></span><br><span class="line">[root@localhost jicki]# configtxgen -profile TwoOrgsOrdererGenesis \</span><br><span class="line"> -outputBlock ./channel-artifacts/genesis.<span class="keyword">block</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">12</span>:<span class="number">22</span>:<span class="number">06.715</span> CST [<span class="function"><span class="title">common</span>.tools.configtxgen] main -&gt;</span> WARN <span class="number">001</span> Omitting the channel ID <span class="keyword">for</span> configtxgen <span class="keyword">for</span> output operations <span class="keyword">is</span> deprecated.  Explicitly passing the channel ID will be required <span class="built_in">in</span> the future, defaulting to <span class="string">'testchainid'</span>.</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">12</span>:<span class="number">22</span>:<span class="number">06.715</span> CST [<span class="function"><span class="title">common</span>.tools.configtxgen] main -&gt;</span> INFO <span class="number">002</span> Loading configuration</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">12</span>:<span class="number">22</span>:<span class="number">06.743</span> CST [<span class="function"><span class="title">common</span>.tools.configtxgen.localconfig] completeInitialization -&gt;</span> INFO <span class="number">003</span> orderer type: kafka</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">12</span>:<span class="number">22</span>:<span class="number">06.743</span> CST [<span class="function"><span class="title">common</span>.tools.configtxgen.localconfig] Load -&gt;</span> INFO <span class="number">004</span> Loaded configuration: /opt/jicki/configtx.yaml</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">12</span>:<span class="number">22</span>:<span class="number">06.772</span> CST [<span class="function"><span class="title">common</span>.tools.configtxgen.localconfig] completeInitialization -&gt;</span> INFO <span class="number">005</span> orderer type: kafka</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">12</span>:<span class="number">22</span>:<span class="number">06.772</span> CST [<span class="function"><span class="title">common</span>.tools.configtxgen.localconfig] LoadTopLevel -&gt;</span> INFO <span class="number">006</span> Loaded configuration: /opt/jicki/configtx.yaml</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">12</span>:<span class="number">22</span>:<span class="number">06.774</span> CST [<span class="function"><span class="title">common</span>.tools.configtxgen] doOutputBlock -&gt;</span> INFO <span class="number">007</span> Generating genesis <span class="keyword">block</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">12</span>:<span class="number">22</span>:<span class="number">06.774</span> CST [<span class="function"><span class="title">common</span>.tools.configtxgen] doOutputBlock -&gt;</span> INFO <span class="number">008</span> Writing genesis <span class="keyword">block</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 创世区块 是在 orderer 服务中使用</span><br><span class="line"></span><br><span class="line">[root@localhost jicki]# ls -lt channel-artifacts/</span><br><span class="line">total <span class="number">16</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> root root <span class="number">13440</span> Oct <span class="number">29</span> <span class="number">12</span>:<span class="number">22</span> genesis.<span class="keyword">block</span></span><br></pre></td></tr></table></figure>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 下面来生成一个 <span class="selector-tag">peer</span> 服务 中使用的 <span class="selector-tag">tx</span> 文件 <span class="selector-tag">TwoOrgsChannel</span> 名称为 <span class="selector-tag">configtx</span><span class="selector-class">.yaml</span> 中 <span class="selector-tag">Profiles</span> 字段下的，这里必须指定上面的 <span class="selector-tag">channelID</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[root@localhost jicki]</span># <span class="selector-tag">configtxgen</span> <span class="selector-tag">-profile</span> <span class="selector-tag">TwoOrgsChannel</span> <span class="selector-tag">-outputCreateChannelTx</span> ./<span class="selector-tag">channel-artifacts</span>/<span class="selector-tag">channel</span><span class="selector-class">.tx</span> <span class="selector-tag">-channelID</span> <span class="selector-tag">mychannel</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">2019-10-29</span> <span class="selector-tag">12</span><span class="selector-pseudo">:25</span><span class="selector-pseudo">:41.961</span> <span class="selector-tag">CST</span> <span class="selector-attr">[common.tools.configtxgen]</span> <span class="selector-tag">main</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">INFO</span> <span class="selector-tag">001</span> <span class="selector-tag">Loading</span> <span class="selector-tag">configuration</span></span><br><span class="line"><span class="selector-tag">2019-10-29</span> <span class="selector-tag">12</span><span class="selector-pseudo">:25</span><span class="selector-pseudo">:41.988</span> <span class="selector-tag">CST</span> <span class="selector-attr">[common.tools.configtxgen.localconfig]</span> <span class="selector-tag">Load</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">INFO</span> <span class="selector-tag">002</span> <span class="selector-tag">Loaded</span> <span class="selector-tag">configuration</span>: /<span class="selector-tag">opt</span>/<span class="selector-tag">jicki</span>/<span class="selector-tag">configtx</span><span class="selector-class">.yaml</span></span><br><span class="line"><span class="selector-tag">2019-10-29</span> <span class="selector-tag">12</span><span class="selector-pseudo">:25</span><span class="selector-pseudo">:42.016</span> <span class="selector-tag">CST</span> <span class="selector-attr">[common.tools.configtxgen.localconfig]</span> <span class="selector-tag">completeInitialization</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">INFO</span> <span class="selector-tag">003</span> <span class="selector-tag">orderer</span> <span class="selector-tag">type</span>: <span class="selector-tag">kafka</span></span><br><span class="line"><span class="selector-tag">2019-10-29</span> <span class="selector-tag">12</span><span class="selector-pseudo">:25</span><span class="selector-pseudo">:42.016</span> <span class="selector-tag">CST</span> <span class="selector-attr">[common.tools.configtxgen.localconfig]</span> <span class="selector-tag">LoadTopLevel</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">INFO</span> <span class="selector-tag">004</span> <span class="selector-tag">Loaded</span> <span class="selector-tag">configuration</span>: /<span class="selector-tag">opt</span>/<span class="selector-tag">jicki</span>/<span class="selector-tag">configtx</span><span class="selector-class">.yaml</span></span><br><span class="line"><span class="selector-tag">2019-10-29</span> <span class="selector-tag">12</span><span class="selector-pseudo">:25</span><span class="selector-pseudo">:42.016</span> <span class="selector-tag">CST</span> <span class="selector-attr">[common.tools.configtxgen]</span> <span class="selector-tag">doOutputChannelCreateTx</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">INFO</span> <span class="selector-tag">005</span> <span class="selector-tag">Generating</span> <span class="selector-tag">new</span> <span class="selector-tag">channel</span> <span class="selector-tag">configtx</span></span><br><span class="line"><span class="selector-tag">2019-10-29</span> <span class="selector-tag">12</span><span class="selector-pseudo">:25</span><span class="selector-pseudo">:42.018</span> <span class="selector-tag">CST</span> <span class="selector-attr">[common.tools.configtxgen]</span> <span class="selector-tag">doOutputChannelCreateTx</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">INFO</span> <span class="selector-tag">006</span> <span class="selector-tag">Writing</span> <span class="selector-tag">new</span> <span class="selector-tag">channel</span> <span class="selector-tag">tx</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[root@localhost jicki]</span># <span class="selector-tag">ls</span> <span class="selector-tag">-lt</span> <span class="selector-tag">channel-artifacts</span>/</span><br><span class="line"><span class="selector-tag">total</span> <span class="selector-tag">20</span></span><br><span class="line"><span class="selector-tag">-rw-r--r--</span> <span class="selector-tag">1</span> <span class="selector-tag">root</span> <span class="selector-tag">root</span>   <span class="selector-tag">346</span> <span class="selector-tag">Oct</span> <span class="selector-tag">29</span> <span class="selector-tag">12</span><span class="selector-pseudo">:25</span> <span class="selector-tag">channel</span><span class="selector-class">.tx</span></span><br><span class="line"><span class="selector-tag">-rw-r--r--</span> <span class="selector-tag">1</span> <span class="selector-tag">root</span> <span class="selector-tag">root</span> <span class="selector-tag">13440</span> <span class="selector-tag">Oct</span> <span class="selector-tag">29</span> <span class="selector-tag">12</span><span class="selector-pseudo">:22</span> <span class="selector-tag">genesis</span><span class="selector-class">.block</span></span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义组织 生成锚节点更新文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Org1MSP</span></span><br><span class="line"></span><br><span class="line">[root@localhost jicki]# configtxgen -profile TwoOrgsChannel \</span><br><span class="line">-outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors.tx -channelID mychannel -asOrg Org1MSP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2019-10-29 12:26:33.769 CST [common.tools.configtxgen] main -&gt; <span class="builtin-name">INFO</span> 001 Loading configuration</span><br><span class="line">2019-10-29 12:26:33.796 CST [common.tools.configtxgen.localconfig] Load -&gt; <span class="builtin-name">INFO</span> 002 Loaded configuration: /opt/jicki/configtx.yaml</span><br><span class="line">2019-10-29 12:26:33.824 CST [common.tools.configtxgen.localconfig] completeInitialization -&gt; <span class="builtin-name">INFO</span> 003 orderer type: kafka</span><br><span class="line">2019-10-29 12:26:33.824 CST [common.tools.configtxgen.localconfig] LoadTopLevel -&gt; <span class="builtin-name">INFO</span> 004 Loaded configuration: /opt/jicki/configtx.yaml</span><br><span class="line">2019-10-29 12:26:33.824 CST [common.tools.configtxgen] doOutputAnchorPeersUpdate -&gt; <span class="builtin-name">INFO</span> 005 Generating anchor<span class="built_in"> peer </span>update</span><br><span class="line">2019-10-29 12:26:33.825 CST [common.tools.configtxgen] doOutputAnchorPeersUpdate -&gt; <span class="builtin-name">INFO</span> 006 Writing anchor<span class="built_in"> peer </span>update</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Org2MSP</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@localhost jicki]# configtxgen -profile TwoOrgsChannel \</span><br><span class="line">-outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors.tx -channelID mychannel -asOrg Org2MSP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2019-10-29 12:26:50.797 CST [common.tools.configtxgen] main -&gt; <span class="builtin-name">INFO</span> 001 Loading configuration</span><br><span class="line">2019-10-29 12:26:50.825 CST [common.tools.configtxgen.localconfig] Load -&gt; <span class="builtin-name">INFO</span> 002 Loaded configuration: /opt/jicki/configtx.yaml</span><br><span class="line">2019-10-29 12:26:50.853 CST [common.tools.configtxgen.localconfig] completeInitialization -&gt; <span class="builtin-name">INFO</span> 003 orderer type: kafka</span><br><span class="line">2019-10-29 12:26:50.853 CST [common.tools.configtxgen.localconfig] LoadTopLevel -&gt; <span class="builtin-name">INFO</span> 004 Loaded configuration: /opt/jicki/configtx.yaml</span><br><span class="line">2019-10-29 12:26:50.853 CST [common.tools.configtxgen] doOutputAnchorPeersUpdate -&gt; <span class="builtin-name">INFO</span> 005 Generating anchor<span class="built_in"> peer </span>update</span><br><span class="line">2019-10-29 12:26:50.853 CST [common.tools.configtxgen] doOutputAnchorPeersUpdate -&gt; <span class="builtin-name">INFO</span> 006 Writing anchor<span class="built_in"> peer </span>update</span><br></pre></td></tr></table></figure>
<h2 id="7-配置-fabric-docker-compose-yaml"><a href="#7-配置-fabric-docker-compose-yaml" class="headerlink" title="7. 配置 fabric docker-compose.yaml"></a>7. 配置 fabric docker-compose.yaml</h2><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br></pre></td><td class="code"><pre><span class="line">version: '2'</span><br><span class="line">services:</span><br><span class="line">  zookeeper1:</span><br><span class="line">    container_name: zookeeper1</span><br><span class="line">    hostname: zookeeper1</span><br><span class="line">    image: hyperledger/fabric-zookeeper</span><br><span class="line">    restart: always</span><br><span class="line">    environment:</span><br><span class="line">      -<span class="ruby"> ZOO_MY_ID=<span class="number">1</span></span></span><br><span class="line"><span class="ruby">      - ZOO_SERVERS=server.<span class="number">1</span>=<span class="symbol">zookeeper1:</span><span class="number">2888</span><span class="symbol">:</span><span class="number">3888</span> server.<span class="number">2</span>=<span class="symbol">zookeeper2:</span><span class="number">2888</span><span class="symbol">:</span><span class="number">3888</span> server.<span class="number">3</span>=<span class="symbol">zookeeper3:</span><span class="number">2888</span><span class="symbol">:</span><span class="number">3888</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">    <span class="comment"># 存储数据与日志</span></span></span><br><span class="line"><span class="ruby">    - ./data/zookeeper1/<span class="symbol">data:</span>/data</span></span><br><span class="line"><span class="ruby">    - ./data/zookeeper1/<span class="symbol">datalog:</span>/datalog</span></span><br><span class="line"><span class="ruby">    <span class="symbol">networks:</span></span></span><br><span class="line"><span class="ruby">      <span class="symbol">default:</span></span></span><br><span class="line"><span class="ruby">        <span class="symbol">aliases:</span></span></span><br><span class="line"><span class="ruby">          - jicki</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">  <span class="symbol">zookeeper2:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> zookeeper2</span></span><br><span class="line"><span class="ruby">    <span class="symbol">hostname:</span> zookeeper2</span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-zookeeper</span></span><br><span class="line"><span class="ruby">    <span class="symbol">restart:</span> always</span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - ZOO_MY_ID=<span class="number">2</span></span></span><br><span class="line"><span class="ruby">      - ZOO_SERVERS=server.<span class="number">1</span>=<span class="symbol">zookeeper1:</span><span class="number">2888</span><span class="symbol">:</span><span class="number">3888</span> server.<span class="number">2</span>=<span class="symbol">zookeeper2:</span><span class="number">2888</span><span class="symbol">:</span><span class="number">3888</span> server.<span class="number">3</span>=<span class="symbol">zookeeper3:</span><span class="number">2888</span><span class="symbol">:</span><span class="number">3888</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">    <span class="comment"># 存储数据与日志</span></span></span><br><span class="line"><span class="ruby">    - ./data/zookeeper2/<span class="symbol">data:</span>/data</span></span><br><span class="line"><span class="ruby">    - ./data/zookeeper2/<span class="symbol">datalog:</span>/datalog</span></span><br><span class="line"><span class="ruby">    <span class="symbol">networks:</span></span></span><br><span class="line"><span class="ruby">      <span class="symbol">default:</span></span></span><br><span class="line"><span class="ruby">        <span class="symbol">aliases:</span></span></span><br><span class="line"><span class="ruby">          - jicki</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">  <span class="symbol">zookeeper3:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> zookeeper3</span></span><br><span class="line"><span class="ruby">    <span class="symbol">hostname:</span> zookeeper3</span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-zookeeper</span></span><br><span class="line"><span class="ruby">    <span class="symbol">restart:</span> always</span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - ZOO_MY_ID=<span class="number">3</span></span></span><br><span class="line"><span class="ruby">      - ZOO_SERVERS=server.<span class="number">1</span>=<span class="symbol">zookeeper1:</span><span class="number">2888</span><span class="symbol">:</span><span class="number">3888</span> server.<span class="number">2</span>=<span class="symbol">zookeeper2:</span><span class="number">2888</span><span class="symbol">:</span><span class="number">3888</span> server.<span class="number">3</span>=<span class="symbol">zookeeper3:</span><span class="number">2888</span><span class="symbol">:</span><span class="number">3888</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">    <span class="comment"># 存储数据与日志</span></span></span><br><span class="line"><span class="ruby">    - ./data/zookeeper3/<span class="symbol">data:</span>/data</span></span><br><span class="line"><span class="ruby">    - ./data/zookeeper3/<span class="symbol">datalog:</span>/datalog</span></span><br><span class="line"><span class="ruby">    <span class="symbol">networks:</span></span></span><br><span class="line"><span class="ruby">      <span class="symbol">default:</span></span></span><br><span class="line"><span class="ruby">        <span class="symbol">aliases:</span></span></span><br><span class="line"><span class="ruby">          - jicki</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">  <span class="symbol">kafka0:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> kafka<span class="number">0</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">hostname:</span> kafka<span class="number">0</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-kafka</span></span><br><span class="line"><span class="ruby">    <span class="symbol">restart:</span> always</span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_BROKER_ID=<span class="number">1</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># 设置一个M值,数据提交时会写入至少M个副本(这里M=2)（这些数据会被同步并且归属到in-sync 副本集合或ISR）M 必须小于 如下 N 值,并且大于1,既最小为2。</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_MIN_INSYNC_REPLICAS=<span class="number">2</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># 设置一个N值, N代表着每个channel都保存N个副本的数据到Kafka的代理上。N 必须大于如上 M 值, 既 N 值最小值为 3。</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_DEFAULT_REPLICATION_FACTOR=<span class="number">3</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_ZOOKEEPER_CONNECT=<span class="symbol">zookeeper1:</span><span class="number">2181</span>,<span class="symbol">zookeeper2:</span><span class="number">2181</span>,<span class="symbol">zookeeper3:</span><span class="number">2181</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># 如下99为configtx.yaml中会设置最大的区块大小(参考configtx.yaml中AbsoluteMaxBytes参数)</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># 每个区块最大有Orderer.AbsoluteMaxBytes个字节</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># 99 * 1024 * 1024 B</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_MESSAGE_MAX_BYTES=<span class="number">103809024</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># 每个通道获取的消息的字节数 如上一样</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_REPLICA_FETCH_MAX_BYTES=<span class="number">103809024</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># 数据一致性在区块链环境中是至关重要的, 我们不能从in-sync 副本（ISR）集合之外选取channel leader , 否则我们将会面临对于之前的leader产生的offsets覆盖的风险</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=<span class="literal">false</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># 关闭基于时间的日志保留方式并且避免分段到期。</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_LOG_RETENTION_MS=-<span class="number">1</span></span></span><br><span class="line"><span class="ruby">      - GODEBUG=netdns=go</span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">    <span class="comment"># 存储数据与日志.</span></span></span><br><span class="line"><span class="ruby">    - ./data/kafka1/<span class="symbol">data:</span>/data</span></span><br><span class="line"><span class="ruby">    - ./data/kafka1/<span class="symbol">data:</span>/logs</span></span><br><span class="line"><span class="ruby">    <span class="symbol">networks:</span></span></span><br><span class="line"><span class="ruby">      <span class="symbol">default:</span></span></span><br><span class="line"><span class="ruby">        <span class="symbol">aliases:</span></span></span><br><span class="line"><span class="ruby">          - jicki</span></span><br><span class="line"><span class="ruby">    <span class="symbol">depends_on:</span></span></span><br><span class="line"><span class="ruby">      - zookeeper1</span></span><br><span class="line"><span class="ruby">      - zookeeper2</span></span><br><span class="line"><span class="ruby">      - zookeeper3</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">  <span class="symbol">kafka1:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> kafka1</span></span><br><span class="line"><span class="ruby">    <span class="symbol">hostname:</span> kafka1</span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-kafka</span></span><br><span class="line"><span class="ruby">    <span class="symbol">restart:</span> always</span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_BROKER_ID=<span class="number">2</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_MIN_INSYNC_REPLICAS=<span class="number">2</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_DEFAULT_REPLICATION_FACTOR=<span class="number">3</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_ZOOKEEPER_CONNECT=<span class="symbol">zookeeper1:</span><span class="number">2181</span>,<span class="symbol">zookeeper2:</span><span class="number">2181</span>,<span class="symbol">zookeeper3:</span><span class="number">2181</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_MESSAGE_MAX_BYTES=<span class="number">103809024</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_REPLICA_FETCH_MAX_BYTES=<span class="number">103809024</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=<span class="literal">false</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_LOG_RETENTION_MS=-<span class="number">1</span></span></span><br><span class="line"><span class="ruby">      - GODEBUG=netdns=go</span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">    <span class="comment"># 存储数据与日志.</span></span></span><br><span class="line"><span class="ruby">    - ./data/kafka1/<span class="symbol">data:</span>/data</span></span><br><span class="line"><span class="ruby">    - ./data/kafka1/<span class="symbol">data:</span>/logs</span></span><br><span class="line"><span class="ruby">    <span class="symbol">networks:</span></span></span><br><span class="line"><span class="ruby">      <span class="symbol">default:</span></span></span><br><span class="line"><span class="ruby">        <span class="symbol">aliases:</span></span></span><br><span class="line"><span class="ruby">          - jicki</span></span><br><span class="line"><span class="ruby">    <span class="symbol">depends_on:</span></span></span><br><span class="line"><span class="ruby">      - zookeeper1</span></span><br><span class="line"><span class="ruby">      - zookeeper2</span></span><br><span class="line"><span class="ruby">      - zookeeper3</span></span><br><span class="line"><span class="ruby">          </span></span><br><span class="line"><span class="ruby">  <span class="symbol">kafka2:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> kafka2</span></span><br><span class="line"><span class="ruby">    <span class="symbol">hostname:</span> kafka2</span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-kafka</span></span><br><span class="line"><span class="ruby">    <span class="symbol">restart:</span> always</span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_BROKER_ID=<span class="number">3</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_MIN_INSYNC_REPLICAS=<span class="number">2</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_DEFAULT_REPLICATION_FACTOR=<span class="number">3</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_ZOOKEEPER_CONNECT=<span class="symbol">zookeeper1:</span><span class="number">2181</span>,<span class="symbol">zookeeper2:</span><span class="number">2181</span>,<span class="symbol">zookeeper3:</span><span class="number">2181</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_MESSAGE_MAX_BYTES=<span class="number">103809024</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_REPLICA_FETCH_MAX_BYTES=<span class="number">103809024</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=<span class="literal">false</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># 关闭基于时间的日志保留方式并且避免分段到期。</span></span></span><br><span class="line"><span class="ruby">      - KAFKA_LOG_RETENTION_MS=-<span class="number">1</span></span></span><br><span class="line"><span class="ruby">      - GODEBUG=netdns=go</span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">    <span class="comment"># 存储数据与日志.</span></span></span><br><span class="line"><span class="ruby">    - ./data/kafka2/<span class="symbol">data:</span>/data</span></span><br><span class="line"><span class="ruby">    - ./data/kafka2/<span class="symbol">data:</span>/logs</span></span><br><span class="line"><span class="ruby">    <span class="symbol">networks:</span></span></span><br><span class="line"><span class="ruby">      <span class="symbol">default:</span></span></span><br><span class="line"><span class="ruby">        <span class="symbol">aliases:</span></span></span><br><span class="line"><span class="ruby">          - jicki</span></span><br><span class="line"><span class="ruby">    <span class="symbol">depends_on:</span></span></span><br><span class="line"><span class="ruby">      - zookeeper1</span></span><br><span class="line"><span class="ruby">      - zookeeper2</span></span><br><span class="line"><span class="ruby">      - zookeeper3</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">  orderer<span class="number">0</span>.jicki.<span class="symbol">me:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> orderer<span class="number">0</span>.jicki.me</span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-<span class="symbol">orderer:</span><span class="number">1.4</span>.<span class="number">0</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=jicki_default</span></span><br><span class="line"><span class="ruby">      <span class="comment"># - ORDERER_GENERAL_LOGLEVEL=error</span></span></span><br><span class="line"><span class="ruby">      - ORDERER_GENERAL_LOGLEVEL=debug</span></span><br><span class="line"><span class="ruby">      - ORDERER_GENERAL_LISTENADDRESS=<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span></span></span><br><span class="line"><span class="ruby">      - ORDERER_GENERAL_LISTENPORT=<span class="number">7050</span></span></span><br><span class="line"><span class="ruby">      <span class="comment">#- ORDERER_GENERAL_GENESISPROFILE=AntiMothOrdererGenesis</span></span></span><br><span class="line"><span class="ruby">      - ORDERER_GENERAL_GENESISMETHOD=file</span></span><br><span class="line"><span class="ruby">      - ORDERER_GENERAL_GENESISFILE=<span class="regexp">/var/hyperledger</span><span class="regexp">/orderer/orderer</span>.genesis.block</span></span><br><span class="line"><span class="ruby">      - ORDERER_GENERAL_LOCALMSPID=OrdererMSP</span></span><br><span class="line"><span class="ruby">      - ORDERER_GENERAL_LOCALMSPDIR=<span class="regexp">/var/hyperledger</span><span class="regexp">/orderer/msp</span></span></span><br><span class="line"><span class="ruby">      <span class="comment">#- ORDERER_GENERAL_LEDGERTYPE=ram</span></span></span><br><span class="line"><span class="ruby">      <span class="comment">#- ORDERER_GENERAL_LEDGERTYPE=file</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># enabled TLS</span></span></span><br><span class="line"><span class="ruby">      - ORDERER_GENERAL_TLS_ENABLED=<span class="literal">true</span></span></span><br><span class="line"><span class="ruby">      - ORDERER_GENERAL_TLS_PRIVATEKEY=<span class="regexp">/var/hyperledger</span><span class="regexp">/orderer/tls</span><span class="regexp">/server.key</span></span></span><br><span class="line"><span class="ruby">      - ORDERER_GENERAL_TLS_CERTIFICATE=<span class="regexp">/var/hyperledger</span><span class="regexp">/orderer/tls</span><span class="regexp">/server.crt</span></span></span><br><span class="line"><span class="ruby">      - ORDERER_GENERAL_TLS_ROOTCAS=[<span class="regexp">/var/hyperledger</span><span class="regexp">/orderer/tls</span><span class="regexp">/ca.crt, /etc</span><span class="regexp">/hyperledger/crypto</span><span class="regexp">/peerOrg1/tls</span><span class="regexp">/ca.crt, /etc</span><span class="regexp">/hyperledger/crypto</span><span class="regexp">/peerOrg2/tls</span><span class="regexp">/ca.crt]</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># KAFKA</span></span></span><br><span class="line"><span class="ruby">      - ORDERER_KAFKA_RETRY_LONGINTERVAL=<span class="number">10</span>s</span></span><br><span class="line"><span class="ruby">      - ORDERER_KAFKA_RETRY_LONGTOTAL=<span class="number">100</span>s</span></span><br><span class="line"><span class="ruby">      - ORDERER_KAFKA_RETRY_SHORTINTERVAL=<span class="number">1</span>s</span></span><br><span class="line"><span class="ruby">      - ORDERER_KAFKA_RETRY_SHORTTOTAL=<span class="number">30</span>s</span></span><br><span class="line"><span class="ruby">      - ORDERER_KAFKA_VERBOSE=<span class="literal">true</span></span></span><br><span class="line"><span class="ruby">      - ORDERER_KAFKA_BROKERS=[<span class="symbol">kafka0:</span><span class="number">9092</span>,<span class="symbol">kafka1:</span><span class="number">9092</span>,<span class="symbol">kafka2:</span><span class="number">9092</span>]</span></span><br><span class="line"><span class="ruby">      - GODEBUG=netdns=go</span></span><br><span class="line"><span class="ruby">    <span class="symbol">working_dir:</span> /opt/gopath/src/github.com/hyperledger/fabric</span></span><br><span class="line"><span class="ruby">    <span class="symbol">command:</span> orderer</span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">    - ./channel-artifacts/genesis.<span class="symbol">block:</span>/var/hyperledger/orderer/orderer.genesis.block</span></span><br><span class="line"><span class="ruby">    - ./crypto-config/ordererOrganizations/jicki.me/orderers/orderer<span class="number">0</span>.jicki.me/<span class="symbol">msp:</span>/var/hyperledger/orderer/msp</span></span><br><span class="line"><span class="ruby">    - ./crypto-config/ordererOrganizations/jicki.me/orderers/orderer<span class="number">0</span>.jicki.me/tls/<span class="symbol">:/var/hyperledger/orderer/tls</span></span></span><br><span class="line"><span class="ruby">    - ./crypto-config/peerOrganizations/org1.jicki.me/peers/peer<span class="number">0</span>.org1.jicki.me/<span class="symbol">:/etc/hyperledger/crypto/peerOrg1</span></span></span><br><span class="line"><span class="ruby">    - ./crypto-config/peerOrganizations/org2.jicki.me/peers/peer<span class="number">0</span>.org2.jicki.me/<span class="symbol">:/etc/hyperledger/crypto/peerOrg2</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">networks:</span></span></span><br><span class="line"><span class="ruby">      <span class="symbol">default:</span></span></span><br><span class="line"><span class="ruby">        <span class="symbol">aliases:</span></span></span><br><span class="line"><span class="ruby">          - jicki</span></span><br><span class="line"><span class="ruby">    <span class="symbol">ports:</span></span></span><br><span class="line"><span class="ruby">      - <span class="number">7050</span><span class="symbol">:</span><span class="number">7050</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">depends_on:</span></span></span><br><span class="line"><span class="ruby">      - kafka<span class="number">0</span></span></span><br><span class="line"><span class="ruby">      - kafka1</span></span><br><span class="line"><span class="ruby">      - kafka2</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">  ca.org1.jicki.<span class="symbol">me:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> ca.org1.jicki.me</span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-<span class="symbol">ca:</span><span class="number">1.4</span>.<span class="number">0</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_HOME=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric-ca-server</span></span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_SERVER_CA_NAME=ca-org1</span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_SERVER_TLS_ENABLED=<span class="literal">true</span></span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_SERVER_CA_CERTFILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric-ca-server-config/ca</span>.org1.jicki.me-cert.pem</span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_SERVER_CA_KEYFILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric-ca-server-config/</span><span class="number">3</span>a233ccbd6706cee4c66a320e43bedad3e72b6f68e831ce121f35760eb1ac275_sk</span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_SERVER_TLS_CERTFILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric-ca-server-config/ca</span>.org1.jicki.me-cert.pem</span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_SERVER_TLS_KEYFILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric-ca-server-config/</span><span class="number">3</span>a233ccbd6706cee4c66a320e43bedad3e72b6f68e831ce121f35760eb1ac275_sk</span></span><br><span class="line"><span class="ruby">      - GODEBUG=netdns=go</span></span><br><span class="line"><span class="ruby">    <span class="symbol">ports:</span></span></span><br><span class="line"><span class="ruby">      - <span class="string">"7054:7054"</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">command:</span> sh -c <span class="string">'fabric-ca-server start --ca.certfile /etc/hyperledger/fabric-ca-server-config/ca.org1.jicki.me-cert.pem --ca.keyfile /etc/hyperledger/fabric-ca-server-config/3a233ccbd6706cee4c66a320e43bedad3e72b6f68e831ce121f35760eb1ac275_sk -b admin:adminpw -d'</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">      - ./crypto-config/peerOrganizations/org1.jicki.me/ca/<span class="symbol">:/etc/hyperledger/fabric-ca-server-config</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">depends_on:</span></span></span><br><span class="line"><span class="ruby">      - orderer<span class="number">0</span>.jicki.me</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">  ca.org2.jicki.<span class="symbol">me:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> ca.org2.jicki.me</span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-<span class="symbol">ca:</span><span class="number">1.4</span>.<span class="number">0</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_HOME=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric-ca-server</span></span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_SERVER_CA_NAME=ca-org2</span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_SERVER_TLS_ENABLED=<span class="literal">true</span></span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_SERVER_CA_CERTFILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric-ca-server-config/ca</span>.org2.jicki.me-cert.pem</span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_SERVER_CA_KEYFILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric-ca-server-config/</span><span class="number">7</span>ae61d566e35ebdcffa42a90e385d6698ffa457b69c3a56b94dfd77d8a2cfe96_sk</span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_SERVER_TLS_CERTFILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric-ca-server-config/ca</span>.org2.jicki.me-cert.pem</span></span><br><span class="line"><span class="ruby">      - FABRIC_CA_SERVER_TLS_KEYFILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric-ca-server-config/</span><span class="number">7</span>ae61d566e35ebdcffa42a90e385d6698ffa457b69c3a56b94dfd77d8a2cfe96_sk</span></span><br><span class="line"><span class="ruby">      - GODEBUG=netdns=go</span></span><br><span class="line"><span class="ruby">    <span class="symbol">ports:</span></span></span><br><span class="line"><span class="ruby">      - <span class="string">"8054:7054"</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">command:</span> sh -c <span class="string">'fabric-ca-server start --ca.certfile /etc/hyperledger/fabric-ca-server-config/ca.org2.jicki.me-cert.pem --ca.keyfile /etc/hyperledger/fabric-ca-server-config/7ae61d566e35ebdcffa42a90e385d6698ffa457b69c3a56b94dfd77d8a2cfe96_sk -b admin:adminpw -d'</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">      - ./crypto-config/peerOrganizations/org2.jicki.me/ca/<span class="symbol">:/etc/hyperledger/fabric-ca-server-config</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">depends_on:</span></span></span><br><span class="line"><span class="ruby">      - orderer<span class="number">0</span>.jicki.me</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">  <span class="symbol">couchdb0:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> couchdb<span class="number">0</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-<span class="symbol">couchdb:</span><span class="number">0</span>.<span class="number">4.10</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - COUCHDB_USER=</span></span><br><span class="line"><span class="ruby">      - COUCHDB_PASSWORD=</span></span><br><span class="line"><span class="ruby">    <span class="comment">#ports:</span></span></span><br><span class="line"><span class="ruby">    <span class="comment">#  - "5984:5984"</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># 数据持久化，用于存储链码值</span></span></span><br><span class="line"><span class="ruby">      - ./data/couchdb<span class="number">0</span>/<span class="symbol">data:</span>/opt/couchdb/data</span></span><br><span class="line"><span class="ruby">    <span class="symbol">networks:</span></span></span><br><span class="line"><span class="ruby">      <span class="symbol">default:</span></span></span><br><span class="line"><span class="ruby">        <span class="symbol">aliases:</span></span></span><br><span class="line"><span class="ruby">          - jicki</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">  <span class="symbol">couchdb1:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> couchdb1</span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-<span class="symbol">couchdb:</span><span class="number">0</span>.<span class="number">4.10</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - COUCHDB_USER=</span></span><br><span class="line"><span class="ruby">      - COUCHDB_PASSWORD=</span></span><br><span class="line"><span class="ruby">    <span class="comment">#ports:</span></span></span><br><span class="line"><span class="ruby">    <span class="comment">#  - "6984:5984"</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># 数据持久化，用于存储链码值</span></span></span><br><span class="line"><span class="ruby">      - ./data/couchdb1/<span class="symbol">data:</span>/opt/couchdb/data</span></span><br><span class="line"><span class="ruby">    <span class="symbol">networks:</span></span></span><br><span class="line"><span class="ruby">      <span class="symbol">default:</span></span></span><br><span class="line"><span class="ruby">        <span class="symbol">aliases:</span></span></span><br><span class="line"><span class="ruby">          - jicki</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">  peer<span class="number">0</span>.org1.jicki.<span class="symbol">me:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> peer<span class="number">0</span>.org1.jicki.me</span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-<span class="symbol">peer:</span><span class="number">1.4</span>.<span class="number">0</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - CORE_LEDGER_STATE_STATEDATABASE=CouchDB</span></span><br><span class="line"><span class="ruby">      - CORE_LEDGER_STATE_COUCHDBCONFIG_COUCHDBADDRESS=<span class="symbol">couchdb0:</span><span class="number">5984</span></span></span><br><span class="line"><span class="ruby">      </span></span><br><span class="line"><span class="ruby">      - CORE_PEER_ID=peer<span class="number">0</span>.org1.jicki.me</span></span><br><span class="line"><span class="ruby">      - CORE_PEER_NETWORKID=jicki</span></span><br><span class="line"><span class="ruby">      - CORE_PEER_ADDRESS=peer<span class="number">0</span>.org1.jicki.<span class="symbol">me:</span><span class="number">7051</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_CHAINCODELISTENADDRESS=peer<span class="number">0</span>.org1.jicki.<span class="symbol">me:</span><span class="number">7052</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer<span class="number">0</span>.org1.jicki.<span class="symbol">me:</span><span class="number">7051</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_LOCALMSPID=Org1MSP</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">      - CORE_VM_ENDPOINT=<span class="symbol">unix:</span>/<span class="regexp">//host</span><span class="regexp">/var/run</span><span class="regexp">/docker.sock</span></span></span><br><span class="line"><span class="ruby">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=jicki</span></span><br><span class="line"><span class="ruby">      <span class="comment"># - CORE_LOGGING_LEVEL=ERROR</span></span></span><br><span class="line"><span class="ruby">      - CORE_LOGGING_LEVEL=DEBUG</span></span><br><span class="line"><span class="ruby">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=jicki_default</span></span><br><span class="line"><span class="ruby">      - CORE_PEER_GOSSIP_SKIPHANDSHAKE=<span class="literal">true</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_GOSSIP_USELEADERELECTION=<span class="literal">true</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_GOSSIP_ORGLEADER=<span class="literal">false</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_PROFILE_ENABLED=<span class="literal">false</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_TLS_ENABLED=<span class="literal">true</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_TLS_CERT_FILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric/tls</span><span class="regexp">/server.crt</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_TLS_KEY_FILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric/tls</span><span class="regexp">/server.key</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_TLS_ROOTCERT_FILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric/tls</span><span class="regexp">/ca.crt</span></span></span><br><span class="line"><span class="ruby">      - GODEBUG=netdns=go</span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">        - <span class="regexp">/var/run</span><span class="regexp">/:/host</span><span class="regexp">/var/run</span><span class="regexp">/</span></span></span><br><span class="line"><span class="ruby">        - ./crypto-config/peerOrganizations/org1.jicki.me/peers/peer<span class="number">0</span>.org1.jicki.me/<span class="symbol">msp:</span>/etc/hyperledger/fabric/msp</span></span><br><span class="line"><span class="ruby">        - ./crypto-config/peerOrganizations/org1.jicki.me/peers/peer<span class="number">0</span>.org1.jicki.me/<span class="symbol">tls:</span>/etc/hyperledger/fabric/tls</span></span><br><span class="line"><span class="ruby">        <span class="comment"># 数据持久化, 存储安装，以及实例化智能合约的数据</span></span></span><br><span class="line"><span class="ruby">        - ./data/<span class="symbol">peer0org1:</span>/var/hyperledger/production</span></span><br><span class="line"><span class="ruby">    <span class="symbol">working_dir:</span> /opt/gopath/src/github.com/hyperledger/fabric/peer</span></span><br><span class="line"><span class="ruby">    <span class="symbol">command:</span> peer node start</span></span><br><span class="line"><span class="ruby">    <span class="symbol">ports:</span></span></span><br><span class="line"><span class="ruby">      - <span class="number">7051</span><span class="symbol">:</span><span class="number">7051</span></span></span><br><span class="line"><span class="ruby">      - <span class="number">7052</span><span class="symbol">:</span><span class="number">7052</span></span></span><br><span class="line"><span class="ruby">      - <span class="number">7053</span><span class="symbol">:</span><span class="number">7053</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">networks:</span></span></span><br><span class="line"><span class="ruby">      <span class="symbol">default:</span></span></span><br><span class="line"><span class="ruby">        <span class="symbol">aliases:</span></span></span><br><span class="line"><span class="ruby">          - jicki</span></span><br><span class="line"><span class="ruby">    <span class="symbol">depends_on:</span></span></span><br><span class="line"><span class="ruby">      - couchdb<span class="number">0</span></span></span><br><span class="line"><span class="ruby">      - ca.org1.jicki.me</span></span><br><span class="line"><span class="ruby">      - orderer<span class="number">0</span>.jicki.me</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">  peer<span class="number">0</span>.org2.jicki.<span class="symbol">me:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> peer<span class="number">0</span>.org2.jicki.me</span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-<span class="symbol">peer:</span><span class="number">1.4</span>.<span class="number">0</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - CORE_LEDGER_STATE_STATEDATABASE=CouchDB</span></span><br><span class="line"><span class="ruby">      - CORE_LEDGER_STATE_COUCHDBCONFIG_COUCHDBADDRESS=<span class="symbol">couchdb1:</span><span class="number">5984</span></span></span><br><span class="line"><span class="ruby">      </span></span><br><span class="line"><span class="ruby">      - CORE_PEER_ID=peer<span class="number">0</span>.org2.jicki.me</span></span><br><span class="line"><span class="ruby">      - CORE_PEER_NETWORKID=jicki</span></span><br><span class="line"><span class="ruby">      - CORE_PEER_ADDRESS=peer<span class="number">0</span>.org2.jicki.<span class="symbol">me:</span><span class="number">7051</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_CHAINCODELISTENADDRESS=peer<span class="number">0</span>.org2.jicki.<span class="symbol">me:</span><span class="number">7052</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer<span class="number">0</span>.org2.jicki.<span class="symbol">me:</span><span class="number">7051</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_LOCALMSPID=Org2MSP</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">      - CORE_VM_ENDPOINT=<span class="symbol">unix:</span>/<span class="regexp">//host</span><span class="regexp">/var/run</span><span class="regexp">/docker.sock</span></span></span><br><span class="line"><span class="ruby">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=jicki</span></span><br><span class="line"><span class="ruby">      <span class="comment"># - CORE_LOGGING_LEVEL=ERROR</span></span></span><br><span class="line"><span class="ruby">      - CORE_LOGGING_LEVEL=DEBUG</span></span><br><span class="line"><span class="ruby">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=jicki_default</span></span><br><span class="line"><span class="ruby">      - CORE_PEER_GOSSIP_SKIPHANDSHAKE=<span class="literal">true</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_GOSSIP_USELEADERELECTION=<span class="literal">true</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_GOSSIP_ORGLEADER=<span class="literal">false</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_PROFILE_ENABLED=<span class="literal">false</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_TLS_ENABLED=<span class="literal">true</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_TLS_CERT_FILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric/tls</span><span class="regexp">/server.crt</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_TLS_KEY_FILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric/tls</span><span class="regexp">/server.key</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_TLS_ROOTCERT_FILE=<span class="regexp">/etc/hyperledger</span><span class="regexp">/fabric/tls</span><span class="regexp">/ca.crt</span></span></span><br><span class="line"><span class="ruby">      - GODEBUG=netdns=go</span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">        - <span class="regexp">/var/run</span><span class="regexp">/:/host</span><span class="regexp">/var/run</span><span class="regexp">/</span></span></span><br><span class="line"><span class="ruby">        - ./crypto-config/peerOrganizations/org2.jicki.me/peers/peer<span class="number">0</span>.org2.jicki.me/<span class="symbol">msp:</span>/etc/hyperledger/fabric/msp</span></span><br><span class="line"><span class="ruby">        - ./crypto-config/peerOrganizations/org2.jicki.me/peers/peer<span class="number">0</span>.org2.jicki.me/<span class="symbol">tls:</span>/etc/hyperledger/fabric/tls</span></span><br><span class="line"><span class="ruby">        <span class="comment"># 数据持久化, 存储安装，以及实例化智能合约的数据</span></span></span><br><span class="line"><span class="ruby">        - ./data/<span class="symbol">peer0org2:</span>/var/hyperledger/production</span></span><br><span class="line"><span class="ruby">    <span class="symbol">working_dir:</span> /opt/gopath/src/github.com/hyperledger/fabric/peer</span></span><br><span class="line"><span class="ruby">    <span class="symbol">command:</span> peer node start</span></span><br><span class="line"><span class="ruby">    <span class="symbol">ports:</span></span></span><br><span class="line"><span class="ruby">      - <span class="number">8051</span><span class="symbol">:</span><span class="number">7051</span></span></span><br><span class="line"><span class="ruby">      - <span class="number">8052</span><span class="symbol">:</span><span class="number">7052</span></span></span><br><span class="line"><span class="ruby">      - <span class="number">8053</span><span class="symbol">:</span><span class="number">7053</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">networks:</span></span></span><br><span class="line"><span class="ruby">      <span class="symbol">default:</span></span></span><br><span class="line"><span class="ruby">        <span class="symbol">aliases:</span></span></span><br><span class="line"><span class="ruby">          - jicki</span></span><br><span class="line"><span class="ruby">    <span class="symbol">depends_on:</span></span></span><br><span class="line"><span class="ruby">      - couchdb1</span></span><br><span class="line"><span class="ruby">      - ca.org2.jicki.me</span></span><br><span class="line"><span class="ruby">      - orderer<span class="number">0</span>.jicki.me</span></span><br><span class="line"><span class="ruby">  <span class="symbol">cli:</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">container_name:</span> cli</span></span><br><span class="line"><span class="ruby">    <span class="symbol">image:</span> hyperledger/fabric-<span class="symbol">tools:</span><span class="number">1.4</span>.<span class="number">0</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">tty:</span> <span class="literal">true</span></span></span><br><span class="line"><span class="ruby">    <span class="symbol">environment:</span></span></span><br><span class="line"><span class="ruby">      - GOPATH=<span class="regexp">/opt/gopath</span></span></span><br><span class="line"><span class="ruby">      - GODEBUG=netdns=go</span></span><br><span class="line"><span class="ruby">      - CORE_VM_ENDPOINT=<span class="symbol">unix:</span>/<span class="regexp">//host</span><span class="regexp">/var/run</span><span class="regexp">/docker.sock</span></span></span><br><span class="line"><span class="ruby">      <span class="comment"># - CORE_LOGGING_LEVEL=ERROR</span></span></span><br><span class="line"><span class="ruby">      - CORE_LOGGING_LEVEL=DEBUG</span></span><br><span class="line"><span class="ruby">      - CORE_PEER_ID=cli</span></span><br><span class="line"><span class="ruby">      - CORE_PEER_ADDRESS=peer<span class="number">0</span>.org1.jicki.<span class="symbol">me:</span><span class="number">7051</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_LOCALMSPID=Org1MSP</span></span><br><span class="line"><span class="ruby">      - CORE_PEER_TLS_ENABLED=<span class="literal">true</span></span></span><br><span class="line"><span class="ruby">      - CORE_PEER_TLS_CERT_FILE=<span class="regexp">/opt/gopath</span><span class="regexp">/src/github</span>.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.jicki.me/peers/peer<span class="number">0</span>.org1.jicki.me/tls/server.crt</span></span><br><span class="line"><span class="ruby">      - CORE_PEER_TLS_KEY_FILE=<span class="regexp">/opt/gopath</span><span class="regexp">/src/github</span>.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.jicki.me/peers/peer<span class="number">0</span>.org1.jicki.me/tls/server.key</span></span><br><span class="line"><span class="ruby">      - CORE_PEER_TLS_ROOTCERT_FILE=<span class="regexp">/opt/gopath</span><span class="regexp">/src/github</span>.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.jicki.me/peers/peer<span class="number">0</span>.org1.jicki.me/tls/ca.crt</span></span><br><span class="line"><span class="ruby">      - CORE_PEER_MSPCONFIGPATH=<span class="regexp">/opt/gopath</span><span class="regexp">/src/github</span>.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.jicki.me/users/Admin@org1.jicki.me/msp</span></span><br><span class="line"><span class="ruby">    <span class="symbol">working_dir:</span> /opt/gopath/src/github.com/hyperledger/fabric/peer</span></span><br><span class="line"><span class="ruby">    <span class="symbol">volumes:</span></span></span><br><span class="line"><span class="ruby">        - <span class="regexp">/var/run</span><span class="regexp">/:/host</span><span class="regexp">/var/run</span><span class="regexp">/</span></span></span><br><span class="line"><span class="ruby">        - ./data/cli/<span class="symbol">peer:</span>/opt/gopath/src/github.com/hyperledger/fabric/peer</span></span><br><span class="line"><span class="ruby">        - ./data/cli/chaincode/go/<span class="symbol">:/opt/gopath/src/github</span>.com/hyperledger/fabric/jicki/chaincode/go</span></span><br><span class="line"><span class="ruby">        - ./crypto-<span class="symbol">config:</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/</span></span><br><span class="line"><span class="ruby">        - ./channel-<span class="symbol">artifacts:</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts</span></span><br><span class="line"><span class="ruby">    <span class="symbol">networks:</span></span></span><br><span class="line"><span class="ruby">      <span class="symbol">default:</span></span></span><br><span class="line"><span class="ruby">        <span class="symbol">aliases:</span></span></span><br><span class="line"><span class="ruby">          - jicki</span></span><br><span class="line"><span class="ruby">    <span class="symbol">depends_on:</span></span></span><br><span class="line"><span class="ruby">      - ca.org1.jicki.me</span></span><br><span class="line"><span class="ruby">      - ca.org2.jicki.me</span></span><br><span class="line"><span class="ruby">      - orderer<span class="number">0</span>.jicki.me</span></span><br><span class="line"><span class="ruby">      - peer<span class="number">0</span>.org1.jicki.me</span></span><br><span class="line"><span class="ruby">      - peer<span class="number">0</span>.org2.jicki.me</span></span><br></pre></td></tr></table></figure>
<h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker-compose up -d</span></span><br></pre></td></tr></table></figure>
<h2 id="8-Hyperledger-Fabric-创建-Channel"><a href="#8-Hyperledger-Fabric-创建-Channel" class="headerlink" title="8. Hyperledger Fabric 创建 Channel"></a>8. Hyperledger Fabric 创建 Channel</h2><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 上面我们创建了 cli 容器，我们可以直接进入 容器里操作</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root<span class="variable">@localhost</span> jicki]<span class="comment"># docker exec -it cli bash</span></span><br><span class="line">root<span class="variable">@0b55c64a9853</span><span class="symbol">:/opt/gopath/src/github</span>.com/hyperledger/fabric/peer<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行 创建命令 (未启动 认证)</span></span><br><span class="line"></span><br><span class="line">peer channel create -c mychannel -f ./channel-artifacts/channel.tx --orderer orderer0.jicki.me:7050</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提示如下表示认证不通过</span></span><br><span class="line">Error: failed <span class="keyword">to</span> create deliver client: rpc error: code = Unavailable desc = all SubConns are <span class="keyword">in</span> TransientFailure, latest<span class="built_in"> connection </span>error: &lt;<span class="literal">nil</span>&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 以下为启用认证</span></span><br><span class="line">peer channel create -o orderer0.jicki.me:7050 -c mychannel -f ./channel-artifacts/channel.tx --tls <span class="variable">$CORE_PEER_TLS_ENABLED</span> --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/jicki.me/orderers/orderer0.jicki.me/msp/tlscacerts/tlsca.jicki.me-cert.pem</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出如下:</span></span><br><span class="line"></span><br><span class="line">2019-10-29 05:47:10.407 UTC [main] InitCmd -&gt; WARN 001 CORE_LOGGING_LEVEL is <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line">2019-10-29 05:47:10.423 UTC [main] SetOrdererEnv -&gt; WARN 002 CORE_LOGGING_LEVEL is <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line">2019-10-29 05:47:10.426 UTC [channelCmd] InitCmdFactory -&gt; <span class="builtin-name">INFO</span> 003 Endorser <span class="keyword">and</span> orderer connections initialized</span><br><span class="line">2019-10-29 05:47:10.479 UTC [cli.common] readBlock -&gt; <span class="builtin-name">INFO</span> 004 Got status: &amp;&#123;SERVICE_UNAVAILABLE&#125;</span><br><span class="line">2019-10-29 05:47:10.483 UTC [channelCmd] InitCmdFactory -&gt; <span class="builtin-name">INFO</span> 005 Endorser <span class="keyword">and</span> orderer connections initialized</span><br><span class="line">2019-10-29 05:47:10.685 UTC [cli.common] readBlock -&gt; <span class="builtin-name">INFO</span> 006 Got status: &amp;&#123;SERVICE_UNAVAILABLE&#125;</span><br><span class="line">2019-10-29 05:47:10.687 UTC [channelCmd] InitCmdFactory -&gt; <span class="builtin-name">INFO</span> 007 Endorser <span class="keyword">and</span> orderer connections initialized</span><br><span class="line">2019-10-29 05:47:10.890 UTC [cli.common] readBlock -&gt; <span class="builtin-name">INFO</span> 008 Received block: 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建以后生成文件 mychannel.block</span></span><br><span class="line"></span><br><span class="line">total 24</span><br><span class="line">-rw-r--r-- 1 root root 15632 Oct 29 05:47 mychannel.block</span><br><span class="line">drwxr-xr-x 2 root root  4096 Oct 29 05:42 channel-artifacts</span><br><span class="line">drwxr-xr-x 4 root root  4096 Oct 29 05:25 crypto</span><br></pre></td></tr></table></figure>
<h2 id="9-Hyperledger-Fabric-加入-Channel"><a href="#9-Hyperledger-Fabric-加入-Channel" class="headerlink" title="9. Hyperledger Fabric 加入 Channel"></a>9. Hyperledger Fabric 加入 Channel</h2><blockquote>
<p>我们这边有2个 peer 所以需要分别加入, 后续有多少个 peer 都需要加入到 Channel 中</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># peer0.org1.jicki.me 加入 此 channel 中，首先需要查看如下 环境变量</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$CORE_PEER_LOCALMSPID</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$CORE_PEER_ADDRESS</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$CORE_PEER_MSPCONFIGPATH</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$CORE_PEER_TLS_ROOTCERT_FILE</span></span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加入 channel (未开启认证)</span></span><br><span class="line"></span><br><span class="line">peer channel join -b mychannel.block</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加入 channel (开启认证)</span></span><br><span class="line"></span><br><span class="line">peer channel join -b mychannel.block -o orderer0.jicki.me:7050 --tls <span class="variable">$CORE_PEER_TLS_ENABLED</span> --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/jicki.me/orderers/orderer0.jicki.me/msp/tlscacerts/tlsca.jicki.me-cert.pem</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出如下: </span></span><br><span class="line"></span><br><span class="line">2019-10-29 06:35:49.083 UTC [main] InitCmd -&gt; WARN 001 CORE_LOGGING_LEVEL is <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line">2019-10-29 06:35:49.097 UTC [main] SetOrdererEnv -&gt; WARN 002 CORE_LOGGING_LEVEL is <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line">2019-10-29 06:35:49.101 UTC [channelCmd] InitCmdFactory -&gt; <span class="builtin-name">INFO</span> 003 Endorser <span class="keyword">and</span> orderer connections initialized</span><br><span class="line">2019-10-29 06:35:49.293 UTC [channelCmd] executeJoin -&gt; <span class="builtin-name">INFO</span> 004 Successfully submitted<span class="built_in"> proposal </span><span class="keyword">to</span> join channel</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># peer1.org2.jicki.me 加入 此 channel 中，这里配置一下环境变量</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CORE_PEER_LOCALMSPID</span>=<span class="string">"Org2MSP"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CORE_PEER_ADDRESS</span>=peer0.org2.jicki.me:7051</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CORE_PEER_TLS_ROOTCERT_FILE</span>=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.jicki.me/peers/peer0.org2.jicki.me/tls/ca.crt</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CORE_PEER_MSPCONFIGPATH</span>=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.jicki.me/users/Admin@org2.jicki.me/msp</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加入 channel (未开启认证)</span></span><br><span class="line"></span><br><span class="line">peer channel join -b mychannel.block</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加入 channel (开启认证)</span></span><br><span class="line"></span><br><span class="line">peer channel join -b mychannel.block -o orderer0.jicki.me:7050 --tls <span class="variable">$CORE_PEER_TLS_ENABLED</span> --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/jicki.me/orderers/orderer0.jicki.me/msp/tlscacerts/tlsca.jicki.me-cert.pem</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入如下:</span></span><br><span class="line"></span><br><span class="line">2019-10-29 06:36:34.577 UTC [main] InitCmd -&gt; WARN 001 CORE_LOGGING_LEVEL is <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line">2019-10-29 06:36:34.595 UTC [main] SetOrdererEnv -&gt; WARN 002 CORE_LOGGING_LEVEL is <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line">2019-10-29 06:36:34.599 UTC [channelCmd] InitCmdFactory -&gt; <span class="builtin-name">INFO</span> 003 Endorser <span class="keyword">and</span> orderer connections initialized</span><br><span class="line">2019-10-29 06:36:34.717 UTC [channelCmd] executeJoin -&gt; <span class="builtin-name">INFO</span> 004 Successfully submitted<span class="built_in"> proposal </span><span class="keyword">to</span> join channel</span><br></pre></td></tr></table></figure>
<h2 id="10-Hyperledger-Fabric-实例化测试"><a href="#10-Hyperledger-Fabric-实例化测试" class="headerlink" title="10. Hyperledger Fabric 实例化测试"></a>10. Hyperledger Fabric 实例化测试</h2><blockquote>
<p>在上面我们已经拷贝了官方的例子，在 chaincode 下, 下面我们来测试一下</p>
</blockquote>
<h3 id="10-1-安装智能合约"><a href="#10-1-安装智能合约" class="headerlink" title="10.1 安装智能合约"></a>10.1 安装智能合约</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cli 部分  ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/jicki/chaincode/go</span></span><br><span class="line"><span class="comment"># 为 智能合约的目录 我们约定为这个目录 需要预先创建 </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mkdir -p /opt/jicki/data/cli/chaincode/go/</span><br><span class="line"></span><br><span class="line">cd /opt/jicki/data/cli/chaincode/go/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建以后~我们拷贝官方的 例子进来，方便后面进行合约测试</span></span><br><span class="line"></span><br><span class="line">cp -r /opt/jicki/fabric/examples/chaincode/go/example0* /opt/jicki/data/cli/chaincode/go/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 官方这里有5个例子</span></span><br><span class="line"></span><br><span class="line">[root@localhost jicki]# ls -lt chaincode/go/</span><br><span class="line">total 20</span><br><span class="line">drwxr-xr-x 3 root root 4096 Oct 29 14:37 example01</span><br><span class="line">drwxr-xr-x 3 root root 4096 Oct 29 14:37 example02</span><br><span class="line">drwxr-xr-x 3 root root 4096 Oct 29 14:37 example03</span><br><span class="line">drwxr-xr-x 3 root root 4096 Oct 29 14:37 example04</span><br><span class="line">drwxr-xr-x 3 root root 4096 Oct 29 14:37 example05</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如上我们挂载的地址为 github.com/hyperledger/fabric/jicki/chaincode/go</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注: 这里面的 example02 的 package 为 example02 会报错</span></span><br><span class="line"></span><br><span class="line">Error: could <span class="keyword">not</span> assemble transaction, err<span class="built_in"> Proposal </span>response was <span class="keyword">not</span> successful, <span class="builtin-name">error</span> code 500, msg failed <span class="keyword">to</span> execute transaction 819b581ce88604e9b6651764324876f2ca7a47d7aeb7ee307f273af867a4a134: <span class="builtin-name">error</span> starting container: <span class="builtin-name">error</span> starting container: API <span class="builtin-name">error</span> (404): oci runtime error: container_linux.go:247: starting container process caused <span class="string">"exec: \"chaincode\": executable file not found in <span class="variable">$PATH</span>"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 chaincode.go  chaincode_test.go 中  package 修改成 main 然后在最下面增加 main()函数</span></span><br><span class="line"></span><br><span class="line">package example02 修改为 package main</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在最后添加如下:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">        err := shim.Start(new(SimpleChaincode))</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">                fmt.Printf(<span class="string">"Error starting Simple chaincode: %s"</span>, err)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装指定合约到 所有的 peer 节点中，每个节点都必须安装一次</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 同样需要先配置变量</span></span><br><span class="line"></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CORE_PEER_LOCALMSPID</span>=<span class="string">"Org1MSP"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CORE_PEER_ADDRESS</span>=peer0.org1.jicki.me:7051</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CORE_PEER_TLS_ROOTCERT_FILE</span>=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.jicki.me/peers/peer0.org1.jicki.me/tls/ca.crt</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CORE_PEER_MSPCONFIGPATH</span>=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.jicki.me/users/Admin@org1.jicki.me/msp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 合约</span></span><br><span class="line"></span><br><span class="line">peer chaincode install -n example2 -p github.com/hyperledger/fabric/jicki/chaincode/go/example02 -v 1.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出如下:</span></span><br><span class="line"></span><br><span class="line">2019-10-29 06:43:32.933 UTC [main] InitCmd -&gt; WARN 001 CORE_LOGGING_LEVEL is <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line">2019-10-29 06:43:32.947 UTC [main] SetOrdererEnv -&gt; WARN 002 CORE_LOGGING_LEVEL is <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line">2019-10-29 06:43:32.955 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; <span class="builtin-name">INFO</span> 003 Using<span class="built_in"> default </span>escc</span><br><span class="line">2019-10-29 06:43:32.955 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; <span class="builtin-name">INFO</span> 004 Using<span class="built_in"> default </span>vscc</span><br><span class="line">2019-10-29 06:43:33.665 UTC [chaincodeCmd] install -&gt; <span class="builtin-name">INFO</span> 005 Installed remotely response:&lt;status:200 payload:<span class="string">"OK"</span> &gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装指定合约到 所有的 peer 节点中，每个节点都必须安装一次</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 同样需要先配置变量</span></span><br><span class="line"></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CORE_PEER_LOCALMSPID</span>=<span class="string">"Org2MSP"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CORE_PEER_ADDRESS</span>=peer0.org2.jicki.me:7051</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CORE_PEER_TLS_ROOTCERT_FILE</span>=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.jicki.me/peers/peer0.org2.jicki.me/tls/ca.crt</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CORE_PEER_MSPCONFIGPATH</span>=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.jicki.me/users/Admin@org2.jicki.me/msp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 合约</span></span><br><span class="line"></span><br><span class="line">peer chaincode install -n example2 -p github.com/hyperledger/fabric/jicki/chaincode/go/example02 -v 1.0  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出如下:</span></span><br><span class="line"></span><br><span class="line">2019-10-29 06:44:06.573 UTC [main] InitCmd -&gt; WARN 001 CORE_LOGGING_LEVEL is <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line">2019-10-29 06:44:06.588 UTC [main] SetOrdererEnv -&gt; WARN 002 CORE_LOGGING_LEVEL is <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line">2019-10-29 06:44:06.596 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; <span class="builtin-name">INFO</span> 003 Using<span class="built_in"> default </span>escc</span><br><span class="line">2019-10-29 06:44:06.596 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; <span class="builtin-name">INFO</span> 004 Using<span class="built_in"> default </span>vscc</span><br><span class="line">2019-10-29 06:44:06.826 UTC [chaincodeCmd] install -&gt; <span class="builtin-name">INFO</span> 005 Installed remotely response:&lt;status:200 payload:<span class="string">"OK"</span> &gt;</span><br></pre></td></tr></table></figure>
<h3 id="10-2-实例化-Chaincode"><a href="#10-2-实例化-Chaincode" class="headerlink" title="10.2 实例化 Chaincode"></a>10.2 实例化 Chaincode</h3><blockquote>
<p>这里无论多少个 peer 节点, 实例化只需要实例化一次，就可以。</p>
</blockquote>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 实例化合约 (未认证)</span></span><br><span class="line">peer chaincode instantiate -o orderer0.jicki.<span class="keyword">me</span>:<span class="number">7050</span> -C mychannel -n example2 -c '&#123;<span class="string">"Args"</span>:[<span class="string">"init"</span>,<span class="string">"A"</span>,<span class="string">"200"</span>,<span class="string">"B"</span>,<span class="string">"500"</span>]&#125;' -P <span class="string">"OR ('Org1MSP.member','Org2MSP.member')"</span> -v <span class="number">1.0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 实例化合约 (已认证)</span><br><span class="line">peer chaincode instantiate -o orderer0.jicki.me:<span class="number">7050</span> --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/jicki.me/orderers/orderer0.jicki.me/msp/tlscacerts/tlsca.jicki.me-cert.pem -C mychannel -n example2 -c '&#123;<span class="string">"Args"</span>:[<span class="string">"init"</span>,<span class="string">"A"</span>,<span class="string">"200"</span>,<span class="string">"B"</span>,<span class="string">"500"</span>]&#125;' -P <span class="string">"OR ('Org1MSP.member','Org2MSP.member')"</span> -v <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 输出如下:</span><br><span class="line"></span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">06</span>:<span class="number">48</span>:<span class="number">30.883</span> UTC [main] InitCmd -&gt; WARN <span class="number">001</span> CORE_LOGGING_LEVEL is no longer supported, please <span class="keyword">use</span> the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">06</span>:<span class="number">48</span>:<span class="number">30.897</span> UTC [main] SetOrdererEnv -&gt; WARN <span class="number">002</span> CORE_LOGGING_LEVEL is no longer supported, please <span class="keyword">use</span> the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">06</span>:<span class="number">48</span>:<span class="number">30.908</span> UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; INFO <span class="number">003</span> Using <span class="keyword">default</span> escc</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">06</span>:<span class="number">48</span>:<span class="number">30.908</span> UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; INFO <span class="number">004</span> Using <span class="keyword">default</span> vscc</span><br></pre></td></tr></table></figure>
<h3 id="10-3-操作智能合约"><a href="#10-3-操作智能合约" class="headerlink" title="10.3 操作智能合约"></a>10.3 操作智能合约</h3><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># query 查询方法</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 A 账户里的余额</span></span><br><span class="line"></span><br><span class="line">peer chaincode query -C mychannel -n example2 -c <span class="string">'&#123;"Args":["query","A"]&#125;'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出如下:</span></span><br><span class="line"></span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">06</span>:<span class="number">49</span>:<span class="number">30.885</span> UTC [main] InitCmd<span class="function"> -&gt;</span> WARN <span class="number">001</span> CORE_LOGGING_LEVEL <span class="keyword">is</span> <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">06</span>:<span class="number">49</span>:<span class="number">30.901</span> UTC [main] SetOrdererEnv<span class="function"> -&gt;</span> WARN <span class="number">002</span> CORE_LOGGING_LEVEL <span class="keyword">is</span> <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line"><span class="number">200</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以看到 返回 200</span></span><br></pre></td></tr></table></figure>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询 B 账户里的余额</span></span><br><span class="line"></span><br><span class="line">peer chaincode query -C mychannel -n example2 -c <span class="string">'&#123;"Args":["query","B"]&#125;'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出如下:</span></span><br><span class="line"></span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">06</span>:<span class="number">50</span>:<span class="number">27.353</span> UTC [main] InitCmd<span class="function"> -&gt;</span> WARN <span class="number">001</span> CORE_LOGGING_LEVEL <span class="keyword">is</span> <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">06</span>:<span class="number">50</span>:<span class="number">27.368</span> UTC [main] SetOrdererEnv<span class="function"> -&gt;</span> WARN <span class="number">002</span> CORE_LOGGING_LEVEL <span class="keyword">is</span> <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line"><span class="number">500</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以看到 返回 500</span></span><br></pre></td></tr></table></figure>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># invoke 转账方法</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从A账户 转账 100 个币 到 B 账户 (未认证)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">peer chaincode<span class="built_in"> invoke </span>-C mychannel -n example2 -c '&#123;<span class="string">"Args"</span>:[<span class="string">"invoke"</span>, <span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"100"</span>]&#125;'</span><br></pre></td></tr></table></figure>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从A账户 转账 100 个币 到 B 账户 (开启认证)</span></span><br><span class="line"></span><br><span class="line">peer chaincode<span class="built_in"> invoke </span>-C mychannel -n example2 -c '&#123;<span class="string">"Args"</span>:[<span class="string">"invoke"</span>, <span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"100"</span>]&#125;' -o orderer0.jicki.me:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/jicki.me/orderers/orderer0.jicki.me/msp/tlscacerts/tlsca.jicki.me-cert.pem</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出如下:</span></span><br><span class="line"></span><br><span class="line">2019-10-29 06:51:12.681 UTC [main] InitCmd -&gt; WARN 001 CORE_LOGGING_LEVEL is no longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line">2019-10-29 06:51:12.695 UTC [main] SetOrdererEnv -&gt; WARN 002 CORE_LOGGING_LEVEL is no longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line">2019-10-29 06:51:12.721 UTC [chaincodeCmd] chaincodeInvokeOrQuery -&gt; INFO 003 Chaincode<span class="built_in"> invoke </span>successful. result: status:200 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以看到返回 invoke successful. result: status:200 成功</span></span><br></pre></td></tr></table></figure>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这里再查询 A 与 B 的账户</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A 账户余额 </span></span><br><span class="line"></span><br><span class="line">peer chaincode query -C mychannel -n example2 -c <span class="string">'&#123;"Args":["query","A"]&#125;'</span>  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出如下:</span></span><br><span class="line"></span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">06</span>:<span class="number">51</span>:<span class="number">43.325</span> UTC [main] InitCmd<span class="function"> -&gt;</span> WARN <span class="number">001</span> CORE_LOGGING_LEVEL <span class="keyword">is</span> <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">06</span>:<span class="number">51</span>:<span class="number">43.340</span> UTC [main] SetOrdererEnv<span class="function"> -&gt;</span> WARN <span class="number">002</span> CORE_LOGGING_LEVEL <span class="keyword">is</span> <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line"><span class="number">100</span></span><br></pre></td></tr></table></figure>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># B 账户余额 </span></span><br><span class="line"></span><br><span class="line">peer chaincode query -C mychannel -n example2 -c <span class="string">'&#123;"Args":["query","B"]&#125;'</span>   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出如下:</span></span><br><span class="line"></span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">06</span>:<span class="number">51</span>:<span class="number">55.761</span> UTC [main] InitCmd<span class="function"> -&gt;</span> WARN <span class="number">001</span> CORE_LOGGING_LEVEL <span class="keyword">is</span> <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line"><span class="number">2019</span>-<span class="number">10</span>-<span class="number">29</span> <span class="number">06</span>:<span class="number">51</span>:<span class="number">55.775</span> UTC [main] SetOrdererEnv<span class="function"> -&gt;</span> WARN <span class="number">002</span> CORE_LOGGING_LEVEL <span class="keyword">is</span> <span class="literal">no</span> longer supported, please use the FABRIC_LOGGING_SPEC environment variable</span><br><span class="line"><span class="number">600</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 查看 <span class="selector-tag">peer0</span><span class="selector-class">.org1</span><span class="selector-class">.jicki</span><span class="selector-class">.me</span> 节点里 生成的容器</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[root@localhost jicki]</span># <span class="selector-tag">docker</span> <span class="selector-tag">ps</span> <span class="selector-tag">-a</span></span><br><span class="line"><span class="selector-tag">CONTAINER</span> <span class="selector-tag">ID</span>        <span class="selector-tag">IMAGE</span>                                                                                                     <span class="selector-tag">COMMAND</span>                  <span class="selector-tag">CREATED</span>             <span class="selector-tag">STATUS</span>              <span class="selector-tag">PORTS</span>                                                                                         <span class="selector-tag">NAMES</span></span><br><span class="line">1<span class="selector-tag">e3b763e3034</span>        <span class="selector-tag">jicki-peer0</span><span class="selector-class">.org2</span><span class="selector-class">.jicki</span><span class="selector-class">.me-example2-1</span><span class="selector-class">.0-3b619b4d039726a6e131bc22c779eab46f4f1325e0299f289761f6372e0fc252</span>   "<span class="selector-tag">chaincode</span> <span class="selector-tag">-peer</span><span class="selector-class">.add</span>…"   3 <span class="selector-tag">minutes</span> <span class="selector-tag">ago</span>       <span class="selector-tag">Up</span> 3 <span class="selector-tag">minutes</span>                                                                                 <span class="selector-tag">jicki-peer0</span><span class="selector-class">.org2</span><span class="selector-class">.jicki</span><span class="selector-class">.me-example2-1</span><span class="selector-class">.0</span></span><br></pre></td></tr></table></figure>
<h2 id="11-Hyperledger-Fabric-操作命令"><a href="#11-Hyperledger-Fabric-操作命令" class="headerlink" title="11. Hyperledger Fabric 操作命令"></a>11. Hyperledger Fabric 操作命令</h2><h3 id="peer-命令"><a href="#peer-命令" class="headerlink" title="peer 命令"></a>peer 命令</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">peer chaincode          # 对链进行操作</span><br><span class="line">peer channel            # channel相关操作</span><br><span class="line">peer<span class="built_in"> logging </span>           # 设置日志级别</span><br><span class="line">peer node               # 启动、管理节点</span><br><span class="line">peer version            # 查看版本信息</span><br></pre></td></tr></table></figure>
<blockquote>
<p>upgrade 更新合约 更新合约相当于将合约重新实例化，并带有一个新的版本号。</p>
<p>更新合约之前，需要在所有的 peer节点 上安装(install)最新的合约，并使用新的版本号。</p>
</blockquote>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更新合约</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 首先安装(install)新的合约, 以本文为例, chaincode_example02, 初次安装版本号为 1.0 </span></span><br><span class="line"></span><br><span class="line">peer chaincode install -n example2 -p github.com/hyperledger/fabric/jicki/chaincode/go/chaincode_example02 -v <span class="number">1.1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新版本为 1.1 的合约 (未开启认证)</span></span><br><span class="line">peer chaincode upgrade -o orderer0.jicki.<span class="keyword">me</span>:<span class="number">7050</span> -C mychannel -n example2 -c '&#123;<span class="string">"Args"</span>:[<span class="string">"init"</span>,<span class="string">"A"</span>,<span class="string">"100"</span>,<span class="string">"B"</span>,<span class="string">"50"</span>]&#125;' -P <span class="string">"OR ('Org1MSP.member','Org2MSP.member')"</span> -v <span class="number">1.1</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新版本为 1.1 的合约 (开启认证)</span></span><br><span class="line">peer chaincode upgrade -o orderer0.jicki.<span class="keyword">me</span>:<span class="number">7050</span> -C mychannel -n example2 -c '&#123;<span class="string">"Args"</span>:[<span class="string">"init"</span>,<span class="string">"A"</span>,<span class="string">"100"</span>,<span class="string">"B"</span>,<span class="string">"50"</span>]&#125;' -P <span class="string">"OR ('Org1MSP.member','Org2MSP.member')"</span> -v <span class="number">1.1</span> -o orderer0.jicki.<span class="keyword">me</span>:<span class="number">7050</span> <span class="comment">--tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/jicki.me/orderers/orderer0.jicki.me/msp/tlscacerts/tlsca.jicki.me-cert.pem</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 旧版本的合约, 目前，fabric不支持合约的启动与暂停。要暂停或删除合约，只能到peer上手动删除容器。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 已经创建的 通道 (channel)</span></span><br><span class="line"></span><br><span class="line">peer channel  list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看通道(channel) 的状态 -c(小写) 加 通道名称</span></span><br><span class="line"></span><br><span class="line">peer channel getinfo -c mychannel</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看已经 安装的 智能合约(chincode)</span></span><br><span class="line"></span><br><span class="line">peer chaincode  list --installed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看已经 实例化的 智能合约(chincode) 需要使用 -C(大写) 加通道名称</span></span><br><span class="line"></span><br><span class="line">peer chaincode -C mychannel list --instantiated</span><br></pre></td></tr></table></figure>
<h1 id="二-配置-Hyperledger-Fabric-balance-transfer"><a href="#二-配置-Hyperledger-Fabric-balance-transfer" class="headerlink" title="二. 配置 Hyperledger Fabric balance-transfer"></a>二. 配置 Hyperledger Fabric balance-transfer</h1><h2 id="1-安装-node-js"><a href="#1-安装-node-js" class="headerlink" title="1. 安装 node.js"></a>1. 安装 node.js</h2><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装NodeJS</span></span><br><span class="line"> curl --silent --<span class="keyword">location</span> <span class="title">https</span>://rpm.nodesource.com/setup_8.x | sudo bash -</span><br><span class="line"> </span><br><span class="line"> yum install -y nodejs</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># 验证</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">node</span> <span class="title">-v</span></span><br><span class="line">v8.<span class="number">11.4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">npm -v</span><br><span class="line"><span class="number">5.6</span>.<span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改 npm 源为 taobao 源</span></span><br><span class="line"></span><br><span class="line">npm install <span class="keyword">node</span><span class="title">-gyp</span> --<span class="attr">registry=</span>https://registry.npm.taobao.org</span><br><span class="line"></span><br><span class="line">npm install <span class="keyword">node</span><span class="title">-pre-gyp</span> --<span class="attr">registry=</span>https://registry.npm.taobao.org</span><br><span class="line"></span><br><span class="line">npm install grpc --<span class="attr">registry=</span>https://registry.npm.taobao.org</span><br><span class="line"></span><br><span class="line">npm install --<span class="attr">registry=</span>https://registry.npm.taobao.org</span><br><span class="line"></span><br><span class="line">npm rebuild</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装一下 jq </span></span><br><span class="line"></span><br><span class="line"> yum install jq -y</span><br></pre></td></tr></table></figure>
<h2 id="2-下载源码"><a href="#2-下载源码" class="headerlink" title="2. 下载源码"></a>2. 下载源码</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> /<span class="keyword">opt</span>/jicki</span><br><span class="line"></span><br><span class="line">git clone http<span class="variable">s:</span>//github.<span class="keyword">com</span>/hyperledger/fabric-samples.git</span><br><span class="line"></span><br><span class="line">mv fabric-samples/balance-transfer .</span><br></pre></td></tr></table></figure>
<h2 id="3-修改配置文件"><a href="#3-修改配置文件" class="headerlink" title="3. 修改配置文件"></a>3. 修改配置文件</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">mv</span> <span class="string">network-config.yaml</span> <span class="string">network-config.yaml-bak</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 增加 network-config 文件</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">vi</span> <span class="string">network-config.yaml</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">"balance-transfer"</span></span><br><span class="line"><span class="attr">x-type:</span> <span class="string">"hlfv1"</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">"Balance Transfer Network"</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">"1.0"</span></span><br><span class="line"><span class="attr">channels:</span></span><br><span class="line"><span class="attr">  mychannel:</span></span><br><span class="line"><span class="attr">    orderers:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">orderer0.jicki.me</span>    <span class="attr">peers:</span></span><br><span class="line">      <span class="string">peer0.org1.jicki.me:</span></span><br><span class="line"><span class="attr">        endorsingPeer:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">        chaincodeQuery:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">        ledgerQuery:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">        eventSource:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">#peer1.org1.jicki.me:</span></span><br><span class="line">      <span class="comment">#  endorsingPeer: false</span></span><br><span class="line">      <span class="comment">#  chaincodeQuery: true</span></span><br><span class="line">      <span class="comment">#  ledgerQuery: true</span></span><br><span class="line">      <span class="comment">#  eventSource: false</span></span><br><span class="line"></span><br><span class="line">      <span class="string">peer0.org2.jicki.me:</span></span><br><span class="line"><span class="attr">        endorsingPeer:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">        chaincodeQuery:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">        ledgerQuery:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">        eventSource:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">#peer1.org2.jicki.me:</span></span><br><span class="line">      <span class="comment">#  endorsingPeer: false</span></span><br><span class="line">      <span class="comment">#  chaincodeQuery: true</span></span><br><span class="line">      <span class="comment">#  ledgerQuery: true</span></span><br><span class="line">      <span class="comment">#  eventSource: false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    chaincodes:</span></span><br><span class="line"><span class="attr">      - mycc:</span><span class="string">v0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">organizations:</span></span><br><span class="line"><span class="attr">  Org1:</span></span><br><span class="line"><span class="attr">    mspid:</span> <span class="string">Org1MSP</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    peers:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">peer0.org1.jicki.me</span></span><br><span class="line">      <span class="comment">#- peer1.org1.jicki.me</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    certificateAuthorities:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ca-org1</span></span><br><span class="line"><span class="attr">    adminPrivateKey:</span></span><br><span class="line"><span class="attr">      path:</span> <span class="string">artifacts/channel/crypto-config/peerOrganizations/org1.jicki.me/users/Admin@org1.jicki.me/msp/keystore/a9666f561d211e7b7cc170bfe854721431a1038b7914a67555d82dcf6b9eaaf8_sk</span></span><br><span class="line"><span class="attr">    signedCert:</span></span><br><span class="line"><span class="attr">      path:</span> <span class="string">artifacts/channel/crypto-config/peerOrganizations/org1.jicki.me/users/Admin@org1.jicki.me/msp/signcerts/Admin@org1.jicki.me-cert.pem</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  Org2:</span></span><br><span class="line"><span class="attr">    mspid:</span> <span class="string">Org2MSP</span></span><br><span class="line"><span class="attr">    peers:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">peer0.org2.jicki.me</span></span><br><span class="line">      <span class="comment">#- peer1.org2.jicki.me</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    certificateAuthorities:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ca-org2</span></span><br><span class="line"><span class="attr">    adminPrivateKey:</span></span><br><span class="line"><span class="attr">      path:</span> <span class="string">artifacts/channel/crypto-config/peerOrganizations/org2.jicki.me/users/Admin@org2.jicki.me/msp/keystore/d402b684b807080653511978a51fcd2326668156cd8a10fb612b80bc49c9b354_sk</span></span><br><span class="line"><span class="attr">    signedCert:</span></span><br><span class="line"><span class="attr">      path:</span> <span class="string">artifacts/channel/crypto-config/peerOrganizations/org2.jicki.me/users/Admin@org2.jicki.me/msp/signcerts/Admin@org2.jicki.me-cert.pem</span></span><br><span class="line"></span><br><span class="line"><span class="attr">orderers:</span></span><br><span class="line">  <span class="string">orderer0.jicki.me:</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">grpcs://localhost:7050</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    grpcOptions:</span></span><br><span class="line"><span class="attr">      ssl-target-name-override:</span> <span class="string">orderer0.jicki.me</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    tlsCACerts:</span></span><br><span class="line"><span class="attr">      path:</span> <span class="string">artifacts/channel/crypto-config/ordererOrganizations/jicki.me/orderers/orderer0.jicki.me/tls/ca.crt</span></span><br><span class="line"></span><br><span class="line"><span class="attr">peers:</span></span><br><span class="line">  <span class="string">peer0.org1.jicki.me:</span></span><br><span class="line">    <span class="comment"># this URL is used to send endorsement and query requests</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">grpcs://localhost:7051</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    grpcOptions:</span></span><br><span class="line"><span class="attr">      ssl-target-name-override:</span> <span class="string">peer0.org1.jicki.me</span></span><br><span class="line"><span class="attr">    tlsCACerts:</span></span><br><span class="line"><span class="attr">      path:</span> <span class="string">artifacts/channel/crypto-config/peerOrganizations/org1.jicki.me/peers/peer0.org1.jicki.me/tls/ca.crt</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#peer1.org1.jicki.me:</span></span><br><span class="line">  <span class="comment">#  url: grpcs://localhost:7056</span></span><br><span class="line">  <span class="comment">#  grpcOptions:</span></span><br><span class="line">  <span class="comment">#    ssl-target-name-override: peer1.org1.jicki.me</span></span><br><span class="line">  <span class="comment">#  tlsCACerts:</span></span><br><span class="line">  <span class="comment">#    path: artifacts/channel/crypto-config/peerOrganizations/org1.jicki.me/peers/peer1.org1.jicki.me/tls/ca.crt</span></span><br><span class="line"></span><br><span class="line">  <span class="string">peer0.org2.jicki.me:</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">grpcs://localhost:8051</span></span><br><span class="line"><span class="attr">    grpcOptions:</span></span><br><span class="line"><span class="attr">      ssl-target-name-override:</span> <span class="string">peer0.org2.jicki.me</span></span><br><span class="line"><span class="attr">    tlsCACerts:</span></span><br><span class="line"><span class="attr">      path:</span> <span class="string">artifacts/channel/crypto-config/peerOrganizations/org2.jicki.me/peers/peer0.org2.jicki.me/tls/ca.crt</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#peer1.org2.jicki.me:</span></span><br><span class="line">  <span class="comment">#  url: grpcs://localhost:8056</span></span><br><span class="line">  <span class="comment">#  eventUrl: grpcs://localhost:8058</span></span><br><span class="line">  <span class="comment">#  grpcOptions:</span></span><br><span class="line">  <span class="comment">#    ssl-target-name-override: peer1.org2.jicki.me</span></span><br><span class="line">  <span class="comment">#  tlsCACerts:</span></span><br><span class="line">  <span class="comment">#    path: artifacts/channel/crypto-config/peerOrganizations/org2.jicki.me/peers/peer1.org2.jicki.me/tls/ca.crt</span></span><br><span class="line"></span><br><span class="line"><span class="attr">certificateAuthorities:</span></span><br><span class="line"><span class="attr">  ca-org1:</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">https://localhost:7054</span></span><br><span class="line"><span class="attr">    httpOptions:</span></span><br><span class="line"><span class="attr">      verify:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    tlsCACerts:</span></span><br><span class="line"><span class="attr">      path:</span> <span class="string">artifacts/channel/crypto-config/peerOrganizations/org1.jicki.me/ca/ca.org1.jicki.me-cert.pem</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    registrar:</span></span><br><span class="line"><span class="attr">      - enrollId:</span> <span class="string">admin</span></span><br><span class="line"><span class="attr">        enrollSecret:</span> <span class="string">adminpw</span></span><br><span class="line"><span class="attr">    caName:</span> <span class="string">ca-org1</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  ca-org2:</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">https://localhost:8054</span></span><br><span class="line"><span class="attr">    httpOptions:</span></span><br><span class="line"><span class="attr">      verify:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    tlsCACerts:</span></span><br><span class="line"><span class="attr">      path:</span> <span class="string">artifacts/channel/crypto-config/peerOrganizations/org2.jicki.me/ca/ca.org2.jicki.me-cert.pem</span></span><br><span class="line"><span class="attr">    registrar:</span></span><br><span class="line"><span class="attr">      - enrollId:</span> <span class="string">admin</span></span><br><span class="line"><span class="attr">        enrollSecret:</span> <span class="string">adminpw</span></span><br><span class="line"><span class="attr">    caName:</span> <span class="string">ca-org2</span></span><br></pre></td></tr></table></figure>
<h2 id="4-拷贝证书文件"><a href="#4-拷贝证书文件" class="headerlink" title="4. 拷贝证书文件"></a>4. 拷贝证书文件</h2><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/jicki/balance-transfer/artifacts/</span><br><span class="line"></span><br><span class="line">mv channel channel-bak</span><br><span class="line"></span><br><span class="line">mkdir channel</span><br><span class="line"></span><br><span class="line"><span class="comment"># 拷贝自行生成的证书文件以及tx，等文件 </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@localhost channel]<span class="comment"># ls -lt</span></span><br><span class="line">总用量 56</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>root root  <span class="number"> 281 </span>11月 <span class="number"> 5 </span>16:40 Org1MSPanchors.tx</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>root root  <span class="number"> 281 </span>11月 <span class="number"> 5 </span>16:40 Org2MSPanchors.tx</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>root root  <span class="number"> 346 </span>11月 <span class="number"> 5 </span>16:40 channel.tx</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>root root<span class="number"> 12479 </span>11月 <span class="number"> 5 </span>16:40 genesis.block</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>root root<span class="number"> 15407 </span>11月 <span class="number"> 5 </span>16:39 mychannel.block</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>root root  <span class="number"> 645 </span>11月 <span class="number"> 5 </span>16:39 crypto-config.yaml</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>root root <span class="number"> 3859 </span>11月 <span class="number"> 5 </span>16:39 configtx.yaml</span><br><span class="line">drwxr-xr-x<span class="number"> 4 </span>root root   <span class="number"> 69 </span>11月 <span class="number"> 5 </span>16:38 crypto-config</span><br></pre></td></tr></table></figure>
<h2 id="5-启动-balance-transfer"><a href="#5-启动-balance-transfer" class="headerlink" title="5. 启动 balance-transfer"></a>5. 启动 balance-transfer</h2><blockquote>
<p>runApp.sh 脚本里包含了 启动 ca 节点 以及 peer 节点的docker-compose</p>
<p>如上我们已经启动过了，只需要直接运行 node app 既可，所以不需要用到此脚本</p>
</blockquote>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装依赖</span></span><br><span class="line"></span><br><span class="line">npm <span class="keyword">install</span></span><br></pre></td></tr></table></figure>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入环境变量</span></span><br><span class="line"></span><br><span class="line"><span class="attr">PORT</span>=<span class="number">4000</span> </span><br><span class="line"><span class="attr">HOST</span>=<span class="number">192.168</span>.<span class="number">168.100</span></span><br></pre></td></tr></table></figure>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">node</span> <span class="title">app</span></span><br></pre></td></tr></table></figure>
<h2 id="6-测试调用-API"><a href="#6-测试调用-API" class="headerlink" title="6. 测试调用 API"></a>6. 测试调用 API</h2><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 运行 testAPIs.sh 可全部API跑一次</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># 本文中只运行了 2个 peer </span></span><br><span class="line"></span><br><span class="line"><span class="meta"># 所以需要 编辑 testAPIs.sh 修改文件中 删除 peer1.org1.jicki.me  以及 peer1.org2.jicki.me</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># 修改  "channelConfigPath":"../artifacts/channel/mychannel.tx" 中 mychannel.tx 为 channel.tx</span></span><br></pre></td></tr></table></figure>
<h3 id="6-1-创建用户"><a href="#6-1-创建用户" class="headerlink" title="6.1 创建用户"></a>6.1 创建用户</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建用户</span></span><br><span class="line"></span><br><span class="line">curl -s -X POST <span class="symbol">http:</span>/<span class="regexp">/localhost:4000/users</span> -H <span class="string">"content-type: application/x-www-form-urlencoded"</span> -d <span class="string">'username=jicki&amp;orgName=Org1'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">"success"</span><span class="symbol">:true</span>,<span class="string">"secret"</span><span class="symbol">:<span class="string">""</span></span>,<span class="string">"message"</span><span class="symbol">:<span class="string">"jicki enrolled Successfully"</span></span>,<span class="string">"token"</span><span class="symbol">:<span class="string">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NDE2MTIwNzAsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Ik9yZzEiLCJpYXQiOjE1NDE1NzYwNzB9.pQZAqkeRW7vtwvNSrSTy4SKsVt5yFGafzlWTQjjONWE"</span></span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注册成功以后~~取 token 部分,配置成环境变量, 如下操作需用使用此 token</span></span><br><span class="line"></span><br><span class="line">ORG1_TOKEN=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NDE2MTIwNzAsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Ik9yZzEiLCJpYXQiOjE1NDE1NzYwNzB9.pQZAqkeRW7vtwvNSrSTy4SKsVt5yFGafzlWTQjjONWE</span><br></pre></td></tr></table></figure>
<h3 id="6-2-创建-channel"><a href="#6-2-创建-channel" class="headerlink" title="6.2 创建 channel"></a>6.2 创建 channel</h3><figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 创建 channel </span></span><br><span class="line"><span class="meta"># 此处 channelName 如果存在会失败~ 报如下错误</span></span><br><span class="line"></span><br><span class="line">response ::&#123;<span class="string">"status"</span>:<span class="string">"BAD_REQUEST"</span>,<span class="string">"info"</span>:<span class="string">"error authorizing update: error validating ReadSet: readset expected key [Group]  /Channel/Application at version 0, but got version 1"</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">curl -s -X POST \</span><br><span class="line">  http://localhost:<span class="number">4000</span>/channels \</span><br><span class="line">  -H <span class="string">"authorization: Bearer $ORG1_TOKEN"</span> \</span><br><span class="line">  -H <span class="string">"content-type: application/json"</span> \</span><br><span class="line">  -d <span class="comment">'&#123;</span></span><br><span class="line">    <span class="string">"channelName"</span>:<span class="string">"mychannel"</span>,</span><br><span class="line">    <span class="string">"channelConfigPath"</span>:<span class="string">"../artifacts/channel/channel.tx"</span></span><br><span class="line">&#125;<span class="comment">'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta"># 关于 channelName  需要跟 创建 channel.tx 时的 channelID 对应，否则报如下错误:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2018</span>-<span class="number">11</span>-<span class="number">09</span> <span class="number">12</span>:<span class="number">03</span>:<span class="number">28.276</span>] [DEBUG] Create-Channel -  response ::&#123;<span class="string">"status"</span>:<span class="string">"BAD_REQUEST"</span>,<span class="string">"info"</span>:<span class="string">"Failing initial channel config creation: mismatched channel IDs: 'mychannel' != 'youchannel'"</span>&#125;</span><br><span class="line">[<span class="number">2018</span>-<span class="number">11</span>-<span class="number">09</span> <span class="number">12</span>:<span class="number">03</span>:<span class="number">28.277</span>] [<span class="built_in">ERROR</span>] Create-Channel - </span><br><span class="line">!!!!!!!!! Failed <span class="keyword">to</span> create the channel <span class="comment">'youchannel' !!!!!!!!!</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2018</span>-<span class="number">11</span>-<span class="number">09</span> <span class="number">12</span>:<span class="number">03</span>:<span class="number">28.277</span>] [<span class="built_in">ERROR</span>] Create-Channel - <span class="built_in">Error</span>: Failed <span class="keyword">to</span> create the channel <span class="comment">'youchannel'</span></span><br></pre></td></tr></table></figure>
<h3 id="6-3-加入-channel"><a href="#6-3-加入-channel" class="headerlink" title="6.3 加入 channel"></a>6.3 加入 channel</h3><figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 加入 ORG1 加入 channel </span></span><br><span class="line"></span><br><span class="line"><span class="meta"># 如果已加入 channel 报如下错误:</span></span><br><span class="line"></span><br><span class="line">[DEBUG] Join-Channel - Join Channel R E S P O N S E : [<span class="literal">null</span>,[&#123;<span class="string">"status"</span>:<span class="number">500</span>,<span class="string">"payload"</span>:&#123;<span class="string">"type"</span>:<span class="string">"Buffer"</span>,<span class="string">"data"</span>:[]&#125;,<span class="string">"isProposalResponse"</span>:<span class="literal">true</span>&#125;]]</span><br><span class="line">[<span class="built_in">ERROR</span>] Join-Channel - Failed <span class="keyword">to</span> join peer <span class="keyword">to</span> the channel mychannel</span><br><span class="line">[<span class="built_in">ERROR</span>] Join-Channel - Failed <span class="keyword">to</span> join all peers <span class="keyword">to</span> channel. cause:Failed <span class="keyword">to</span> join peer <span class="keyword">to</span> the channel mychannel</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">curl -s -X POST \</span><br><span class="line">  http://localhost:<span class="number">4000</span>/channels/mychannel/peers \</span><br><span class="line">  -H <span class="string">"authorization: Bearer $ORG1_TOKEN"</span> \</span><br><span class="line">  -H <span class="string">"content-type: application/json"</span> \</span><br><span class="line">  -d <span class="comment">'&#123;</span></span><br><span class="line">    <span class="string">"peers"</span>: [<span class="string">"peer0.org1.jicki.me"</span>]</span><br><span class="line">&#125;<span class="comment">'</span></span><br></pre></td></tr></table></figure>
<h3 id="6-4-安装-chaincode"><a href="#6-4-安装-chaincode" class="headerlink" title="6.4 安装 chaincode"></a>6.4 安装 chaincode</h3><figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 为 ORG1 安装 chaincode</span></span><br><span class="line"><span class="meta"># 已存在报如下错误:</span></span><br><span class="line"></span><br><span class="line">[<span class="number">2018</span>-<span class="number">11</span>-<span class="number">07</span> <span class="number">16</span>:<span class="number">10</span>:<span class="number">44.011</span>] [<span class="built_in">ERROR</span>] install-chaincode - TypeError: proposalResponses.toJSON is <span class="keyword">not</span> a <span class="function"><span class="keyword">function</span></span></span><br><span class="line">    at Object.installChaincode (/opt/jicki/balance-transfer/app/install-chaincode.js:<span class="number">58</span>:<span class="number">66</span>)</span><br><span class="line">    at &lt;anonymous&gt;</span><br><span class="line">[<span class="number">2018</span>-<span class="number">11</span>-<span class="number">07</span> <span class="number">16</span>:<span class="number">10</span>:<span class="number">44.011</span>] [<span class="built_in">ERROR</span>] install-chaincode - Failed <span class="keyword">to</span> install due <span class="keyword">to</span>:TypeError: proposalResponses.toJSON is <span class="keyword">not</span> a <span class="function"><span class="keyword">function</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">curl -s -X POST \</span><br><span class="line">  http://localhost:<span class="number">4000</span>/chaincodes \</span><br><span class="line">  -H <span class="string">"authorization: Bearer $ORG1_TOKEN"</span> \</span><br><span class="line">  -H <span class="string">"content-type: application/json"</span> \</span><br><span class="line">  -d <span class="comment">'&#123;</span></span><br><span class="line">    <span class="string">"peers"</span>: [<span class="string">"peer0.org1.jicki.me"</span>],</span><br><span class="line">    <span class="string">"chaincodeName"</span>:<span class="string">"mycc"</span>,</span><br><span class="line">    <span class="string">"chaincodePath"</span>:<span class="string">"github.com/example_cc/go"</span>,</span><br><span class="line">    <span class="string">"chaincodeType"</span>: <span class="string">"golang"</span>,</span><br><span class="line">    <span class="string">"chaincodeVersion"</span>:<span class="string">"v0"</span></span><br><span class="line">&#125;<span class="comment">'</span></span><br></pre></td></tr></table></figure>
<h3 id="6-5-实例化chaincode"><a href="#6-5-实例化chaincode" class="headerlink" title="6.5 实例化chaincode"></a>6.5 实例化chaincode</h3><figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 如果已经实例化 报如下错误:</span></span><br><span class="line"></span><br><span class="line">[<span class="number">2018</span>-<span class="number">11</span>-<span class="number">07</span> <span class="number">16</span>:<span class="number">12</span>:<span class="number">10.040</span>] [<span class="built_in">ERROR</span>] instantiate-chaincode - instantiate proposal was bad</span><br><span class="line">[<span class="number">2018</span>-<span class="number">11</span>-<span class="number">07</span> <span class="number">16</span>:<span class="number">12</span>:<span class="number">10.040</span>] [DEBUG] instantiate-chaincode - Failed <span class="keyword">to</span> send Proposal <span class="literal">and</span> receive all good ProposalResponse</span><br><span class="line">[<span class="number">2018</span>-<span class="number">11</span>-<span class="number">07</span> <span class="number">16</span>:<span class="number">12</span>:<span class="number">10.040</span>] [<span class="built_in">ERROR</span>] instantiate-chaincode - Failed <span class="keyword">to</span> instantiate. cause:Failed <span class="keyword">to</span> send Proposal <span class="literal">and</span> receive all good ProposalResponse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">curl -s -X POST \</span><br><span class="line">  http://localhost:<span class="number">4000</span>/channels/mychannel/chaincodes \</span><br><span class="line">  -H <span class="string">"authorization: Bearer $ORG1_TOKEN"</span> \</span><br><span class="line">  -H <span class="string">"content-type: application/json"</span> \</span><br><span class="line">  -d <span class="comment">'&#123;</span></span><br><span class="line">    <span class="string">"peers"</span>: [<span class="string">"peer0.org1.jicki.me"</span>],</span><br><span class="line">    <span class="string">"chaincodeName"</span>:<span class="string">"mycc"</span>,</span><br><span class="line">    <span class="string">"chaincodeVersion"</span>:<span class="string">"v0"</span>,</span><br><span class="line">    <span class="string">"chaincodeType"</span>: <span class="string">"golang"</span>,</span><br><span class="line">    <span class="string">"args"</span>:[<span class="string">"a"</span>,<span class="string">"100"</span>,<span class="string">"b"</span>,<span class="string">"200"</span>]</span><br><span class="line">&#125;<span class="comment">'</span></span><br></pre></td></tr></table></figure>
<h3 id="6-6-查询已创建的-channel"><a href="#6-6-查询已创建的-channel" class="headerlink" title="6.6 查询已创建的 channel"></a>6.6 查询已创建的 channel</h3><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">curl -s -<span class="symbol">X</span> <span class="symbol">GET</span> \</span><br><span class="line">  <span class="string">"http://localhost:4000/channels?peer=peer0.org1.jicki.me"</span> \</span><br><span class="line">  -<span class="symbol">H</span> <span class="string">"authorization: Bearer $ORG1_TOKEN"</span> \</span><br><span class="line">  -<span class="symbol">H</span> <span class="string">"content-type: application/json"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 返回如下信息:</span><br><span class="line"></span><br><span class="line">[<span class="number">2018</span><span class="number">-11</span><span class="number">-07</span> <span class="number">16</span>:<span class="number">19</span>:<span class="number">29.592</span>] [<span class="symbol">DEBUG</span>] <span class="symbol">Query</span> - &lt;&lt;&lt; channels &gt;&gt;&gt;</span><br><span class="line">[<span class="number">2018</span><span class="number">-11</span><span class="number">-07</span> <span class="number">16</span>:<span class="number">19</span>:<span class="number">29.592</span>] [<span class="symbol">DEBUG</span>] <span class="symbol">Query</span> - [ <span class="string">'channel id: mychannel'</span> ]</span><br></pre></td></tr></table></figure>
<h3 id="6-7-查询-chaincode"><a href="#6-7-查询-chaincode" class="headerlink" title="6.7 查询 chaincode"></a>6.7 查询 chaincode</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  %5B%22a%22%5D Escape 加密以后 等于 ["a"]</span></span><br><span class="line"><span class="comment">#  %5B%22b%22%5D Escape 加密以后 等于 ["b"]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 a 的值</span></span><br><span class="line"></span><br><span class="line">curl -<span class="keyword">s</span> -X GET \</span><br><span class="line">  <span class="string">"http://localhost:4000/channels/mychannel/chaincodes/mycc?peer=peer0.org1.jicki.me&amp;fcn=query&amp;args=%5B%22a%22%5D"</span> \</span><br><span class="line">  -H <span class="string">"authorization: Bearer $ORG1_TOKEN"</span> \</span><br><span class="line">  -H <span class="string">"content-type: application/json"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出如下:</span></span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">11</span>-<span class="number">07</span> <span class="number">16</span>:<span class="number">33</span>:<span class="number">29.266</span>] [INFO] Query - a now has <span class="number">100</span> after the move</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 b 的值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">curl -<span class="keyword">s</span> -X GET \</span><br><span class="line">  <span class="string">"http://localhost:4000/channels/mychannel/chaincodes/mycc?peer=peer0.org1.jicki.me&amp;fcn=query&amp;args=%5B%22b%22%5D"</span> \</span><br><span class="line">  -H <span class="string">"authorization: Bearer $ORG1_TOKEN"</span> \</span><br><span class="line">  -H <span class="string">"content-type: application/json"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出如下:</span></span><br><span class="line"></span><br><span class="line">[<span class="number">2018</span>-<span class="number">11</span>-<span class="number">07</span> <span class="number">16</span>:<span class="number">34</span>:<span class="number">12.378</span>] [INFO] Query - b now has <span class="number">200</span> after the move</span><br></pre></td></tr></table></figure>
<h3 id="6-8-操作交易"><a href="#6-8-操作交易" class="headerlink" title="6.8 操作交易"></a>6.8 操作交易</h3><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从 A账号 转账 10 到 B账号中</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 必须配置 org1 与 org2 节点的 peers 否则报错:</span></span><br><span class="line"></span><br><span class="line">[2018-11-07 17:17:53.267] [ERROR]<span class="built_in"> invoke-chaincode </span>- The<span class="built_in"> invoke </span>chaincode transaction was invalid, code:ENDORSEMENT_POLICY_FAILURE</span><br><span class="line">[2018-11-07 17:17:53.268] [ERROR]<span class="built_in"> invoke-chaincode </span>- Error: The<span class="built_in"> invoke </span>chaincode transaction was invalid, code:ENDORSEMENT_POLICY_FAILURE</span><br><span class="line">[2018-11-07 17:17:53.268] [ERROR]<span class="built_in"> invoke-chaincode </span>- Failed to<span class="built_in"> invoke </span>chaincode. cause:Error: The<span class="built_in"> invoke </span>chaincode transaction was invalid, code:ENDORSEMENT_POLICY_FAILURE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">curl -s -X POST \</span><br><span class="line">  http://localhost:4000/channels/mychannel/chaincodes/mycc \</span><br><span class="line">  -H <span class="string">"authorization: Bearer $ORG1_TOKEN"</span> \</span><br><span class="line">  -H <span class="string">"content-type: application/json"</span> \</span><br><span class="line">  -d '&#123;</span><br><span class="line">    <span class="string">"peers"</span>: [<span class="string">"peer0.org1.jicki.me"</span>, <span class="string">"peer0.org2.jicki.me"</span>],</span><br><span class="line">    <span class="string">"fcn"</span>:<span class="string">"move"</span>,</span><br><span class="line">    <span class="string">"args"</span>:[<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"10"</span>]</span><br><span class="line">&#125;'</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出如下:</span></span><br><span class="line"></span><br><span class="line">POST<span class="built_in"> invoke </span>chaincode on peers of Org1<span class="built_in"> and </span>Org2</span><br><span class="line"></span><br><span class="line">Transaction ID is 70a5157704b950cca09a6a46f5be7fca61355b43ed83f3d9a5b633f3e38b3619</span><br></pre></td></tr></table></figure>
<h3 id="6-9-查询-chainInfo"><a href="#6-9-查询-chainInfo" class="headerlink" title="6.9 查询 chainInfo"></a>6.9 查询 chainInfo</h3><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">curl -s -X GET \</span><br><span class="line">  "http://localhost:4000/channels/mychannel?peer=peer0.org1.jicki.me" \</span><br><span class="line">  -H "authorization: Bearer $ORG1_TOKEN" \</span><br><span class="line">  -H "content-type: application/json"</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 返回如下信息:</span></span><br><span class="line"></span><br><span class="line">[2018-11-07 16:14:55.648] [DEBUG] Query - &#123; height: Long &#123; low: 5, high: 0, unsigned: true &#125;,</span><br><span class="line">  currentBlockHash: </span><br><span class="line">   ByteBuffer &#123;</span><br><span class="line">     buffer: &lt;Buffer<span class="number"> 08 </span>05<span class="number"> 12 </span>20 c0 c4 f3<span class="number"> 65 </span>a3 8a<span class="number"> 66 </span>d4 1e ff a4<span class="number"> 45 </span>3e 1c e6 2b<span class="number"> 90 </span>d3<span class="number"> 38 </span>4f<span class="number"> 18 </span>3f d5 b3<span class="number"> 38 </span>76 0e<span class="number"> 26 </span>30<span class="number"> 32 </span>e0 f9 1a<span class="number"> 20 </span>da<span class="number"> 35 </span>eb d4 1b<span class="number"> 11 </span>b2 7f 1a<span class="number"> 07 </span>c5<span class="number"> 30 </span>... &gt;,</span><br><span class="line">     offset: 4,</span><br><span class="line">     markedOffset: -1,</span><br><span class="line">     limit: 36,</span><br><span class="line">     littleEndian: true,</span><br><span class="line">     noAssert: false &#125;,</span><br><span class="line">  previousBlockHash: </span><br><span class="line">   ByteBuffer &#123;</span><br><span class="line">     buffer: &lt;Buffer<span class="number"> 08 </span>05<span class="number"> 12 </span>20 c0 c4 f3<span class="number"> 65 </span>a3 8a<span class="number"> 66 </span>d4 1e ff a4<span class="number"> 45 </span>3e 1c e6 2b<span class="number"> 90 </span>d3<span class="number"> 38 </span>4f<span class="number"> 18 </span>3f d5 b3<span class="number"> 38 </span>76 0e<span class="number"> 26 </span>30<span class="number"> 32 </span>e0 f9 1a<span class="number"> 20 </span>da<span class="number"> 35 </span>eb d4 1b<span class="number"> 11 </span>b2 7f 1a<span class="number"> 07 </span>c5<span class="number"> 30 </span>... &gt;,</span><br><span class="line">     offset: 38,</span><br><span class="line">     markedOffset: -1,</span><br><span class="line">     limit: 70,</span><br><span class="line">     littleEndian: true,</span><br><span class="line">     noAssert: false &#125; &#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-10-查询已安装-chaincode"><a href="#6-10-查询已安装-chaincode" class="headerlink" title="6.10 查询已安装 chaincode"></a>6.10 查询已安装 chaincode</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">curl -s -X <span class="builtin-name">GET</span> \</span><br><span class="line">  <span class="string">"http://localhost:4000/chaincodes?peer=peer0.org1.jicki.me&amp;type=installed"</span> \</span><br><span class="line">  -H <span class="string">"authorization: Bearer <span class="variable">$ORG1_TOKEN</span>"</span> \</span><br><span class="line">  -H <span class="string">"content-type: application/json"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回如下信息:</span></span><br><span class="line"></span><br><span class="line">[2018-11-07 16:17:01.758] [<span class="builtin-name">DEBUG</span>] Query - &lt;&lt;&lt; Installed Chaincodes &gt;&gt;&gt;</span><br><span class="line">[2018-11-07 16:17:01.758] [<span class="builtin-name">DEBUG</span>] Query - name: mycc, version: v0, path: github.com/example_cc/go</span><br></pre></td></tr></table></figure>
<h3 id="6-11-查询实例化-chaincode"><a href="#6-11-查询实例化-chaincode" class="headerlink" title="6.11 查询实例化 chaincode"></a>6.11 查询实例化 chaincode</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">curl -s -X <span class="builtin-name">GET</span> \</span><br><span class="line">  <span class="string">"http://localhost:4000/chaincodes?peer=peer0.org1.jicki.me&amp;type=instantiated"</span> \</span><br><span class="line">  -H <span class="string">"authorization: Bearer <span class="variable">$ORG1_TOKEN</span>"</span> \</span><br><span class="line">  -H <span class="string">"content-type: application/json"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回如下信息:</span></span><br><span class="line"></span><br><span class="line">[2018-11-07 16:18:06.494] [<span class="builtin-name">DEBUG</span>] Query - &lt;&lt;&lt; Installed Chaincodes &gt;&gt;&gt;</span><br><span class="line">[2018-11-07 16:18:06.494] [<span class="builtin-name">DEBUG</span>] Query - name: mycc, version: v0, path: github.com/example_cc/go</span><br></pre></td></tr></table></figure>
    </div>
    
    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="/" target="_blank">Ljjyy.com</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/archives/2019/12/100625.html" class="pre-post btn btn-default" title='修改python的pip的源，通过配置pip.conf 添加国内源'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">修改python的pip的源，通过配置pip.conf 添加国内源</span>
        </a>
    
    
        <a href="/archives/2019/11/100623.html" class="next-post btn btn-default" title='在Kubernetes 上部署 Hyperledger Fabric v1.4'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">在Kubernetes 上部署 Hyperledger Fabric v1.4</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
    <div id="vcomments" class="valine"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>

    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: '5MzTXYXkt03k101j0PmSDN34-gzGzoHsz',
            appKey: 'iwjYgwno6qj3wtDVVSbe8nYQ',
            placeholder: '说点什么吧',
            notify: false,
            verify: true,
            avatar: 'mm',
            meta: 'nick,mail'.split(','),
            pageSize: '10',
            path: window.location.pathname,
            lang: 'zh-CN'.toLowerCase()
        })
    </script>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一-部署-hyperledger-fabric-v1-4"><span class="toc-text">一. 部署 hyperledger-fabric v1.4</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-环境规划"><span class="toc-text">1. 环境规划</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-官方地址"><span class="toc-text">2. 官方地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-环境准备"><span class="toc-text">3. 环境准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Hyperledger-Fabric-源码"><span class="toc-text">4. Hyperledger Fabric 源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-生成-Hyperledger-Fabric-证书"><span class="toc-text">5. 生成 Hyperledger Fabric 证书</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-生成-Hyperledger-Fabric-创世区块"><span class="toc-text">6. 生成 Hyperledger Fabric 创世区块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-配置-fabric-docker-compose-yaml"><span class="toc-text">7. 配置 fabric docker-compose.yaml</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#启动服务"><span class="toc-text">启动服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Hyperledger-Fabric-创建-Channel"><span class="toc-text">8. Hyperledger Fabric 创建 Channel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-Hyperledger-Fabric-加入-Channel"><span class="toc-text">9. Hyperledger Fabric 加入 Channel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-Hyperledger-Fabric-实例化测试"><span class="toc-text">10. Hyperledger Fabric 实例化测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-安装智能合约"><span class="toc-text">10.1 安装智能合约</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-实例化-Chaincode"><span class="toc-text">10.2 实例化 Chaincode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-操作智能合约"><span class="toc-text">10.3 操作智能合约</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-Hyperledger-Fabric-操作命令"><span class="toc-text">11. Hyperledger Fabric 操作命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#peer-命令"><span class="toc-text">peer 命令</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二-配置-Hyperledger-Fabric-balance-transfer"><span class="toc-text">二. 配置 Hyperledger Fabric balance-transfer</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-安装-node-js"><span class="toc-text">1. 安装 node.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-下载源码"><span class="toc-text">2. 下载源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-修改配置文件"><span class="toc-text">3. 修改配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-拷贝证书文件"><span class="toc-text">4. 拷贝证书文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-启动-balance-transfer"><span class="toc-text">5. 启动 balance-transfer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-测试调用-API"><span class="toc-text">6. 测试调用 API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-创建用户"><span class="toc-text">6.1 创建用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-创建-channel"><span class="toc-text">6.2 创建 channel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-加入-channel"><span class="toc-text">6.3 加入 channel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-安装-chaincode"><span class="toc-text">6.4 安装 chaincode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-实例化chaincode"><span class="toc-text">6.5 实例化chaincode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6-查询已创建的-channel"><span class="toc-text">6.6 查询已创建的 channel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-7-查询-chaincode"><span class="toc-text">6.7 查询 chaincode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8-操作交易"><span class="toc-text">6.8 操作交易</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-9-查询-chainInfo"><span class="toc-text">6.9 查询 chainInfo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-10-查询已安装-chaincode"><span class="toc-text">6.10 查询已安装 chaincode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-11-查询实例化-chaincode"><span class="toc-text">6.11 查询实例化 chaincode</span></a></li></ol></li></ol></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2019-2023&emsp;<a href="/" class="copyright-links" target="_blank" rel="nofollow">Ljjyy.com</a>
                </span> |
                <span>
                    <a href="/about/" class="copyright-links" target="_blank" rel="nofollow">关于我们</a>
                </span> |                
                <span>
                    <a href="/sitemap.xml" class="copyright-links" target="_blank" rel="nofollow">网站地图</a>
                </span> |
                <span>
                    <a href="/archives/" class="copyright-links" target="_blank" rel="nofollow">时间轴</a>
                </span>              
            </div>
        </div>
    </div>
</div>







<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>