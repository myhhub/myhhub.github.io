<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.2.3">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="https://www.ljjyy.com">
    <!--SEO-->

    <meta name="keywords" content="知识图谱,fuseki,jena,r2rml,sparql" />


    <meta name="description" content="一. 简介结构化数据到RDF由两种主要方式，一个是通过direct mapping，另一个通过R2RML语言这种，基于R2RML语言的方式更为灵活，定制性强。对于R2RML有一些好用的工具，此处..." />



<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />

    <!--Title-->


<title>从零开始学习知识图谱 之 二.电影知识图谱构建 2.结构化数据到RDF以及基于Apache jena交互 | 来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</title>


    <link rel="alternate" href="/atom.xml" title="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    




<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7.css">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0.css">
<link rel="stylesheet" href="/css/style.css?rev=@@hash.css">





    
	<div class="hide">
        <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
        <script>LA.init({id: "JgbNOaw1xxsmUUsQ",ck: "JgbNOaw1xxsmUUsQ"})</script>
	</div>






    
    <meta name="baidu-site-verification" content="dTHILoORpx" />


    <script>
        (function(){
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>

<meta name="generator" content="Hexo 7.3.0"></head>


<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  >
    <div class="main-header-box">
        <!--a class="header-avatar" href="/" title='Ljjyy.com'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a-->
        <div class="branding">
            
                <h2> 多读书多实践，勤思考善领悟 </h2>
            
    	  </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">

        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="web-logo"  href="/" title='Ljjyy.com'></a>
                    <!--a class="navbar-brand" href="https://www.ljjyy.com">来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</a-->
                </div>
                <div class="collapse navbar-collapse" id="main-menu" style="">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/cloud/"><i class="fa "></i>云计算</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/front/"><i class="fa "></i>前端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/back/"><i class="fa "></i>后端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/devops/"><i class="fa "></i>运维</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/crack/"><i class="fa "></i>破解</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/penetration/"><i class="fa "></i>渗透</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/tool/"><i class="fa "></i>工具</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/other/"><i class="fa "></i>其他</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="从零开始学习知识图谱 之 二.电影知识图谱构建 2.结构化数据到RDF以及基于Apache jena交互">
            
	            从零开始学习知识图谱 之 二.电影知识图谱构建 2.结构化数据到RDF以及基于Apache jena交互
            
        </h1>
        <div class="post-meta">
    
        <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
            <a class="category-link" href="/categories/cloud/">云计算</a>
        </span>
    

    
        <span class="fa-wrap">
            <i class="fa fa-tags"></i>
            <span class="tags-meta">
                
                    <a class="tag-none-link" href="/tags/fuseki/" rel="tag">fuseki</a> <a class="tag-none-link" href="/tags/jena/" rel="tag">jena</a> <a class="tag-none-link" href="/tags/r2rml/" rel="tag">r2rml</a> <a class="tag-none-link" href="/tags/sparql/" rel="tag">sparql</a> <a class="tag-none-link" href="/tags/knowledgegraph/" rel="tag">知识图谱</a>
                
            </span>
        </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2019/10/17</span>
        </span>
        
    
</div>
            
            
            <p class="fa fa-exclamation-triangle warning">
                本文于<strong>1979</strong>天之前发表，文中内容可能已经过时。
            </p>
        
    </div>
    
    <div class="post-body post-content">
        <h1 id="一-简介"><a href="#一-简介" class="headerlink" title="一. 简介"></a>一. 简介</h1><p>结构化数据到RDF由两种主要方式，一个是通过direct mapping，另一个通过R2RML语言这种，基于R2RML语言的方式更为灵活，定制性强。对于R2RML有一些好用的工具，此处我们使用d2rq工具，它基于R2RML-KIT。关于这两步，SimmerChan的专栏*<a href="https://zhuanlan.zhihu.com/p/32389370">实践篇（一）：数据准备和本体建模</a>*已经介绍的很详细，此处我把针对本项目的细节和代码交代一下。</p>
<p>本教程的项目代码放在github上，下载地址为<a href="https://github.com/myhhub/zero_knowledge_graph">《从零开始学习知识图谱》项目源代码</a> 。</p>
<h1 id="二-环境准备"><a href="#二-环境准备" class="headerlink" title="二. 环境准备"></a>二. 环境准备</h1><h2 id="1-操作系统"><a href="#1-操作系统" class="headerlink" title="1. 操作系统"></a>1. 操作系统</h2><p>支持操作系统：windows、macOS、Linux。为了方便大家搭建开发环境，笔者尽可能在windows下构建，系列篇未特意说明时操作系统都是<strong>windows</strong>。Linux安装可以参考<a href="100590.html">VirtualBox虚拟机安装Ubuntu</a>或<a href="100589.html">VirtualBox虚拟机安装CentOS8</a>进行安装。</p>
<h2 id="2-jdk"><a href="#2-jdk" class="headerlink" title="2. jdk"></a>2. jdk</h2><p>安装参见<a href="100604.html">windows系统安装JDK</a></p>
<h2 id="3-Protege"><a href="#3-Protege" class="headerlink" title="3. Protege"></a>3. Protege</h2><p>斯坦福大学开发的本体编辑和知识获取软件。开发语言采用Java，属于开放源码软件。由于其优秀的设计和众多的插件，<a href="https://protege.stanford.edu/">Protege</a>已成为目前使用最广泛的本体论编辑器之一。软件不需要安装，需要配置相应的Java环境。</p>
<p>打开protege，看到和下图类似的界面。在Ontology IRI中填写我们新建本体资源的IRI。读者可以填写自己的符合标准的IRI。如下：</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//www.kgdemo.com</span></span><br></pre></td></tr></table></figure>

<h2 id="4-d2rq"><a href="#4-d2rq" class="headerlink" title="4. d2rq"></a>4. d2rq</h2><p>D2RQ平台用于访问关系数据库系统是虚拟的,只读RDF图。它提供了基于RDF的访问关系数据库的内容,而无需复制成RDF存储。使用D2RQ可参考文章<a href="https://blog.csdn.net/dqc406839653/article/details/83054710">使用d2rq的第一步</a>，<a href="http://d2rq.org/d2rq-language">官方文档</a>。</p>
<p>官方网站：<a href="http://d2rq.org/">http://d2rq.org/</a></p>
<p>a. 下载后得到了<a href="https://github.s3.amazonaws.com/downloads/d2rq/d2rq/d2rq-0.8.1.zip?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAISTNZFOVBIJMK3TQ/20190925/us-east-1/s3/aws4_request&X-Amz-Date=20190925T071020Z&X-Amz-Expires=300&X-Amz-SignedHeaders=host&X-Amz-Signature=dbb8bdb6cb59c0f812600b5089aabd5173e84852d3c349706befbb1be0c60aeb">d2rq-0.8.1.zip</a>的压缩文件，d2rq不需要安装，直接将其解压到运行目录，再配置运行环境即可。</p>
<p>b. 项目需要将d2rq与java、mysql进行联合应用，因此需要JDBC driver，将<a href="https://cdn.mysql.com//Downloads/Connector-J/mysql-connector-java-5.1.48.zip">mysql-connector-java-5.1.48-bin.jar</a>文件放入d2rq的&#x2F;lib文件夹中。</p>
<h2 id="5-Apache-jena"><a href="#5-Apache-jena" class="headerlink" title="5. Apache jena"></a>5. Apache jena</h2><p>Apache Jena是一个开源的Java语义网框架（open source Semantic Web Framework for Java），用于构建语义网和链接数据应用。安装可阅读文章<a href="https://blog.csdn.net/weixin_41104835/article/details/88635600">Jena 和 Fuseki安装与SPARQL查询</a>。</p>
<p>下载地址：<a href="http://jena.apache.org/download/">http://jena.apache.org/download/</a></p>
<p>TDB：用于存储RDF的组件。<br>Jena：提供了RDFS、OWL和通用规则推理机。下载<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/jena/binaries/apache-jena-3.12.0.zip">Jena</a><br>Fuseki：Jena提供的SPARQL服务器，也就是SPARQL endpoint。下载<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/jena/binaries/apache-jena-fuseki-3.12.0.zip">Fuseki</a></p>
<p>Apache Jena，java开发的软件免安装。</p>
<h1 id="三-项目构建"><a href="#三-项目构建" class="headerlink" title="三. 项目构建"></a>三. 项目构建</h1><h2 id="1-Direct-mapping"><a href="#1-Direct-mapping" class="headerlink" title="1. Direct mapping"></a>1. Direct mapping</h2><p>本质上是通过编写启发式规则将数据库中的表转换为RDF三元组。其对应规则如下：</p>
<ul>
<li>table to class</li>
<li>cloumn to property</li>
<li>row to resource</li>
<li>cell to literal value</li>
<li>in addition cell to URI</li>
<li>if there is a forgin key constraint</li>
</ul>
<p>也就是把表结构映射到对应的三元组中。对应于我们的数据库，可以编写规则得到如下映射结果：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@base</span> <span class="variable">&lt;http://movie.baidubaike/DB/&gt;</span> .</span><br><span class="line"><span class="meta">@prefix</span> xsd:<span class="variable">&lt;http://www.w3.org/2001/XMLSchema#&gt;</span> . </span><br><span class="line"><span class="variable">&lt;actor/actor_id=1&gt;</span> rdf:type <span class="variable">&lt;actor&gt;</span> .</span><br><span class="line"><span class="variable">&lt;actor/actor_id=1&gt;</span> <span class="variable">&lt;actor#actor_id&gt;</span> 1 . <span class="variable">&lt;actor/actor_id=1&gt;</span> <span class="variable">&lt;actor#actor_chName&gt;</span> <span class="string">&quot;周星驰&quot;</span> . <span class="variable">&lt;actor/actor_id=1&gt;</span> <span class="variable">&lt;actor#actor_bio&gt;</span> <span class="string">&quot;周星驰是。。。&quot;</span> <span class="variable">&lt;actor/actor_id=1&gt;</span> <span class="variable">&lt;actor#actor_repWorks&gt;</span> <span class="string">&quot;赌圣&quot;</span> . <span class="variable">&lt;actor/actor_id=1&gt;</span> <span class="variable">&lt;actor#ref-movie&gt;</span> <span class="variable">&lt;movie/movie_id=1&gt;</span> . ....<span class="string">&quot;其他属性&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">&lt;movie/movie_id=1&gt;</span> rdf:type <span class="variable">&lt;movie&gt;</span> .</span><br><span class="line"><span class="variable">&lt;movie/movie_id=1&gt;</span> <span class="variable">&lt;movie#movie_id&gt;</span> 1. <span class="variable">&lt;movie/movie_id=1&gt;</span> <span class="variable">&lt;movie#movie_chName&gt;</span> <span class="string">&quot;赌圣&quot;</span> . ...</span><br></pre></td></tr></table></figure>

<h2 id="2-D2RQ"><a href="#2-D2RQ" class="headerlink" title="2. D2RQ"></a>2. D2RQ</h2><p>The D2RQ Platform is a system for accessing relational databases as virtual, read-only RDF graphs. It offers RDF-based access to the content of relational databases without having to replicate it into an RDF store. Using D2RQ you can:</p>
<ul>
<li>query a non-RDF database using SPARQL</li>
<li>Zccess the content of the database as Linked Data over the Web</li>
<li>create custom dumps of the database in RDF formats for loading into an RDF store</li>
<li>access information in a non-RDF database using the Apache Jena API</li>
</ul>
<p>上面是官方对D2RQ的介绍，可以看到它的主要功能是提供以虚拟的、只读的RDF图形式进入到关系型数据库中。也就是说比如你通过SPARQL端口查询，输入是SPARQL查询语言，D2RQ通过mapping文件将其转换为SQL语句在关系数据库上查询，因此实际上访问的是关系型数据库。</p>
<p>D2RQ 由自己的mapping语言，R2RML-kit。它和W3C推荐的R2RML类似。你可以通过D2RQ提供的工具来根据数据库自动生成mapping文件。你可以根据自己的需求去修改定制自己的mapping文件。</p>
<p>用generate-mapping工具为数据库创建mapping file（映射文件）。cmd中运行 cd C:\my\d2rq命令，转到d2rq目录。</p>
<h3 id="1-运行以下命令，创建mappling映射文件。"><a href="#1-运行以下命令，创建mappling映射文件。" class="headerlink" title="1). 运行以下命令，创建mappling映射文件。"></a>1). 运行以下命令，创建mappling映射文件。</h3><p> ?useSSL&#x3D;false语句设置SSL为false以避免提示警告，数据库没设置主键会提示警告。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:\my\d2rq&gt; ./<span class="keyword">generate</span>-mapping -u root -p root -o kg_demo_mapping_baidu_baike<span class="variable">.ttl</span> jdbc:mysql:<span class="comment">///baidu_baike?useSSL=false</span></span><br><span class="line">## -u 后root是数据库用户，-p 后root是用户密码,jdbc:mysql: 后baidu_baike是数据库名称；</span><br><span class="line">## 注意笔者是Windows PowerShell命令窗口运行命令，若在cmd中去掉前面的./，即：<span class="keyword">generate</span>-mapping开始。下面的命令也如此。</span><br></pre></td></tr></table></figure>

<p>下面是根据我们定义的本体修改的mapping文件。</p>
<p>a. 为了表达简练，我们给本体做一些修改。</p>
<p>这样<code>http://www.kgdemo.com#Actor就可以表达为</code>:Actor，其他的词汇同理。</p>
<p><em>vocab</em>前缀，它表示输出本体的命名空间，也就是说，所有来自<em>D2RQ</em>的<em>RDF</em>都必须使用具有<em>vocab</em>前缀的命名空间的类和属性描述。这样做的目的是为了使它们是唯一的，在需要读取某个类或属性时可以直接操作，而不必先动态获得命名空间了。</p>
<p>b. 把默认的映射词汇改为我们本体中的词汇即可。在处理外键的时候要注意当前编辑的属性的domain和range，belongsToClassMap是domain，refersToClassMap是range。</p>
<p>为了实现生成及修改全自自动，需编写dos下的bat实现，get_ttl.bat代码如下：</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off&amp;<span class="built_in">setlocal</span> enabledelayedexpansion</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> db=baidu_baike</span><br><span class="line"><span class="built_in">set</span> file=kg_demo_mapping_<span class="variable">%db%</span>.ttl</span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> generate-mapping -u root -p root -o <span class="variable">%file%</span> jdbc:mysql:///<span class="variable">%db%</span>?useSSL=false</span><br><span class="line"></span><br><span class="line">:: <span class="keyword">call</span> <span class="built_in">findstr</span> /i /v /C:&quot;@prefix vocab&quot; &quot;<span class="variable">%file%</span>&quot;&gt;&gt;<span class="variable">%file%</span>.bk</span><br><span class="line">:: <span class="built_in">move</span> /y <span class="variable">%file%</span>.bk <span class="variable">%file%</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> /f &quot;tokens=<span class="number">1</span>,* delims=:&quot; <span class="variable">%%b</span> <span class="keyword">in</span> (&#x27;<span class="built_in">findstr</span> /n &quot;.*&quot; &quot;<span class="variable">%file%</span>&quot;&#x27;)<span class="keyword">do</span> (</span><br><span class="line">	<span class="built_in">set</span> &quot;var=<span class="variable">%%c</span>&quot;</span><br><span class="line">	<span class="keyword">if</span> &quot;<span class="variable">!var!</span>&quot; <span class="keyword">neq</span> &quot;@prefix vocab: &lt;vocab/&gt; .&quot; (</span><br><span class="line">		<span class="keyword">if</span> &quot;<span class="variable">!var!</span>&quot; <span class="keyword">equ</span> &quot;&quot; (</span><br><span class="line">			&gt;&gt;<span class="variable">%file%</span>.bk <span class="built_in">echo</span>,<span class="variable">!var!</span>) ^</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> &quot;<span class="variable">!var!</span>&quot; <span class="keyword">equ</span> &quot;@prefix jdbc: &lt;http://d2rq.org/terms/jdbc/&gt; .&quot; (</span><br><span class="line">		  &gt;&gt;<span class="variable">%file%</span>.bk <span class="built_in">echo</span>,<span class="variable">!var!</span></span><br><span class="line">			&gt;&gt;<span class="variable">%file%</span>.bk <span class="built_in">echo</span>,@prefix : ^&lt;http://www.kgdemo.com#^&gt; .) ^</span><br><span class="line">		<span class="keyword">else</span> (</span><br><span class="line">			<span class="built_in">echo</span>;&quot;<span class="variable">!var!</span>&quot;|<span class="built_in">find</span> &quot;jdbcDSN&quot;&amp;&amp;(</span><br><span class="line">				&gt;&gt;<span class="variable">%file%</span>.bk <span class="built_in">echo</span>,  d2rq:jdbcDSN ^&quot;jdbc:mysql:///<span class="variable">%db%</span>?useUnicode=true^&amp;characterEncoding=utf8^&amp;useSSL=false^&quot;;)||(</span><br><span class="line">				<span class="built_in">set</span> &quot;var=!var:vocab= !&quot;</span><br><span class="line">	    	<span class="built_in">set</span> &quot;var=<span class="variable">!var:actor_actor=actor!</span>&quot;</span><br><span class="line">	    	&gt;&gt;<span class="variable">%file%</span>.bk <span class="built_in">echo</span>,<span class="variable">!var!</span>))</span><br><span class="line">	)</span><br><span class="line">)</span><br><span class="line"><span class="built_in">move</span> /y <span class="variable">%file%</span>.bk <span class="variable">%file%</span></span><br></pre></td></tr></table></figure>
<p>然后手动修改生成的文件</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># <span class="function">Table <span class="title">actor_to_movie</span> <span class="params">(n:m)</span></span></span><br><span class="line"><span class="function">map:actor_to_movie__link a d2rq:PropertyBridge;</span></span><br><span class="line">	d2rq:belongsToClassMap map:actor;  #改前为map:movie</span><br><span class="line">	d2rq:property  :hasActedIn;</span><br><span class="line">	d2rq:refersToClassMap map:movie;   #改前为map:actor</span><br></pre></td></tr></table></figure>

<p>根据默认生成的ttl文件被保存到百度云上，您可以下载后查阅，<a href="https://pan.baidu.com/s/18kd3ACjQpqMZ9x3FqIox-Q">百度百科mapping 文件</a>(提取码：m9n9)、<a href="https://pan.baidu.com/s/1N2k53PSmBNA8FFDXGwQCJQ">互动百科 mapping 文件</a>(提取码：jbyp)。</p>
<h3 id="2-运行dump-rdf工具，创建rdf的转存-命令将数据转换为Ntriples"><a href="#2-运行dump-rdf工具，创建rdf的转存-命令将数据转换为Ntriples" class="headerlink" title="2). 运行dump-rdf工具，创建rdf的转存,命令将数据转换为Ntriples"></a>2). 运行dump-rdf工具，创建rdf的转存,命令将数据转换为Ntriples</h3><p>在生成mapping文件后，您可以通过：<code>./dump-rdf -o baidu_baike.nt kg_demo_mapping_baidu_baike.ttl;</code> 命令将数据转换为Ntriples。</p>
<p>按照官方的介绍，运行以下命令生成rdf，在d2rq文件夹中查看生成的nt文件可以看到RDF结构。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PS C:\<span class="keyword">my</span>\d2rq&gt; ./<span class="keyword">dump</span>-rdf -o baidu_baike.nt kg_demo_mapping_baidu_baike.ttl</span><br></pre></td></tr></table></figure>

<h3 id="3-使用下面的命令启动D2R-Server"><a href="#3-使用下面的命令启动D2R-Server" class="headerlink" title="3). 使用下面的命令启动D2R Server"></a>3). 使用下面的命令启动D2R Server</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:\my\d2rq&gt; ./d2r-server kg_demo_mapping_baidu_baike.ttl</span><br><span class="line">17:10:16 INFO  JettyLauncher        :: [[[ Server started at http://localhost:2020/ ]]]</span><br></pre></td></tr></table></figure>

<h3 id="4-SPARQL查询"><a href="#4-SPARQL查询" class="headerlink" title="4). SPARQL查询"></a>4). SPARQL查询</h3><p>例如：“周星驰出演了哪些电影？”</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">SELECT</span> <span class="string">?n</span> <span class="variable constant_">WHERE</span> &#123;</span><br><span class="line">  <span class="string">?s</span> <span class="symbol">rdf:</span>type <span class="symbol">:Actor</span>.</span><br><span class="line">  <span class="string">?s</span> <span class="symbol">:actor_chName</span> <span class="string">&#x27;周星驰&#x27;</span>.</span><br><span class="line">  <span class="string">?o</span> <span class="symbol">:movie_chName</span> <span class="string">?n</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable constant_">LIMIT</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>结果为:</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">SPARQL resul<span class="symbol">ts:</span></span><br><span class="line"><span class="built_in">n</span></span><br><span class="line"><span class="string">&quot;七小福&quot;</span></span><br><span class="line"><span class="string">&quot;大众电影百花奖&quot;</span></span><br><span class="line"><span class="string">&quot;台湾电影金马奖&quot;</span></span><br><span class="line"><span class="string">&quot;香港电影金像奖&quot;</span></span><br><span class="line"><span class="string">&quot;香港电影导演会&quot;</span></span><br><span class="line"><span class="string">&quot;长江7号&quot;</span></span><br><span class="line"><span class="string">&quot;第28届香港电影金像奖&quot;</span></span><br><span class="line"><span class="string">&quot;跳出去&quot;</span></span><br><span class="line"><span class="string">&quot;少林少女&quot;</span></span><br><span class="line"><span class="string">&quot;西游：降魔篇&quot;</span></span><br></pre></td></tr></table></figure>

<p>就我们这个例子而言，可以不要“?s rdf:type :Actor”，这里只是让查询图更具体（在拥有复杂关系的RDF图中，可能会存在不同的类拥有相同的属性名。比如，猫和狗名字的属性名都是”name”，我们想查询一只叫汤姆的猫；如果不指定类型，返回结果可能也包含一只叫汤姆的狗）。图模式中，每个RDF用英文句号进行分割。</p>
<p>例如：“少林足球这部电影有哪些演员参演”：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">SELECT</span> <span class="string">?n</span> <span class="variable constant_">WHERE</span> &#123;</span><br><span class="line">  <span class="string">?s</span> <span class="symbol">rdf:</span>type <span class="symbol">:Movie</span>.</span><br><span class="line">  <span class="string">?s</span> <span class="symbol">:movie_chName</span> <span class="string">&#x27;少林足球&#x27;</span>.</span><br><span class="line">  <span class="string">?a</span> <span class="symbol">:hasActedIn</span> <span class="string">?s</span>.</span><br><span class="line">  <span class="string">?a</span> <span class="symbol">:actor_chName</span> <span class="string">?n</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果为:</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">n</span></span><br><span class="line"><span class="string">&quot;周星驰&quot;</span></span><br><span class="line"><span class="string">&quot;吴孟达&quot;</span></span><br></pre></td></tr></table></figure>

<p>文件存放在百度云盘中，<a href="https://pan.baidu.com/s/1v2ueiqLo4y68cBuxw752GQ">百度百科</a>(提取码：haqq)、<a href="https://pan.baidu.com/s/1NT3b4UnbmN8Xo-wvUgYkZw">互动百科</a>(提取码：cipw)。</p>
<h2 id="3-Apache-jena"><a href="#3-Apache-jena" class="headerlink" title="3. Apache jena"></a>3. Apache jena</h2><ul>
<li>NTriples to TDB</li>
</ul>
<p>TDB 是Jena用于存储RDF的组件，是属于存储层面的技术。在单机情况下，它能够提供非常高的RDF存储性能。在下载完apache-jena后，运行 .&#x2F;tdbloader –loc&#x3D;”..&#x2F;tdb&#x2F;” “path&#x2F;to&#x2F;NTriples” 把 NTriples 加载到TDB中。</p>
<ul>
<li>Apache jena fuseki 的运行</li>
</ul>
<p>在Apache Jena fuseki服务器的配置文件中，可以指定本体，从而实现推理机制。该本体文件是从顶向下定义的，采用protege软件编辑生成，格式为Turtle，放在struct_to_rdf&#x2F;kg_movie_tultle.owl。该配置文件中另一个需要修改的是TDB文件夹的路径，改成上面TDB 文件夹路径即可。</p>
<p>需要注意的是，每次运行fuseki服务器后，会在TDB文件夹内生成一些以prefix*开头的文件，重新运行fuseki服务的话不删除它们可能会报错。</p>
<ul>
<li>Apache jena SPARQL endpoint</li>
</ul>
<p>Jena fuseki开启服务后，可以通过网页端和命令行方式进行SPQRQL查询。接下来我们可以直接进行SPARQL查询，也可以把自然语言转换为 SPARQL 模板后进行查询。</p>
<h3 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h3><h4 id="1-将RDF数据转换以TDB的方式存储"><a href="#1-将RDF数据转换以TDB的方式存储" class="headerlink" title="1). 将RDF数据转换以TDB的方式存储"></a>1). 将RDF数据转换以TDB的方式存储</h4><p>运行命令：tdbloader –loc&#x3D;”..\tdb” “....\d2rq\baidu_baike.nt”</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PS</span> C:\my\apache-jena\bat&gt; ./tdbloader --loc=<span class="string">&quot;..\tdb&quot;</span> <span class="string">&quot;..\..\d2rq\baidu_baike.nt&quot;</span></span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">28</span> INFO  loader               :: -- Start triples data phase</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">28</span> INFO  loader               :: ** Load empty triples table</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">28</span> INFO  loader               :: -- Start quads data phase</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">28</span> INFO  loader               :: ** Load empty quads table</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">28</span> INFO  loader               :: Load: ..\..\d2rq\baidu_baike.nt -- <span class="number">2019</span>/<span class="number">09</span>/<span class="number">27</span> <span class="number">16</span>:<span class="number">03</span>:<span class="number">28</span> CST</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">30</span> INFO  loader               :: Add: <span class="number">50</span>,<span class="number">000</span> triples (Batch: <span class="number">31</span>,<span class="number">867</span> / Avg: <span class="number">31</span>,<span class="number">867</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">30</span> INFO  loader               :: Add: <span class="number">100</span>,<span class="number">000</span> triples (Batch: <span class="number">124</span>,<span class="number">688</span> / Avg: <span class="number">50</span>,<span class="number">761</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">31</span> INFO  loader               :: Add: <span class="number">150</span>,<span class="number">000</span> triples (Batch: <span class="number">147</span>,<span class="number">928</span> / Avg: <span class="number">64</span>,<span class="number">991</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">31</span> INFO  loader               :: Add: <span class="number">200</span>,<span class="number">000</span> triples (Batch: <span class="number">124</span>,<span class="number">378</span> / Avg: <span class="number">73</span>,<span class="number">800</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">31</span> INFO  loader               :: Add: <span class="number">250</span>,<span class="number">000</span> triples (Batch: <span class="number">128</span>,<span class="number">534</span> / Avg: <span class="number">80</span>,<span class="number">671</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">32</span> INFO  loader               :: Add: <span class="number">300</span>,<span class="number">000</span> triples (Batch: <span class="number">152</span>,<span class="number">905</span> / Avg: <span class="number">87</span>,<span class="number">565</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">32</span> INFO  loader               :: Add: <span class="number">350</span>,<span class="number">000</span> triples (Batch: <span class="number">131</span>,<span class="number">926</span> / Avg: <span class="number">91</span>,<span class="number">984</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">32</span> INFO  loader               :: Add: <span class="number">400</span>,<span class="number">000</span> triples (Batch: <span class="number">135</span>,<span class="number">501</span> / Avg: <span class="number">95</span>,<span class="number">831</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">33</span> INFO  loader               :: Add: <span class="number">450</span>,<span class="number">000</span> triples (Batch: <span class="number">154</span>,<span class="number">798</span> / Avg: <span class="number">100</span>,<span class="number">066</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">33</span> INFO  loader               :: Add: <span class="number">500</span>,<span class="number">000</span> triples (Batch: <span class="number">145</span>,<span class="number">348</span> / Avg: <span class="number">103</span>,<span class="number">284</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">33</span> INFO  loader               ::   Elapsed: <span class="number">4</span>.<span class="number">84</span> seconds<span class="meta"> [2019/09/27 16:03:33 CST]</span></span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">33</span> INFO  loader               :: Add: <span class="number">550</span>,<span class="number">000</span> triples (Batch: <span class="number">160</span>,<span class="number">256</span> / Avg: <span class="number">106</span>,<span class="number">733</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">34</span> INFO  loader               :: Add: <span class="number">600</span>,<span class="number">000</span> triples (Batch: <span class="number">145</span>,<span class="number">348</span> / Avg: <span class="number">109</span>,<span class="number">150</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">34</span> INFO  loader               :: Add: <span class="number">650</span>,<span class="number">000</span> triples (Batch: <span class="number">125</span>,<span class="number">628</span> / Avg: <span class="number">110</span>,<span class="number">262</span>)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">34</span> INFO  loader               :: -- Finish triples data phase</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">34</span> INFO  loader               :: ** Data: <span class="number">663</span>,<span class="number">080</span> triples loaded in <span class="number">6</span>.<span class="number">08</span> seconds<span class="meta"> [Rate: 109,059.21 per second]</span></span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">34</span> INFO  loader               :: -- Finish quads data phase</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">34</span> INFO  loader               :: -- Start triples index phase</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">35</span> INFO  loader               :: Index SPO-&gt;POS: <span class="number">100</span>,<span class="number">000</span> slots (Batch: <span class="number">418</span>,<span class="number">410</span> slots/s / Avg: <span class="number">418</span>,<span class="number">410</span> slots/s)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">35</span> INFO  loader               :: Index SPO-&gt;POS: <span class="number">200</span>,<span class="number">000</span> slots (Batch: <span class="number">662</span>,<span class="number">251</span> slots/s / Avg: <span class="number">512</span>,<span class="number">820</span> slots/s)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">35</span> INFO  loader               :: Index SPO-&gt;POS: <span class="number">300</span>,<span class="number">000</span> slots (Batch: <span class="number">598</span>,<span class="number">802</span> slots/s / Avg: <span class="number">538</span>,<span class="number">599</span> slots/s)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">35</span> INFO  loader               :: Index SPO-&gt;POS: <span class="number">400</span>,<span class="number">000</span> slots (Batch: <span class="number">588</span>,<span class="number">235</span> slots/s / Avg: <span class="number">550</span>,<span class="number">206</span> slots/s)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">35</span> INFO  loader               :: Index SPO-&gt;POS: <span class="number">500</span>,<span class="number">000</span> slots (Batch: <span class="number">581</span>,<span class="number">395</span> slots/s / Avg: <span class="number">556</span>,<span class="number">173</span> slots/s)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">35</span> INFO  loader               :: Index SPO-&gt;POS: <span class="number">600</span>,<span class="number">000</span> slots (Batch: <span class="number">598</span>,<span class="number">802</span> slots/s / Avg: <span class="number">562</span>,<span class="number">851</span> slots/s)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">36</span> INFO  loader               :: ** Index SPO-&gt;POS: <span class="number">663</span>,<span class="number">080</span> slots indexed in <span class="number">1</span>.<span class="number">19</span> seconds<span class="meta"> [Rate: 558,618.38 per second]</span></span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">36</span> INFO  loader               :: Index SPO-&gt;OSP: <span class="number">100</span>,<span class="number">000</span> slots (Batch: <span class="number">657</span>,<span class="number">894</span> slots/s / Avg: <span class="number">657</span>,<span class="number">894</span> slots/s)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">36</span> INFO  loader               :: Index SPO-&gt;OSP: <span class="number">200</span>,<span class="number">000</span> slots (Batch: <span class="number">694</span>,<span class="number">444</span> slots/s / Avg: <span class="number">675</span>,<span class="number">675</span> slots/s)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">36</span> INFO  loader               :: Index SPO-&gt;OSP: <span class="number">300</span>,<span class="number">000</span> slots (Batch: <span class="number">584</span>,<span class="number">795</span> slots/s / Avg: <span class="number">642</span>,<span class="number">398</span> slots/s)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">36</span> INFO  loader               :: Index SPO-&gt;OSP: <span class="number">400</span>,<span class="number">000</span> slots (Batch: <span class="number">561</span>,<span class="number">797</span> slots/s / Avg: <span class="number">620</span>,<span class="number">155</span> slots/s)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">36</span> INFO  loader               :: Index SPO-&gt;OSP: <span class="number">500</span>,<span class="number">000</span> slots (Batch: <span class="number">595</span>,<span class="number">238</span> slots/s / Avg: <span class="number">615</span>,<span class="number">006</span> slots/s)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">37</span> INFO  loader               :: Index SPO-&gt;OSP: <span class="number">600</span>,<span class="number">000</span> slots (Batch: <span class="number">546</span>,<span class="number">448</span> slots/s / Avg: <span class="number">602</span>,<span class="number">409</span> slots/s)</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">37</span> INFO  loader               :: ** Index SPO-&gt;OSP: <span class="number">663</span>,<span class="number">080</span> slots indexed in <span class="number">1</span>.<span class="number">11</span> seconds<span class="meta"> [Rate: 595,224.44 per second]</span></span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">37</span> INFO  loader               :: -- Finish triples index phase</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">37</span> INFO  loader               :: ** <span class="number">663</span>,<span class="number">080</span> triples indexed in <span class="number">2</span>.<span class="number">31</span> seconds<span class="meta"> [Rate: 287,171.94 per second]</span></span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">37</span> INFO  loader               :: -- Finish triples load</span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">37</span> INFO  loader               :: ** Completed: <span class="number">663</span>,<span class="number">080</span> triples loaded in <span class="number">8</span>.<span class="number">41</span> seconds<span class="meta"> [Rate: 78,844.23 per second]</span></span><br><span class="line"><span class="attribute">16</span>:<span class="number">03</span>:<span class="number">37</span> INFO  loader               :: -- Finish quads load</span><br></pre></td></tr></table></figure>
<p><em>注意：“–loc”指定tdb存储的位置；第二个参数是由Mysql数据转换得到的RDF数据。</em></p>
<h4 id="2-通过Fuseki进行开启服务"><a href="#2-通过Fuseki进行开启服务" class="headerlink" title="2). 通过Fuseki进行开启服务"></a>2). 通过Fuseki进行开启服务</h4><p>进入fuseki目录下，运行命令：fuseki-server –loc&#x3D;..\apache-jena\tdb &#x2F;kg_movie</p>
<p><em>注意：–loc的参数是上一步TDB数据库的路径,kg_movie是显示的数据库名。</em></p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PS C:\my\apache-jena-fuseki&gt; ./fuseki-server --loc=..\apache-jena\tdb /kg_movie</span><br><span class="line">[2019<span class="string">-09</span><span class="string">-25</span> 16:35:32] Server     INFO  Running in read-only mode for /kg_movie</span><br><span class="line">[2019<span class="string">-09</span><span class="string">-25</span> 16:35:32] Server     INFO  Apache Jena Fuseki 3.12.0</span><br><span class="line">[2019<span class="string">-09</span><span class="string">-25</span> 16:35:32] Config     INFO  FUSEKI_HOME=C:\my\apache-jena-fuseki\.</span><br><span class="line">[2019<span class="string">-09</span><span class="string">-25</span> 16:35:32] Config     INFO  FUSEKI_BASE=C:\my\apache-jena-fuseki\run</span><br><span class="line">[2019<span class="string">-09</span><span class="string">-25</span> 16:35:32] Config     INFO  Shiro file: file://C:\my\apache-jena-fuseki\run\shiro.ini</span><br><span class="line">[2019<span class="string">-09</span><span class="string">-25</span> 16:35:32] Config     INFO  Template file: templates/config-tdb-dir</span><br><span class="line">[2019<span class="string">-09</span><span class="string">-25</span> 16:35:32] Config     INFO  TDB dataset: directory=..\apache-jena\tdb</span><br><span class="line">[2019<span class="string">-09</span><span class="string">-25</span> 16:35:33] Config     INFO  Register: /kg_movie</span><br><span class="line">[2019<span class="string">-09</span><span class="string">-25</span> 16:35:33] Server     INFO  Started 2019/09/25 16:35:33 CST on port 3030</span><br></pre></td></tr></table></figure>
<p>启动后，Fuseki网站地址： <a href="http://localhost:3030/">http://localhost:3030/</a> </p>
<p>测试查询,可以通过网页端和命令行方式进行SPQRQL查询</p>
<p>如：过滤出变量包含“长江7号”的实体</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">SELECT</span> <span class="string">?s</span>ubject <span class="string">?p</span>redicate <span class="string">?o</span>bject</span><br><span class="line"><span class="variable constant_">WHERE</span> &#123;</span><br><span class="line">  <span class="string">?s</span>ubject <span class="string">?p</span>redicate <span class="string">?o</span>bject</span><br><span class="line">  <span class="variable constant_">FILTER</span> regex(<span class="string">?o</span>bject, <span class="string">&quot;长江7号&quot;</span>) </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable constant_">LIMIT</span> <span class="number">25</span></span><br></pre></td></tr></table></figure>
<p>返回结果：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">	subject	predicate	object</span><br><span class="line"><span class="number">1</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/6&gt;</span></span><br><span class="line">&lt;http:<span class="regexp">//</span>www.kgdemo.com<span class="comment">#movie_chName&gt;</span></span><br><span class="line"><span class="string">&quot;长江7号&quot;</span></span><br><span class="line"><span class="number">2</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/6&gt;</span></span><br><span class="line">&lt;http:<span class="regexp">//</span>www.kgdemo.com<span class="comment">#movie_bio&gt;</span></span><br><span class="line"><span class="string">&quot; 《长江7号》是由周星驰执导，周星驰、徐娇、张雨绮、林子聪主演的科幻喜剧电影。该片于2008年1月30日在中国上映。影片讲述一名父亲将意外拾获的外星玩具狗当做礼物送给儿子，从而让父子两人的生活发生变化的故事。 [1]  &quot;</span></span><br><span class="line"><span class="number">3</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/10221&gt;</span></span><br><span class="line">&lt;http:<span class="regexp">//</span>www.kgdemo.com<span class="comment">#movie_chName&gt;</span></span><br><span class="line"><span class="string">&quot;长江7号爱地球&quot;</span></span><br><span class="line"><span class="number">4</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/10221&gt;</span></span><br><span class="line">&lt;http:<span class="regexp">//</span>www.kgdemo.com<span class="comment">#movie_bio&gt;</span></span><br><span class="line"><span class="string">&quot; 《长江7号爱地球》是由袁建滔执导的动画电影，石班瑜、徐娇、董洁等联合配音。该片于2010年7月9日在中国内地上映。该片讲述了狄爸以在建筑工地打散工养家，在垃圾堆意外捡到神秘外星生物7仔的故事。 [1]  &quot;</span></span><br><span class="line"><span class="number">5</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#actor/1&gt;</span></span><br><span class="line">&lt;http:<span class="regexp">//</span>www.kgdemo.com<span class="comment">#actor_bio&gt;</span></span><br><span class="line"><span class="string">&quot; 周星驰，1962年6月22日生于香港，祖籍浙江宁波，中国香港演员、导演、编剧、制作人、商人，毕业于无线电视艺员训练班。1980年成为丽的电视台的特约演员，从而进入演艺圈。1981年出演个人首部电视剧《IQ成熟时》。1988年将演艺事业的重心转向大银幕，并于同年出演电影处女作《捕风汉子》。1990年凭借喜剧片《一本漫画闯天涯》确立其无厘头的表演风格 [1]  ；同年，因其主演的喜剧动作片《赌圣》打破香港地区票房纪录而获得关注 [2]  。1991年主演喜剧片《逃学威龙》，并再次打破香港地区票房纪录 [3]  。1995年凭借喜剧爱情片《大话西游》奠定其在华语影坛的地位。1999年自导自演的喜剧片《喜剧之王》获得香港电影年度票房冠军 [4]  。2002年凭借喜剧片《少林足球》获得第21届香港电影金像奖最佳男主角奖以及最佳导演奖 [5]  。2003年成为美国《时代周刊》封面人物 [6]  。2005年凭借喜剧动作片《功夫》获得第42届台湾电影金马奖最佳导演奖 [7]  。2008年自导自演的科幻喜剧片《长江7号》获得香港电影年度票房冠军 [8]  。2013年执导古装喜剧片《西游·降魔篇》，该片以2.18亿美元的票房成绩打破华语电影在全球的票房纪录 [9-10]  。2016年担任科幻喜剧片《美人鱼》的导演、编剧、制作人，该片以超过33亿元的票房创下中国内地电影票房纪录 [11-14]  。2017年1月28日，担任监制、编剧的古装喜剧片《西游伏妖篇》上映 [15]  。2018年执导《美人鱼2》 [16]  。演艺事业外，周星驰还涉足商界。1989年成立星炜有限公司 [17]  。1996年成立星辉公司 [18]  。2010年出任比高集团有限公司执行董事 [19]  。 &quot;</span></span><br><span class="line"><span class="number">6</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/10218&gt;</span></span><br><span class="line">&lt;http:<span class="regexp">//</span>www.kgdemo.com<span class="comment">#movie_bio&gt;</span></span><br><span class="line"><span class="string">&quot; 曾谨昌是香港资深编剧家。他于1981年加入电视广播有限公司(TVB)，编写过多部脍炙人口的电视剧，作品有《白蛇传说》、《长江7号爱地球》等。 &quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="3-实现OWL推理"><a href="#3-实现OWL推理" class="headerlink" title="3). 实现OWL推理"></a>3). 实现OWL推理</h4><p>上一步运行完退出。程序会为我们在当前目录自动创建“run”文件夹实现。将我们的本体文件“kg_movie_tultle.owl”移动到“run”文件夹下的“databases”文件夹中，并将“owl”后缀名改为“ttl”。在“run”文件夹下的“configuration”中，我们创建名为“fuseki_conf.ttl”的文本文件（取名没有要求），加入如下内容：</p>
<ol>
<li>TDB</li>
</ol>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@prefix :</span>       &lt;#&gt; .</span><br><span class="line"><span class="variable">@prefix</span> <span class="attribute">fuseki</span>: &lt;<span class="attribute">http</span>:<span class="comment">//jena.apache.org/fuseki#&gt; .</span></span><br><span class="line"><span class="variable">@prefix</span> <span class="attribute">rdf</span>: 		&lt;<span class="attribute">http</span>:<span class="comment">//www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .</span></span><br><span class="line"><span class="variable">@prefix</span> <span class="attribute">rdfs</span>: 	&lt;<span class="attribute">http</span>:<span class="comment">//www.w3.org/2000/01/rdf-schema#&gt; .</span></span><br><span class="line"><span class="variable">@prefix</span> <span class="attribute">tdb</span>: 		&lt;<span class="attribute">http</span>:<span class="comment">//jena.hpl.hp.com/2008/tdb#&gt; .</span></span><br><span class="line"><span class="variable">@prefix</span> <span class="attribute">ja</span>: 		&lt;<span class="attribute">http</span>:<span class="comment">//jena.hpl.hp.com/2005/11/Assembler#&gt; .</span></span><br><span class="line"></span><br><span class="line">[] <span class="attribute">rdf</span>:type <span class="attribute">fuseki</span>:Server ;</span><br><span class="line"> fuseki:services (</span><br><span class="line"> &lt;#service1&gt;</span><br><span class="line"> ) .</span><br><span class="line"></span><br><span class="line">## ---------------------------------------------------------------</span><br><span class="line">## Service with only SPARQL query on an inference model.</span><br><span class="line">## Inference model base data in TDB.</span><br><span class="line"></span><br><span class="line">&lt;#service1&gt; rdf:type fuseki:Service ;</span><br><span class="line">    fuseki:name         &quot;kg_movie&quot; ;</span><br><span class="line">    fuseki:endpoint [ fuseki:operation fuseki:query;  fuseki:name &quot;sparql&quot;  ] ;</span><br><span class="line">    fuseki:endpoint [ fuseki:operation fuseki:query;  fuseki:name &quot;query&quot;   ] ;</span><br><span class="line">    fuseki:endpoint [ fuseki:operation fuseki:update; fuseki:name &quot;update&quot;  ] ;</span><br><span class="line">    fuseki:endpoint [ fuseki:operation fuseki:upload; fuseki:name &quot;upload&quot;  ] ;</span><br><span class="line">    fuseki:endpoint [ fuseki:operation fuseki:gsp_r;  fuseki:name &quot;get&quot;     ] ;</span><br><span class="line">    fuseki:endpoint [ fuseki:operation fuseki:gsp_rw; fuseki:name &quot;data&quot;    ] ;</span><br><span class="line">    fuseki:dataset  &lt;#dataset&gt; .</span><br><span class="line"></span><br><span class="line">&lt;#dataset&gt; rdf:type tdb:DatasetTDB ;</span><br><span class="line">    ja:context [ ja:cxtName &quot;arq:queryTimeout&quot; ;  ja:cxtValue &quot;10000,30000&quot; ] ;</span><br><span class="line">    tdb:location &quot;../apache-jena/tdb&quot; .</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在内存，同步加载本体和三元组</li>
</ol>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">@prefix :       &lt;<span class="comment">#&gt; .</span></span><br><span class="line">@prefix fuseki: &lt;http:<span class="regexp">//</span>jena.apache.org/fuseki<span class="comment">#&gt; .</span></span><br><span class="line">@prefix rdf: 		&lt;http:<span class="regexp">//</span>www.w3.org<span class="regexp">/1999/</span><span class="number">02</span>/<span class="number">22</span>-rdf-syntax-ns<span class="comment">#&gt; .</span></span><br><span class="line">@prefix rdfs: 	&lt;http:<span class="regexp">//</span>www.w3.org<span class="regexp">/2000/</span><span class="number">01</span>/rdf-schema<span class="comment">#&gt; .</span></span><br><span class="line">@prefix tdb: 		&lt;http:<span class="regexp">//</span>jena.hpl.hp.com<span class="regexp">/2008/</span>tdb<span class="comment">#&gt; .</span></span><br><span class="line">@prefix ja: 		&lt;http:<span class="regexp">//</span>jena.hpl.hp.com<span class="regexp">/2005/</span><span class="number">11</span>/Assembler<span class="comment">#&gt; .</span></span><br><span class="line"></span><br><span class="line">[] rdf:type fuseki:Server ;</span><br><span class="line"> fuseki:services (</span><br><span class="line"> &lt;<span class="comment">#service1&gt;</span></span><br><span class="line"> ) .</span><br><span class="line"></span><br><span class="line"><span class="comment">## ---------------------------------------------------------------</span></span><br><span class="line"><span class="comment">## Service with only SPARQL query on an inference model.</span></span><br><span class="line"><span class="comment">## Inference model base data in TDB.</span></span><br><span class="line"></span><br><span class="line">&lt;<span class="comment">#service1&gt; rdf:type fuseki:Service ;</span></span><br><span class="line">    fuseki:name         <span class="string">&quot;kg_movie&quot;</span> ;</span><br><span class="line">    fuseki:endpoint [ fuseki:operation fuseki:query;  fuseki:name <span class="string">&quot;sparql&quot;</span>  ] ;</span><br><span class="line">    fuseki:endpoint [ fuseki:operation fuseki:query;  fuseki:name <span class="string">&quot;query&quot;</span>   ] ;</span><br><span class="line">    fuseki:endpoint [ fuseki:operation fuseki:update; fuseki:name <span class="string">&quot;update&quot;</span>  ] ;</span><br><span class="line">    fuseki:endpoint [ fuseki:operation fuseki:upload; fuseki:name <span class="string">&quot;upload&quot;</span>  ] ;</span><br><span class="line">    fuseki:endpoint [ fuseki:operation fuseki:gsp_r;  fuseki:name <span class="string">&quot;get&quot;</span>     ] ;</span><br><span class="line">    fuseki:endpoint [ fuseki:operation fuseki:gsp_rw; fuseki:name <span class="string">&quot;data&quot;</span>    ] ;</span><br><span class="line">    fuseki:dataset  &lt;<span class="comment">#dataset&gt; .</span></span><br><span class="line"></span><br><span class="line">&lt;<span class="comment">#dataset&gt; rdf:type ja:RDFDataset ;</span></span><br><span class="line">	ja:defaultGraph</span><br><span class="line">      [ a ja:MemoryModel ;</span><br><span class="line">        ja:content [ja:externalContent &lt;file:..<span class="regexp">/databases/</span>kg_movie_tultle.ttl&gt; ] ;</span><br><span class="line">        ja:content [ja:externalContent &lt;file:..<span class="regexp">/../</span>..<span class="regexp">/d2rq/</span>baidu_baike.nt&gt; ] ;</span><br><span class="line">      ] ;</span><br><span class="line">    .</span><br></pre></td></tr></table></figure>

<p>再次运行“fuseki-server.bat”，如果出现如下界面表示运行成功：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PS C:\my\apache-jena-fuseki&gt; ./fuseki-<span class="keyword">server</span></span><br><span class="line">[<span class="number">2019</span><span class="number">-09</span><span class="number">-26</span> <span class="number">10</span>:<span class="number">48</span>:<span class="number">42</span>] <span class="keyword">Server</span>     <span class="keyword">INFO</span>  Apache Jena Fuseki <span class="number">3.12</span><span class="number">.0</span></span><br><span class="line">[<span class="number">2019</span><span class="number">-09</span><span class="number">-26</span> <span class="number">10</span>:<span class="number">48</span>:<span class="number">42</span>] Config     <span class="keyword">INFO</span>  FUSEKI_HOME=C:\my\apache-jena-fuseki\.</span><br><span class="line">[<span class="number">2019</span><span class="number">-09</span><span class="number">-26</span> <span class="number">10</span>:<span class="number">48</span>:<span class="number">42</span>] Config     <span class="keyword">INFO</span>  FUSEKI_BASE=C:\my\apache-jena-fuseki\run</span><br><span class="line">[<span class="number">2019</span><span class="number">-09</span><span class="number">-26</span> <span class="number">10</span>:<span class="number">48</span>:<span class="number">42</span>] Config     <span class="keyword">INFO</span>  Shiro file: file://C:\my\apache-jena-fuseki\run\shiro.ini</span><br><span class="line">[<span class="number">2019</span><span class="number">-09</span><span class="number">-26</span> <span class="number">10</span>:<span class="number">48</span>:<span class="number">42</span>] Config     <span class="keyword">INFO</span>  <span class="keyword">Configuration</span> file: C:\my\apache-jena-fuseki\run\config.ttl</span><br><span class="line">[<span class="number">2019</span><span class="number">-09</span><span class="number">-26</span> <span class="number">10</span>:<span class="number">48</span>:<span class="number">42</span>] riot       WARN  [<span class="type">line</span>: <span class="number">5</span>, col: <span class="number">9</span> ] Bad IRI: &lt;C:\my\apache-jena-fuseki\run\config.ttl#&gt; Code: <span class="number">4</span>/UNWISE_CHARACTER <span class="keyword">in</span> <span class="type">PATH</span>: The <span class="type">character</span> matches <span class="keyword">no</span> grammar rules <span class="keyword">of</span> URIs/IRIs. These characters are permitted <span class="keyword">in</span> RDF URI <span class="keyword">References</span>, <span class="type">XML</span> <span class="keyword">system</span> identifiers, <span class="keyword">and</span> <span class="type">XML</span> <span class="keyword">Schema</span> anyURIs.</span><br><span class="line">[<span class="number">2019</span><span class="number">-09</span><span class="number">-26</span> <span class="number">10</span>:<span class="number">48</span>:<span class="number">43</span>] Config     <span class="keyword">INFO</span>  <span class="keyword">Load</span> <span class="keyword">configuration</span>: file:///C:/my/apache-jena-fuseki/run/<span class="keyword">configuration</span>/fuseki_conf.ttl</span><br><span class="line">[<span class="number">2019</span><span class="number">-09</span><span class="number">-26</span> <span class="number">10</span>:<span class="number">48</span>:<span class="number">43</span>] Config     <span class="keyword">INFO</span>  Register: /kg_movie</span><br><span class="line">[<span class="number">2019</span><span class="number">-09</span><span class="number">-26</span> <span class="number">10</span>:<span class="number">48</span>:<span class="number">43</span>] <span class="keyword">Server</span>     <span class="keyword">INFO</span>  Started <span class="number">2019</span>/<span class="number">09</span>/<span class="number">26</span> <span class="number">10</span>:<span class="number">48</span>:<span class="number">43</span> CST <span class="keyword">on</span> port <span class="number">3030</span></span><br></pre></td></tr></table></figure>

<p><strong>需要注意的是，每次运行fuseki服务器后，会在TDB文件夹内生成一些以prefix*开头的文件，重新运行fuseki服务的话不删除它们可能会报错。</strong></p>
<p>测试查询,可以通过网页端和命令行方式进行SPQRQL查询，经过实践，发现丧失推理能力。</p>
<p>如：查询电影鹿鼎记的所有属性</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PREFIX : &lt;http:<span class="regexp">//</span>www.kgdemo.com<span class="comment">#&gt;</span></span><br><span class="line">PREFIX rdf: &lt;http:<span class="regexp">//</span>www.w3.org<span class="regexp">/1999/</span><span class="number">02</span>/<span class="number">22</span>-rdf-syntax-ns<span class="comment">#&gt;</span></span><br><span class="line">PREFIX rdfs: &lt;http:<span class="regexp">//</span>www.w3.org<span class="regexp">/2000/</span><span class="number">01</span>/rdf-schema<span class="comment">#&gt;</span></span><br><span class="line"></span><br><span class="line">SELECT * WHERE &#123;</span><br><span class="line">?x :movie_chName <span class="string">&#x27;鹿鼎记&#x27;</span>.</span><br><span class="line">?x ?p ?o.</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回的结果：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">x	p	o</span><br><span class="line"><span class="number">1</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">rdfs:label</span><br><span class="line"><span class="string">&quot;movie #35&quot;</span></span><br><span class="line"><span class="number">2</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">rdf:type</span><br><span class="line">:Movie</span><br><span class="line"><span class="number">3</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_language</span><br><span class="line"><span class="string">&quot;粤语&quot;</span></span><br><span class="line"><span class="number">4</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_screenwriter</span><br><span class="line"><span class="string">&quot;王晶&quot;</span></span><br><span class="line"><span class="number">5</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_rekeaseTime</span><br><span class="line"><span class="string">&quot;1992年07月30日&quot;</span></span><br><span class="line"><span class="number">6</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_prodTime</span><br><span class="line"><span class="string">&quot;None&quot;</span></span><br><span class="line"><span class="number">7</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_id</span><br><span class="line"><span class="string">&quot;35&quot;</span>^^xsd:integer</span><br><span class="line"><span class="number">8</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_foreName</span><br><span class="line"><span class="string">&quot;Royal Tramp&quot;</span></span><br><span class="line"><span class="number">9</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_genre</span><br><span class="line"><span class="string">&quot;动作&quot;</span></span><br><span class="line"><span class="number">10</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_star</span><br><span class="line"><span class="string">&quot;周星驰，温兆伦，邱淑贞，张敏，吴孟达，徐锦江&quot;</span></span><br><span class="line"><span class="number">11</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_achiem</span><br><span class="line"><span class="string">&quot;None&quot;</span></span><br><span class="line"><span class="number">12</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_chName</span><br><span class="line"><span class="string">&quot;鹿鼎记&quot;</span></span><br><span class="line"><span class="number">13</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_director</span><br><span class="line"><span class="string">&quot;王晶&quot;</span></span><br><span class="line"><span class="number">14</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_prodCompany</span><br><span class="line"><span class="string">&quot;香港永盛电影公司&quot;</span></span><br><span class="line"><span class="number">15</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_bio</span><br><span class="line"><span class="string">&quot; 《鹿鼎记》是改编自金庸小说的一部武侠喜剧。影片由王晶执导，周星驰、吴孟达、温兆伦、林青霞 、 李嘉欣、袁洁莹、邱淑贞、陈德容等联合出演。影片讲述清朝初期，康熙皇帝年少，奸臣鳌拜从中控制政权。韦小宝有幸加入推翻清朝的民间组织“天地会”，被派到王宫当卧底，偷取藏有清朝秘密的四十二章经。韦小宝很快成为皇上的心腹，做了大官。他既要执行任务却又跟皇帝成为了好朋友，陷入了两难的状态。 [1]  该片于1992年7月30日上映。 &quot;</span></span><br><span class="line"><span class="number">16</span>	</span><br><span class="line">&lt;file:<span class="regexp">//</span><span class="regexp">/C:/my</span><span class="regexp">/d2rq/</span>baidu_baike.nt<span class="comment">#movie/35&gt;</span></span><br><span class="line">:movie_length</span><br><span class="line"><span class="string">&quot;106 分钟&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-本体建模"><a href="#4-本体建模" class="headerlink" title="4. 本体建模"></a>4. 本体建模</h2><p>为了能够让Jena在我们的本体上进行推理，需要提供自定义的本体文件。本项目的本体通过protege 生成，详细流程请查看SimmerChan的专栏<a href="https://zhuanlan.zhihu.com/p/32552993">实践篇（一）：数据准备和本体建模</a>。根据上述流程生成的针对本项目的本体文件为struct_to_rdf&#x2F;movie_actor&#x2F;kg_movie_tultle.owl。</p>

    </div>
    
    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="/" target="_blank">Ljjyy.com</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/archives/2019/10/100593.html" class="pre-post btn btn-default" title='从零开始学习知识图谱 之 三.电影知识图谱构建 3.基于REfO的简单知识问答'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">从零开始学习知识图谱 之 三.电影知识图谱构建 3.基于REfO的简单知识问答</span>
        </a>
    
    
        <a href="/archives/2019/10/100591.html" class="next-post btn btn-default" title='从零开始学习知识图谱 之 一.电影知识图谱构建 1.半结构化数据的获取'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">从零开始学习知识图谱 之 一.电影知识图谱构建 1.半结构化数据的获取</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
    <div id="vcomments" class="valine"></div>
    
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>


    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: '5MzTXYXkt03k101j0PmSDN34-gzGzoHsz',
            appKey: 'iwjYgwno6qj3wtDVVSbe8nYQ',
            placeholder: '说点什么吧',
            notify: false,
            verify: true,
            avatar: 'mm',
            meta: 'nick,mail'.split(','),
            pageSize: '10',
            path: window.location.pathname,
            lang: 'zh-CN'.toLowerCase()
        })
    </script>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80-%E7%AE%80%E4%BB%8B"><span class="toc-text">一. 简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-text">二. 环境准备</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"><span class="toc-text">1. 操作系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-jdk"><span class="toc-text">2. jdk</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Protege"><span class="toc-text">3. Protege</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-d2rq"><span class="toc-text">4. d2rq</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Apache-jena"><span class="toc-text">5. Apache jena</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89-%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA"><span class="toc-text">三. 项目构建</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Direct-mapping"><span class="toc-text">1. Direct mapping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-D2RQ"><span class="toc-text">2. D2RQ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%BF%90%E8%A1%8C%E4%BB%A5%E4%B8%8B%E5%91%BD%E4%BB%A4%EF%BC%8C%E5%88%9B%E5%BB%BAmappling%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6%E3%80%82"><span class="toc-text">1). 运行以下命令，创建mappling映射文件。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%BF%90%E8%A1%8Cdump-rdf%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%88%9B%E5%BB%BArdf%E7%9A%84%E8%BD%AC%E5%AD%98-%E5%91%BD%E4%BB%A4%E5%B0%86%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2%E4%B8%BANtriples"><span class="toc-text">2). 运行dump-rdf工具，创建rdf的转存,命令将数据转换为Ntriples</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%BD%BF%E7%94%A8%E4%B8%8B%E9%9D%A2%E7%9A%84%E5%91%BD%E4%BB%A4%E5%90%AF%E5%8A%A8D2R-Server"><span class="toc-text">3). 使用下面的命令启动D2R Server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-SPARQL%E6%9F%A5%E8%AF%A2"><span class="toc-text">4). SPARQL查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Apache-jena"><span class="toc-text">3. Apache jena</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4"><span class="toc-text">操作步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B0%86RDF%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2%E4%BB%A5TDB%E7%9A%84%E6%96%B9%E5%BC%8F%E5%AD%98%E5%82%A8"><span class="toc-text">1). 将RDF数据转换以TDB的方式存储</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%80%9A%E8%BF%87Fuseki%E8%BF%9B%E8%A1%8C%E5%BC%80%E5%90%AF%E6%9C%8D%E5%8A%A1"><span class="toc-text">2). 通过Fuseki进行开启服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AE%9E%E7%8E%B0OWL%E6%8E%A8%E7%90%86"><span class="toc-text">3). 实现OWL推理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%9C%AC%E4%BD%93%E5%BB%BA%E6%A8%A1"><span class="toc-text">4. 本体建模</span></a></li></ol></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2019-2025&emsp;<a href="/" class="copyright-links" target="_blank" rel="nofollow">Ljjyy.com</a>
                </span> |
                <span>
                    <a href="/about/" class="copyright-links" target="_blank" rel="nofollow">关于我们</a>
                </span> |                
                <span>
                    <a href="/sitemap.xml" class="copyright-links" target="_blank" rel="nofollow">网站地图</a>
                </span> |
                <span>
                    <a href="/archives/" class="copyright-links" target="_blank" rel="nofollow">时间轴</a>
                </span>              
            </div>
        </div>
    </div>
</div>








<script src="/js/app.js?rev=@@hash.js"></script>


</body>
</html>