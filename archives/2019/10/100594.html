<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.2.3">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="https://www.ljjyy.com">
    <!--SEO-->

    <meta name="keywords" content="elasticsearch,知识图谱">


    <meta name="description" content="一. 简介 本次我们基于浙江大学在openKG上提供的基于elasticsearch的KBQA实现及示例，我们将其精简并将应用到自己的知识图谱上。 
ElasticSearch是一个基于Luce...">



<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">

    <!--Title-->


<title>从零开始学习知识图谱 之 四.电影知识图谱构建 4.基于ElasticSearch的简单语义搜索 | 来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</title>


    <link rel="alternate" href="/atom.xml" title="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
	<div class="hide">
        <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
        <script>LA.init({id: "JgbNOaw1xxsmUUsQ",ck: "JgbNOaw1xxsmUUsQ"})</script>
	</div>






    
    <meta name="baidu-site-verification" content="dTHILoORpx">


    <script>
        (function(){
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  >
    <div class="main-header-box">
        <!--a class="header-avatar" href="/" title='Ljjyy.com'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a-->
        <div class="branding">
            
                <h2> 多读书多实践，勤思考善领悟 </h2>
            
    	  </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">

        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="web-logo"  href="/" title='Ljjyy.com'></a>
                    <!--a class="navbar-brand" href="https://www.ljjyy.com">来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</a-->
                </div>
                <div class="collapse navbar-collapse" id="main-menu" style="">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/cloud/"><i class="fa "></i>云计算</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/front/"><i class="fa "></i>前端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/back/"><i class="fa "></i>后端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/devops/"><i class="fa "></i>运维</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/crack/"><i class="fa "></i>破解</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/penetration/"><i class="fa "></i>渗透</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/tool/"><i class="fa "></i>工具</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/other/"><i class="fa "></i>其他</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="从零开始学习知识图谱 之 四.电影知识图谱构建 4.基于ElasticSearch的简单语义搜索">
            
	            从零开始学习知识图谱 之 四.电影知识图谱构建 4.基于ElasticSearch的简单语义搜索
            
        </h1>
        <div class="post-meta">
    
        <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
            <a class="category-link" href="/categories/cloud/">云计算</a>
        </span>
    

    
        <span class="fa-wrap">
            <i class="fa fa-tags"></i>
            <span class="tags-meta">
                
                    <a class="tag-link" href="/tags/elasticsearch/">elasticsearch</a> <a class="tag-link" href="/tags/knowledgegraph/">知识图谱</a>
                
            </span>
        </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2019/10/17</span>
        </span>
        
    
</div>
            
            
            <p class="fa fa-exclamation-triangle warning">
                本文于<strong>1733</strong>天之前发表，文中内容可能已经过时。
            </p>
        
    </div>
    
    <div class="post-body post-content">
        <h1 id="一-简介"><a href="#一-简介" class="headerlink" title="一. 简介"></a>一. 简介</h1><p> <em>本次我们基于浙江大学在openKG上提供的</em><a href="http://openkg.cn/tool/elasticsearch-kbqa" target="_blank" rel="noopener">基于elasticsearch的KBQA实现及示例</a><em>，我们将其精简并将应用到自己的知识图谱上。</em> </p>
<p>ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。我们将通过提供的接口进行查询，例如查询朱一龙的相关信息，可以通过下列命令进行查询：</p>
<figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -<span class="type">XGET</span> <span class="symbol">'localhost</span>:<span class="number">9200</span>/demo/baidu_baike/_search?&amp;pretty' -<span class="type">H</span> <span class="symbol">'Content</span>-<span class="type">Type</span>:application/json' -d' &#123; <span class="string">"query"</span>:&#123; <span class="string">"bool"</span>:&#123; <span class="string">"filter"</span>:&#123; <span class="string">"term"</span>:&#123;<span class="string">"subj"</span>:<span class="string">"朱一龙"</span>&#125; &#125; &#125; &#125; &#125; <span class="string">'</span></span><br></pre></td></tr></table></figure>
<p>我们的目的就是在数据导入elasticsearch后，通过将输入的自然语言分解来构建这样的查询模板，从而实现搜索功能。</p>
<p>本教程的项目代码放在github上，下载地址为<a href="https://github.com/myhhub/zero_knowledge_graph" target="_blank" rel="noopener">《从零开始学习知识图谱》项目源代码</a> 。</p>
<h1 id="二-环境准备"><a href="#二-环境准备" class="headerlink" title="二. 环境准备"></a>二. 环境准备</h1><h2 id="1-操作系统"><a href="#1-操作系统" class="headerlink" title="1. 操作系统"></a>1. 操作系统</h2><p>支持操作系统：windows、macOS、Linux。为了方便大家搭建开发环境，笔者尽可能在windows下构建，系列篇未特意说明时操作系统都是<strong>windows</strong>。Linux安装可以参考<a href="100590.html">VirtualBox虚拟机安装Ubuntu</a>或<a href="100589.html">VirtualBox虚拟机安装CentOS8</a>进行安装。</p>
<h2 id="2-jdk"><a href="#2-jdk" class="headerlink" title="2. jdk"></a>2. jdk</h2><p>安装参见<a href="100604.html">windows系统安装JDK</a></p>
<h2 id="3-Python3"><a href="#3-Python3" class="headerlink" title="3. Python3"></a>3. Python3</h2><p>安装参见<a href="100591.html#4-Python3">从零开始学习知识图谱 之 一</a></p>
<h2 id="4-ElasticSearch"><a href="#4-ElasticSearch" class="headerlink" title="4. ElasticSearch"></a>4. ElasticSearch</h2><p>ElasticSearch是一个基于<a href="https://baike.baidu.com/item/Lucene/6753302" target="_blank" rel="noopener">Lucene</a>的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java语言开发的，并作为Apache许可条款下的开放源码发布，是一种流行的企业级搜索引擎。ElasticSearch用于<a href="https://baike.baidu.com/item/云计算/9969353" target="_blank" rel="noopener">云计算</a>中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。根据DB-Engines的排名显示，Elasticsearch是最受欢迎的企业搜索引擎，其次是Apache Solr，也是基于Lucene。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p><a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener">elasticsearch 官网</a>下载安装包，软件不需要安装，需要配置相应的Java环境。详细使用可阅读<a href="https://protegewiki.stanford.edu/wiki/Main_Page" target="_blank" rel="noopener">官方教程</a>。</p>
<p>运行 <code>./bin/elasticsearch.bat</code>即可开启服务。</p>
<p>在开启服务后，您可以通过 <code>curl &#39;http://localhost:9200&#39;</code>来访问 elasticsearch。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span> : <span class="string">"DESKTOP-3AFDEBF"</span>,</span><br><span class="line">  <span class="attr">"cluster_name"</span> : <span class="string">"elasticsearch"</span>,</span><br><span class="line">  <span class="attr">"cluster_uuid"</span> : <span class="string">"0HpHJxLAREq6SntFdfVSPQ"</span>,</span><br><span class="line">  <span class="attr">"version"</span> : &#123;</span><br><span class="line">    <span class="attr">"number"</span> : <span class="string">"7.4.0"</span>,</span><br><span class="line">    <span class="attr">"build_flavor"</span> : <span class="string">"default"</span>,</span><br><span class="line">    <span class="attr">"build_type"</span> : <span class="string">"zip"</span>,</span><br><span class="line">    <span class="attr">"build_hash"</span> : <span class="string">"22e1767283e61a198cb4db791ea66e3f11ab9910"</span>,</span><br><span class="line">    <span class="attr">"build_date"</span> : <span class="string">"2019-09-27T08:36:48.569419Z"</span>,</span><br><span class="line">    <span class="attr">"build_snapshot"</span> : <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"lucene_version"</span> : <span class="string">"8.2.0"</span>,</span><br><span class="line">    <span class="attr">"minimum_wire_compatibility_version"</span> : <span class="string">"6.8.0"</span>,</span><br><span class="line">    <span class="attr">"minimum_index_compatibility_version"</span> : <span class="string">"6.0.0-beta1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"tagline"</span> : <span class="string">"You Know, for Search"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="三-数据准备"><a href="#三-数据准备" class="headerlink" title="三. 数据准备"></a>三. 数据准备</h1><h2 id="1-数据库到JSON"><a href="#1-数据库到JSON" class="headerlink" title="1. 数据库到JSON"></a>1. 数据库到JSON</h2><p>elasticsearch 要求文档的输入格式为 JSON，因此我们需要把数据库中的数据转化为JSON形式。比如：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"subj"</span>: <span class="string">"周星驰"</span>, </span><br><span class="line">    <span class="attr">"po"</span>: [ &#123;<span class="attr">"pred"</span>: <span class="string">"actor_foreName"</span>, <span class="attr">"obj"</span>: <span class="string">"Stephen Chow"</span>&#125;,</span><br><span class="line">           &#123;<span class="attr">"pred"</span>: <span class="string">"actor_nationality"</span>, <span class="attr">"obj"</span>: <span class="string">"中国"</span>&#125;, </span><br><span class="line">           &#123;<span class="attr">"pred"</span>: <span class="string">"actor_constellation"</span>, <span class="attr">"obj"</span>: <span class="string">"巨蟹座"</span>&#125;, </span><br><span class="line">           &#123;<span class="attr">"pred"</span>: <span class="string">"actor_birthPlace"</span>, <span class="attr">"obj"</span>: <span class="string">"香港"</span>&#125;, </span><br><span class="line">           &#123;<span class="attr">"pred"</span>: <span class="string">"actor_birthDay"</span>, <span class="attr">"obj"</span>: <span class="string">"1962年6月22日"</span>&#125; ]</span><br><span class="line">           ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对应代码为./utils/get_json.py，该程序的工作流程为对数据库进行查表，而后将对应信息保存到字典里。通过 json.dumps()将Python对象转化为JSON格式并写成文件。</p>
<p>运行get_json.py，生成actor.json和movie.json</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C:\my\Python\python.exe C:<span class="regexp">/d/mmm</span><span class="regexp">/pycharm/</span>elasticsearch<span class="regexp">/utils/g</span>et_json.py</span><br><span class="line">max_id:  <span class="number">13967</span></span><br><span class="line">max_id:  <span class="number">22219</span></span><br><span class="line">tuple index out of range</span><br><span class="line"></span><br><span class="line">Process finished with <span class="keyword">exit</span> code <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p><strong>可能出现的问题：</strong><br><a href="https://blog.csdn.net/weixin_40771521/article/details/89317180" target="_blank" rel="noopener">python pyahocorasick包安装失败解决方法</a></p>
<h2 id="2-属性同义词扩展"><a href="#2-属性同义词扩展" class="headerlink" title="2. 属性同义词扩展"></a>2. 属性同义词扩展</h2><p>为了支持对同一类问题的不同询问方式，我们采用同意属性映射来扩展属性，当遇到同义属性时，我们将其映射到数据集中的属性上，对应于./data/attr_mapping.txt 文件：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">actor_chName</span> 中文名 名字 姓名</span><br><span class="line"><span class="symbol">actor_foreName</span> 英文名 外文名</span><br><span class="line"><span class="symbol">actor_bio</span> 简介 简历 介绍</span><br><span class="line"><span class="symbol">actor_nationality</span> 国籍</span><br><span class="line"><span class="symbol">actor_constellation</span> 星座</span><br><span class="line"><span class="symbol">actor_birthPlace</span> 出生地 老家</span><br><span class="line"><span class="symbol">actor_birthPlace</span> 出生日期 生日</span><br><span class="line"><span class="symbol">actor_repWorks</span> 代表作 作品</span><br><span class="line"><span class="symbol">actor_achiem</span> 成就 获奖 奖项</span><br><span class="line"><span class="symbol">actor_birthPlace</span> 经纪公司</span><br><span class="line"><span class="keyword">movie_chName </span>片名</span><br><span class="line"><span class="keyword">movie_foreName </span>英文片名 外文片名</span><br><span class="line"><span class="keyword">movie_prodTime </span>出品时间</span><br><span class="line"><span class="keyword">movie_foreName </span>出品公司 制作方</span><br><span class="line"><span class="keyword">movie_director </span>导演</span><br><span class="line"><span class="keyword">movie_screenwriter </span>编剧</span><br><span class="line"><span class="keyword">movie_genre </span>类型</span><br><span class="line"><span class="keyword">movie_star </span>主演 演员 参演人员</span><br><span class="line"><span class="keyword">movie_length </span>片长 时长</span><br><span class="line"><span class="keyword">movie_rekeaseTime </span>上映时间</span><br><span class="line"><span class="keyword">movie_language </span>对白语言 语言 语种</span><br><span class="line"><span class="keyword">movie_achiem </span>奖项 获奖 成就</span><br></pre></td></tr></table></figure>
<h2 id="3-建立属性间映射-get-ac-attr-py"><a href="#3-建立属性间映射-get-ac-attr-py" class="headerlink" title="3. 建立属性间映射 get_ac_attr.py"></a>3. 建立属性间映射 get_ac_attr.py</h2><p>我们通过cpikle 对属性间映射进行打包，其中属性间的映射通过ahocorasic.Automaton()进行处理。对应的输出为./data/attr_ac.pkl.</p>
<p>运行get_ac_attr.py，生成./data/attr_ac.pkl</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\my\Python\python.exe C:<span class="regexp">/d/mmm</span><span class="regexp">/pycharm/</span>elasticsearch<span class="regexp">/utils/g</span>et_ac_attr.py</span><br><span class="line"></span><br><span class="line">Process finished with <span class="keyword">exit</span> code <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h2 id="4-获取属性值和属性间的映射-get-total-val-py"><a href="#4-获取属性值和属性间的映射-get-total-val-py" class="headerlink" title="4. 获取属性值和属性间的映射 get_total_val.py"></a>4. 获取属性值和属性间的映射 get_total_val.py</h2><p>通过对数据库进行查表得到各个实体的属性和属性值，而后将其存储为./data/total_val.txt 文件在搜索时使用。</p>
<p>运行get_total_val.py，生成actor.txt和movie.txt</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C:\my\Python\python.exe C:<span class="regexp">/d/mmm</span><span class="regexp">/pycharm/</span>elasticsearch<span class="regexp">/utils/g</span>et_total_val.py</span><br><span class="line">max_id:  <span class="number">13967</span></span><br><span class="line">max_id:  <span class="number">22219</span></span><br><span class="line">tuple index out of range</span><br><span class="line"></span><br><span class="line">Process finished with <span class="keyword">exit</span> code <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h2 id="5-获取所有实体"><a href="#5-获取所有实体" class="headerlink" title="5. 获取所有实体"></a>5. 获取所有实体</h2><p>我们直接通过MySQL Workbench操作得到所有实体的倒出并存储为一个文件，名为./data/all_entity.txt。</p>
<p>文件格式如下：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">周星驰</span><br><span class="line">戚美珍</span><br><span class="line">车保罗</span><br><span class="line">黎小田</span><br><span class="line">高雄</span><br><span class="line">石天 (原名：刘伟城)</span><br><span class="line">张学友</span><br><span class="line">章子怡</span><br><span class="line"><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span></span><br></pre></td></tr></table></figure>
<h1 id="四-将数据导入到-elasticsearch"><a href="#四-将数据导入到-elasticsearch" class="headerlink" title="四. 将数据导入到 elasticsearch"></a>四. 将数据导入到 elasticsearch</h1><h2 id="1-在-elasticsearch-中新建-index-和-type"><a href="#1-在-elasticsearch-中新建-index-和-type" class="headerlink" title="1. 在 elasticsearch 中新建 index 和 type"></a>1. 在 elasticsearch 中新建 index 和 type</h2><p>这里我们遵循教程中的要求，采用下列命令建立 index 和 type：</p>
<p>可以用elasticsearch-head或CURL。</p>
<p>ealsticsearch只是后端提供各种api，那么怎么直观的使用它呢？elasticsearch-head将是一款专门针对于elasticsearch的客户端工具。elasticsearch-head配置包，下载地址：<a href="https://github.com/mobz/elasticsearch-head" target="_blank" rel="noopener">https://github.com/mobz/elasticsearch-head</a> 。安装可以参考文章<a href="https://www.cnblogs.com/hts-technology/p/8477258.html" target="_blank" rel="noopener">windows下安装ElasticSearch的Head插件</a> 。</p>
<p>我们这里选择用CURL，去<a href="https://curl.haxx.se/download.html" target="_blank" rel="noopener">curl官网</a>下载对应版本的包，解压后打开CMD切换到对应目录下运行CURL.exe文件，</p>
<p>如果把该CURL.exe文件复制到C:\Windows\System32目录下，则不需要切换目录，可以直接运行curl命令。</p>
<h3 id="a-用下列命令建立-index-和-type："><a href="#a-用下列命令建立-index-和-type：" class="headerlink" title="a. 用下列命令建立 index 和 type："></a>a. 用下列命令建立 index 和 type：</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT <span class="string">"localhost:9200/demo?pretty"</span> -H <span class="string">"Content-Type: application/json"</span> -d<span class="string">" &#123; <span class="subst">\"</span>mappings<span class="subst">\"</span>: &#123; <span class="subst">\"</span>properties<span class="subst">\"</span>: &#123; <span class="subst">\"</span>subj<span class="subst">\"</span>: &#123;<span class="subst">\"</span>type<span class="subst">\"</span>: <span class="subst">\"</span>keyword<span class="subst">\"</span>&#125;, <span class="subst">\"</span>po<span class="subst">\"</span>:&#123; <span class="subst">\"</span>type<span class="subst">\"</span>: <span class="subst">\"</span>nested<span class="subst">\"</span>, <span class="subst">\"</span>properties<span class="subst">\"</span>:&#123; <span class="subst">\"</span>pred<span class="subst">\"</span>:&#123;<span class="subst">\"</span>type<span class="subst">\"</span>:<span class="subst">\"</span>keyword<span class="subst">\"</span>&#125;, <span class="subst">\"</span>obj<span class="subst">\"</span>:&#123;<span class="subst">\"</span>type<span class="subst">\"</span>:<span class="subst">\"</span>keyword<span class="subst">\"</span>&#125; &#125; &#125; &#125; &#125; &#125; "</span></span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C:<span class="symbol">\U</span>sers<span class="symbol">\m</span>mm&gt;curl -XPUT "localhost:9200/demo?pretty" -H "Content-Type: application/json" -d" &#123; <span class="symbol">\"</span>mappings<span class="symbol">\"</span>: &#123; <span class="symbol">\"</span>properties<span class="symbol">\"</span>: &#123; <span class="symbol">\"</span>subj<span class="symbol">\"</span>: &#123;<span class="symbol">\"</span>type<span class="symbol">\"</span>: <span class="symbol">\"</span>keyword<span class="symbol">\"</span>&#125;, <span class="symbol">\"</span>po<span class="symbol">\"</span>:&#123; <span class="symbol">\"</span>type<span class="symbol">\"</span>: <span class="symbol">\"</span>nested<span class="symbol">\"</span>, <span class="symbol">\"</span>properties<span class="symbol">\"</span>:&#123; <span class="symbol">\"</span>pred<span class="symbol">\"</span>:&#123;<span class="symbol">\"</span>type<span class="symbol">\"</span>:<span class="symbol">\"</span>keyword<span class="symbol">\"</span>&#125;, <span class="symbol">\"</span>obj<span class="symbol">\"</span>:&#123;<span class="symbol">\"</span>type<span class="symbol">\"</span>:<span class="symbol">\"</span>keyword<span class="symbol">\"</span>&#125; &#125; &#125; &#125; &#125; &#125; "</span><br><span class="line">&#123;</span><br><span class="line">  "acknowledged" : true,</span><br><span class="line">  "shards_acknowledged" : true,</span><br><span class="line">  "index" : "demo"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注意：笔者使用的Elasticsearch&gt;7.0，Elasticsearch 7.0及以后版本移除映射类型</strong></p>
<h3 id="b-可用下列命令查询是否添加成功"><a href="#b-可用下列命令查询是否添加成功" class="headerlink" title="b. 可用下列命令查询是否添加成功"></a>b. 可用下列命令查询是否添加成功</h3><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">curl</span> <span class="literal">-</span><span class="comment">XGET</span> <span class="comment">localhost:9200/_search?pretty</span></span><br></pre></td></tr></table></figure>
<p>运行结果<br><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\mmm&gt;curl -XGET localhost:<span class="number">9200</span>/_search?pretty</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"took"</span> : 3,</span><br><span class="line">  <span class="string">"timed_out"</span> : <span class="type">false</span>,</span><br><span class="line">  <span class="string">"_shards"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : 1,</span><br><span class="line">    <span class="string">"successful"</span> : 1,</span><br><span class="line">    <span class="string">"skipped"</span> : 0,</span><br><span class="line">    <span class="string">"failed"</span> : 0</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"hits"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 0,</span><br><span class="line">      <span class="string">"relation"</span> : "<span class="type">eq</span><span class="string">"</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    "</span>max_score<span class="string">" : null,</span></span><br><span class="line"><span class="string">    "</span>hits<span class="string">" : [ ]</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="c-如果创建错了，可用下列命令删除索引"><a href="#c-如果创建错了，可用下列命令删除索引" class="headerlink" title="c. 如果创建错了，可用下列命令删除索引"></a>c. 如果创建错了，可用下列命令删除索引</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XDELETE <span class="string">localhost:</span><span class="number">9200</span>/demo</span><br></pre></td></tr></table></figure>
<h2 id="2-数据导入-insert-py"><a href="#2-数据导入-insert-py" class="headerlink" title="2. 数据导入 insert.py"></a>2. 数据导入 insert.py</h2><p>为了测试简单，把actor.json文件改名为../data/baidu_baike.json。</p>
<p>运行 insert.py</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">C:\my\Python\python.exe C:<span class="regexp">/d/mmm</span><span class="regexp">/pycharm/</span>elasticsearch<span class="regexp">/utils/i</span>nsert.py</span><br><span class="line"><span class="number">1000</span></span><br><span class="line"><span class="number">2000</span></span><br><span class="line"><span class="number">3000</span></span><br><span class="line"><span class="number">4000</span></span><br><span class="line"><span class="number">5000</span></span><br><span class="line"><span class="number">6000</span></span><br><span class="line"><span class="number">7000</span></span><br><span class="line"><span class="number">8000</span></span><br><span class="line"><span class="number">9000</span></span><br><span class="line"><span class="number">10000</span></span><br><span class="line"><span class="number">11000</span></span><br><span class="line"><span class="number">12000</span></span><br><span class="line"><span class="number">13000</span></span><br><span class="line"></span><br><span class="line">Process finished with <span class="keyword">exit</span> code <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>此时已经可以通过curl方式检索知识库了。</p>
<h1 id="五-检索知识库"><a href="#五-检索知识库" class="headerlink" title="五. 检索知识库"></a>五. 检索知识库</h1><p>DOS默认的是（GB2312)，让cmd dos 支持utf-8方法<code>CHCP 65001</code>，关闭cmd，CHCP又还原成936。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">C:</span>\Users\mmm&gt;CHCP <span class="number">65001</span> </span><br><span class="line">Active code <span class="string">page:</span> <span class="number">65001</span></span><br></pre></td></tr></table></figure>
<p>curl方式检索知识库，可用下列命令，如检索：周星驰</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET "localhost:9200/demo/_doc/_search?&amp;pretty" -H "Content-Type:application/json" -d" &#123; <span class="symbol">\"</span>query<span class="symbol">\"</span>:&#123; <span class="symbol">\"</span>bool<span class="symbol">\"</span>:&#123; <span class="symbol">\"</span>filter<span class="symbol">\"</span>:&#123; <span class="symbol">\"</span>term<span class="symbol">\"</span>:&#123;<span class="symbol">\"</span>subj<span class="symbol">\"</span>:<span class="symbol">\"</span><span class="symbol">\u</span>5468<span class="symbol">\u</span>661f<span class="symbol">\u</span>9a70<span class="symbol">\"</span>&#125; &#125; &#125; &#125; &#125;</span><br></pre></td></tr></table></figure>
<p>运行结果<br><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET <span class="string">"localhost:9200/demo/_doc/_search?&amp;pretty"</span> -H <span class="string">"Content-Type:application/json"</span> -d<span class="string">" &#123; \"</span>query\<span class="string">":&#123; \"</span>bool\<span class="string">":&#123; \"</span>filter\<span class="string">":&#123; \"</span>term\<span class="string">":&#123;\"</span>subj\<span class="string">":\"</span>\u5468\u661f\u9a70\<span class="string">"&#125; &#125; &#125; &#125; &#125;"</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"took"</span> : 2,</span><br><span class="line">  <span class="string">"timed_out"</span> : <span class="type">false</span>,</span><br><span class="line">  <span class="string">"_shards"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : 1,</span><br><span class="line">    <span class="string">"successful"</span> : 1,</span><br><span class="line">    <span class="string">"skipped"</span> : 0,</span><br><span class="line">    <span class="string">"failed"</span> : 0</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"hits"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 1,</span><br><span class="line">      <span class="string">"relation"</span> : "<span class="type">eq</span><span class="string">"</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    "</span>max_score<span class="string">" : 0.0,</span></span><br><span class="line"><span class="string">    "</span>hits<span class="string">" : [</span></span><br><span class="line"><span class="string">      &#123;</span></span><br><span class="line"><span class="string">        "</span>_index<span class="string">" : "</span>demo<span class="string">",</span></span><br><span class="line"><span class="string">        "</span>_type<span class="string">" : "</span>_doc<span class="string">",</span></span><br><span class="line"><span class="string">        "</span>_id<span class="string">" : "</span><span class="number">1</span><span class="string">",</span></span><br><span class="line"><span class="string">        "</span>_score<span class="string">" : 0.0,</span></span><br><span class="line"><span class="string">        "</span>_source<span class="string">" : &#123;</span></span><br><span class="line"><span class="string">          "</span>subj<span class="string">" : "</span>周星驰<span class="string">",</span></span><br><span class="line"><span class="string">          "</span>po<span class="string">" : [</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">              "</span>pred<span class="string">" : "</span>actor_bio<span class="string">",</span></span><br><span class="line"><span class="string">              "</span>obj<span class="string">" : "</span> 周星驰，<span class="number">1962</span>年<span class="number">6</span>月<span class="number">22</span>日生于香港，祖籍浙江宁波，中国香港演员、导演、编剧、制作人、商人，毕业于无线电视艺员训练班。<span class="number">1980</span>年成为丽的电视台的特约演员，从而进入演艺圈。<span class="number">1981</span>年出演个人首部电视剧《IQ成熟时》。<span class="number">1988</span>年将演艺事业的重心转向大银幕，并于同年出演电 影处女作《捕风汉子》。<span class="number">1990</span>年凭借喜剧片《一本漫画闯天涯》确立其无厘头的表演风格 [<span class="number">1</span>]  ；同年，因其主演的喜剧动作片《赌圣》打破香港地区票 房纪录而获得关注 [<span class="number">2</span>]  。<span class="number">1991</span>年主演喜剧片《逃学威龙》，并再次打破香港地区票房纪录 [<span class="number">3</span>]  。<span class="number">1995</span>年凭借喜剧爱情片《大话西游》奠定其在华语影 坛的地位。<span class="number">1999</span>年自导自演的喜剧片《喜剧之王》获得香港电影年度票房冠军 [<span class="number">4</span>]  。<span class="number">2002</span>年凭借喜剧片《少林足球》获得第<span class="number">21</span>届香港电影金像奖最佳男 主角奖以及最佳导演奖 [<span class="number">5</span>]  。<span class="number">2003</span>年成为美国《时代周刊》封面人物 [<span class="number">6</span>]  。<span class="number">2005</span>年凭借喜剧动作片《功夫》获得第<span class="number">42</span>届台湾电影金马奖最佳导演奖 [<span class="number">7</span>]  。<span class="number">2008</span>年自导自演的科幻喜剧片《长江<span class="number">7</span>号》获得香港电影年度票房冠军 [<span class="number">8</span>]  。<span class="number">2013</span>年执导古装喜剧片《西游·降魔篇》，该片以<span class="number">2.18</span>亿美元的票房 成绩打破华语电影在全球的票房纪录 [<span class="number">9</span>-<span class="number">10</span>]  。<span class="number">2016</span>年担任科幻喜剧片《美人鱼》的导演、编剧、制作人，该片以超过<span class="number">33</span>亿元的票房创下中国内地电影票房纪录 [<span class="number">11</span>-<span class="number">14</span>]  。<span class="number">2017</span>年<span class="number">1</span>月<span class="number">28</span>日，担任监制、编剧的古装喜剧片《西游伏妖篇》上映 [<span class="number">15</span>]  。<span class="number">2018</span>年执导《美人鱼<span class="number">2</span>》 [<span class="number">16</span>]  。演艺事业外，周星驰 还涉足商界。<span class="number">1989</span>年成立星炜有限公司 [<span class="number">17</span>]  。<span class="number">1996</span>年成立星辉公司 [<span class="number">18</span>]  。<span class="number">2010</span>年出任比高集团有限公司执行董事 [<span class="number">19</span>]  。 <span class="string">"</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">              "</span>pred<span class="string">" : "</span>actor_foreName<span class="string">",</span></span><br><span class="line"><span class="string">              "</span>obj<span class="string">" : "</span>Stephen Chow<span class="string">"</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">              "</span>pred<span class="string">" : "</span>actor_nationality<span class="string">",</span></span><br><span class="line"><span class="string">              "</span>obj<span class="string">" : "</span>中国<span class="string">"</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">              "</span>pred<span class="string">" : "</span>actor_constellation<span class="string">",</span></span><br><span class="line"><span class="string">              "</span>obj<span class="string">" : "</span>巨蟹座<span class="string">"</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">              "</span>pred<span class="string">" : "</span>actor_birthPlace<span class="string">",</span></span><br><span class="line"><span class="string">              "</span>obj<span class="string">" : "</span>香港<span class="string">"</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">              "</span>pred<span class="string">" : "</span>actor_birthDay<span class="string">",</span></span><br><span class="line"><span class="string">              "</span>obj<span class="string">" : "</span><span class="number">1962</span>年<span class="number">6</span>月<span class="number">22</span>日<span class="string">"</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">              "</span>pred<span class="string">" : "</span>actor_repWorks<span class="string">",</span></span><br><span class="line"><span class="string">              "</span>obj<span class="string">" : "</span>赌圣、逃学威龙系列、唐伯虎点秋香、大话西游系列、喜剧之王、少林足球、功夫、长江七号<span class="string">"</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">              "</span>pred<span class="string">" : "</span>actor_achiem<span class="string">",</span></span><br><span class="line"><span class="string">              "</span>obj<span class="string">" : "</span>获得两届香港电影金像奖最佳影片\n第<span class="number">21</span>届香港电影金像奖最佳导演\n第<span class="number">21</span>届香港电影金像奖最佳男主角\n第<span class="number">42</span>届台湾电影金马奖最佳导演\n第<span class="number">42</span>届台湾电影金马奖最佳剧情片\n\n第<span class="number">25</span>届台湾电影金马奖最佳男配角\n第<span class="number">28</span>届大众电影百花奖优秀故事片\n第<span class="number">23</span>届香港电影评论学会大 奖最佳导演\n第<span class="number">8</span>届香港电影评论学会大奖最佳电影\n第<span class="number">2</span>届香港电影评论学会大奖最佳男主角\n第<span class="number">37</span>届亚太电影节最佳男主角\n第<span class="number">13</span>届亚洲电影博览会最 佳导演\n获得两届香港电影金紫荆奖最佳影片\n第<span class="number">01</span>届香港电影金紫荆奖最佳男主角\n国际杰人会港澳杰人之星等\n收起<span class="string">"</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">              "</span>pred<span class="string">" : "</span>actor_brokerage<span class="string">",</span></span><br><span class="line"><span class="string">              "</span>obj<span class="string">" : "</span>星辉公司、比高集团<span class="string">"</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">          ]</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure></p>
<h1 id="六-程序核心-utils-views-py"><a href="#六-程序核心-utils-views-py" class="headerlink" title="六. 程序核心 ./utils/views.py"></a>六. 程序核心 ./utils/views.py</h1><p>改程序对输入的自然语言问题进行解析，识别出出现在其中的实体名、属性及属性值，并将其转换为对应的logical form。总体流程和浙大的类似，我只是将其从Django 中提取出来方便对于框架不懂的人直接使用。关于views.py的详细解释请看<a href="http://openkg1.oss-cn-beijing.aliyuncs.com/76c540e4-c26c-41f6-9c98-4871a06b9eae/demo.pdf" target="_blank" rel="noopener">浙大的教程</a></p>

    </div>
    
    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="/" target="_blank">Ljjyy.com</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/archives/2019/10/100595.html" class="pre-post btn btn-default" title='从零开始学习知识图谱 之 五.电影知识图谱构建 5.基于Deepdive非结构化文本关系抽取'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">从零开始学习知识图谱 之 五.电影知识图谱构建 5.基于Deepdive非结构化文本关系抽取</span>
        </a>
    
    
        <a href="/archives/2019/10/100593.html" class="next-post btn btn-default" title='从零开始学习知识图谱 之 三.电影知识图谱构建 3.基于REfO的简单知识问答'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">从零开始学习知识图谱 之 三.电影知识图谱构建 3.基于REfO的简单知识问答</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
    <div id="vcomments" class="valine"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>

    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: '5MzTXYXkt03k101j0PmSDN34-gzGzoHsz',
            appKey: 'iwjYgwno6qj3wtDVVSbe8nYQ',
            placeholder: '说点什么吧',
            notify: false,
            verify: true,
            avatar: 'mm',
            meta: 'nick,mail'.split(','),
            pageSize: '10',
            path: window.location.pathname,
            lang: 'zh-CN'.toLowerCase()
        })
    </script>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一-简介"><span class="toc-text">一. 简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二-环境准备"><span class="toc-text">二. 环境准备</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-操作系统"><span class="toc-text">1. 操作系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-jdk"><span class="toc-text">2. jdk</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Python3"><span class="toc-text">3. Python3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-ElasticSearch"><span class="toc-text">4. ElasticSearch</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装"><span class="toc-text">安装</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三-数据准备"><span class="toc-text">三. 数据准备</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-数据库到JSON"><span class="toc-text">1. 数据库到JSON</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-属性同义词扩展"><span class="toc-text">2. 属性同义词扩展</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-建立属性间映射-get-ac-attr-py"><span class="toc-text">3. 建立属性间映射 get_ac_attr.py</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-获取属性值和属性间的映射-get-total-val-py"><span class="toc-text">4. 获取属性值和属性间的映射 get_total_val.py</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-获取所有实体"><span class="toc-text">5. 获取所有实体</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#四-将数据导入到-elasticsearch"><span class="toc-text">四. 将数据导入到 elasticsearch</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-在-elasticsearch-中新建-index-和-type"><span class="toc-text">1. 在 elasticsearch 中新建 index 和 type</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#a-用下列命令建立-index-和-type："><span class="toc-text">a. 用下列命令建立 index 和 type：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#b-可用下列命令查询是否添加成功"><span class="toc-text">b. 可用下列命令查询是否添加成功</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#c-如果创建错了，可用下列命令删除索引"><span class="toc-text">c. 如果创建错了，可用下列命令删除索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-数据导入-insert-py"><span class="toc-text">2. 数据导入 insert.py</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#五-检索知识库"><span class="toc-text">五. 检索知识库</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#六-程序核心-utils-views-py"><span class="toc-text">六. 程序核心 ./utils/views.py</span></a></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2019-2024&emsp;<a href="/" class="copyright-links" target="_blank" rel="nofollow">Ljjyy.com</a>
                </span> |
                <span>
                    <a href="/about/" class="copyright-links" target="_blank" rel="nofollow">关于我们</a>
                </span> |                
                <span>
                    <a href="/sitemap.xml" class="copyright-links" target="_blank" rel="nofollow">网站地图</a>
                </span> |
                <span>
                    <a href="/archives/" class="copyright-links" target="_blank" rel="nofollow">时间轴</a>
                </span>              
            </div>
        </div>
    </div>
</div>







<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>