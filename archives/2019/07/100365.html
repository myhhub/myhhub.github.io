<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.2.3">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="https://www.ljjyy.com">
    <!--SEO-->

    <meta name="keywords" content="hadoop,elk,日志">


    <meta name="description" content="概述开源实时日志分析ELK平台(ElasticSearch, Logstash, Kibana组成)，能很方便的帮我们收集日志，进行集中化的管理，并且能很方便的进行日志的统计和检索，下面基于EL...">



<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">

    <!--Title-->


<title>大数据hadoop之 五十九.开源实时日志分析ELK平台 | 来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</title>


    <link rel="alternate" href="/atom.xml" title="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
	<div class="hide">
        <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
        <script>LA.init({id: "JgbNOaw1xxsmUUsQ",ck: "JgbNOaw1xxsmUUsQ"})</script>
	</div>






    
    <meta name="baidu-site-verification" content="dTHILoORpx">


    <script>
        (function(){
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  >
    <div class="main-header-box">
        <!--a class="header-avatar" href="/" title='Ljjyy.com'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a-->
        <div class="branding">
            
                <h2> 多读书多实践，勤思考善领悟 </h2>
            
    	  </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">

        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="web-logo"  href="/" title='Ljjyy.com'></a>
                    <!--a class="navbar-brand" href="https://www.ljjyy.com">来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</a-->
                </div>
                <div class="collapse navbar-collapse" id="main-menu" style="">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/cloud/"><i class="fa "></i>云计算</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/front/"><i class="fa "></i>前端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/back/"><i class="fa "></i>后端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/devops/"><i class="fa "></i>运维</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/crack/"><i class="fa "></i>破解</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/penetration/"><i class="fa "></i>渗透</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/tool/"><i class="fa "></i>工具</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/other/"><i class="fa "></i>其他</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="大数据hadoop之 五十九.开源实时日志分析ELK平台">
            
	            大数据hadoop之 五十九.开源实时日志分析ELK平台
            
        </h1>
        <div class="post-meta">
    
        <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
            <a class="category-link" href="/categories/cloud/">云计算</a>
        </span>
    

    
        <span class="fa-wrap">
            <i class="fa fa-tags"></i>
            <span class="tags-meta">
                
                    <a class="tag-link" href="/tags/elk/">elk</a> <a class="tag-link" href="/tags/hadoop/">hadoop</a> <a class="tag-link" href="/tags/logs/">日志</a>
                
            </span>
        </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2019/07/05</span>
        </span>
        
    
</div>
            
            
            <p class="fa fa-exclamation-triangle warning">
                本文于<strong>1462</strong>天之前发表，文中内容可能已经过时。
            </p>
        
    </div>
    
    <div class="post-body post-content">
        <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>开源实时日志分析ELK平台(ElasticSearch, Logstash, Kibana组成)，能很方便的帮我们收集日志，进行集中化的管理，并且能很方便的进行日志的统计和检索，下面基于ELK的最新版本5.2.2进行一次整合测试。</p>
<p>ElasticSearch是一个高可扩展的开源的全文搜索分析引擎。它允许你快速的存储、搜索和分析大量数据。ElasticSearch通常作为后端程序，为需要复杂查询的应用提供服务。</p>
<p>Elasticsearch是一个基于Lucene的开源分布式搜索引擎，具有分布式多用户能力。Elasticsearch是用java开发，提供Restful接口，能够达到实时搜索、高性能计算；同时Elasticsearch的横向扩展能力非常强，不需要重启服务，基本上达到了零配置。</p>
<p>写到一半，发现一个非常好的Logstash的文章集合，大家直接参考吧。我之后会实验为主，至于理论详解，我感觉以下三篇文章，写的比我好多好多了。</p>
<p><a href="http://udn.yyuap.com/doc/logstash-best-practice-cn/index.html" target="_blank" rel="noopener">Logstash 最佳实践</a></p>
<p><a href="https://fuxiaopang.gitbooks.io/learnelasticsearch/" target="_blank" rel="noopener">Elasticsearch 权威指南</a></p>
<p><a href="https://www.gitbook.com/book/chenryn/elk-stack-guide-cn/details" target="_blank" rel="noopener">ELKstack 中文指南</a></p>
<h2 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求:"></a>环境要求:</h2><ul>
<li>JDK1.8</li>
<li>ElasticSearch 5.2.2</li>
</ul>
<p>##下载地址</p>
<p><a href="https://www.elastic.co/downloads/elasticsearch" target="_blank" rel="noopener">https://www.elastic.co/downloads/elasticsearch</a></p>
<h2 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h2><ul>
<li>1.解压ElasticSearch并进入目录：</li>
</ul>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:~</span><span class="variable">$ </span>tar xvfz elasticsearch-<span class="number">5.2</span>.<span class="number">2</span>.tar.gz</span><br></pre></td></tr></table></figure>
<ul>
<li>2.启动ElasticSearch</li>
</ul>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:~/elasticsearch-</span><span class="number">5.2</span>.<span class="number">2</span><span class="variable">$ </span>cd bin</span><br><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:~/elasticsearch-</span><span class="number">5.2</span>.<span class="number">2</span>/bin<span class="variable">$ </span>ls</span><br><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:~/elasticsearch-</span><span class="number">5.2</span>.<span class="number">2</span>/bin<span class="variable">$ </span>./elasticsearch</span><br></pre></td></tr></table></figure>
<p>日志中启动了两个端口分别是：9300和9200,9300用于跟其他的节点的传输，9200用于接受HTTP请求，ctrl+c可以结束进程</p>
<p>如果想要后台运行，可以用以下方法</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./<span class="keyword">bin/elasticsearch </span>-d</span><br></pre></td></tr></table></figure>
<ul>
<li><ol start="3">
<li>测试ElasticSearch</li>
</ol>
</li>
</ul>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:~</span><span class="variable">$ </span>curl <span class="number">127.0</span>.<span class="number">0</span>.<span class="number">1</span><span class="symbol">:</span><span class="number">9200</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span> : <span class="string">"ivu1waD"</span>,</span><br><span class="line">  <span class="string">"cluster_name"</span> : <span class="string">"elasticsearch"</span>,</span><br><span class="line">  <span class="string">"cluster_uuid"</span> : <span class="string">"J0GWcsnES6Grl2RJapiHyA"</span>,</span><br><span class="line">  <span class="string">"version"</span> : &#123;</span><br><span class="line">    <span class="string">"number"</span> : <span class="string">"5.2.1"</span>,</span><br><span class="line">    <span class="string">"build_hash"</span> : <span class="string">"db0d481"</span>,</span><br><span class="line">    <span class="string">"build_date"</span> : <span class="string">"2017-02-09T22:05:32.386Z"</span>,</span><br><span class="line">    <span class="string">"build_snapshot"</span> : <span class="keyword">false</span>,</span><br><span class="line">    <span class="string">"lucene_version"</span> : <span class="string">"6.4.1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"tagline"</span> : <span class="string">"You Know, for Search"</span></span><br><span class="line">&#125;</span><br><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:~</span>$</span><br></pre></td></tr></table></figure>
<p>也可以使用curl尝试远程关闭</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:~</span><span class="variable">$ </span>curl -XPOST <span class="string">'http://localhost:9200/_shutdown'</span></span><br></pre></td></tr></table></figure>
<ul>
<li><ol start="4">
<li>Elasticsearch配置文件</li>
</ol>
</li>
</ul>
<p>ElasticSearch的配置文件一般放置在安装目录下的config目录中。config目录中有两个文件,分别是elasticsearch.yml 和logging.yml。前者用来配置ElasticSearch不同模块的属性，比如网络地址，路径等，后者则用来配置自身的日志记录选项。</p>
<p>配置文件是YAML格式的，下面简要地介绍一些配置参数。</p>
<p><strong>网络地址，指定网络相关模块的绑定和发布地址</strong></p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">network:</span></span><br><span class="line"><span class="symbol">	host:</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br></pre></td></tr></table></figure>
<p><strong>路径指定数据和日志文件的路径</strong></p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">path:</span></span><br><span class="line"><span class="symbol">	logs:</span><span class="meta-keyword">/var/</span>log/elasticsearch</span><br><span class="line"><span class="symbol">	data:</span><span class="meta-keyword">/var/</span>data/elasticsearch</span><br></pre></td></tr></table></figure>
<p><strong>集群名，指定生产集群的名字，集群将根据这个名字来自动发现和加入节点</strong></p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cluster:</span><br><span class="line">	<span class="keyword">name</span>:&lt;<span class="keyword">NAME</span> <span class="keyword">OF</span> YOUR CLUSTER&gt;</span><br></pre></td></tr></table></figure>
<p><strong>节点名，指定每个节点的默认名称</strong></p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">node</span><span class="title">:</span></span><br><span class="line"><span class="title">	name</span>:<span class="tag">&lt;NAME OF YOUR NODE&gt;</span></span><br></pre></td></tr></table></figure>
<p>因为elasticsearch安装在虚拟机里面，我希望我的主机也可以访问，需要config/elasticsearch.yml进行配置：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">network</span><span class="selector-class">.host</span>: 192<span class="selector-class">.168</span><span class="selector-class">.1</span><span class="selector-class">.159</span></span><br></pre></td></tr></table></figure>
<p>重新启动后会出现错误</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">/bin</span>$ <span class="string">./elasticsearch</span></span><br></pre></td></tr></table></figure>
<p>解决办法：<br>切换到root用户，修改配置limits.conf</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:/etc/security</span><span class="variable">$ </span>sudo nano limits.conf</span><br><span class="line"></span><br><span class="line">* soft nofile <span class="number">65536</span></span><br><span class="line">* hard nofile <span class="number">131072</span></span><br><span class="line">* soft nproc <span class="number">2048</span></span><br><span class="line">* hard nproc <span class="number">4096</span></span><br></pre></td></tr></table></figure>
<p>修改配置sysctl.conf</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:/etc/security</span><span class="variable">$ </span>sudo nano /etc/sysctl.conf </span><br><span class="line"></span><br><span class="line">vm.max_map_count=<span class="number">655360</span></span><br></pre></td></tr></table></figure>
<p>重新再启动后，成功</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888@hadoopmaster:~/elasticsearch-5.2.2/bin$ ./elasticsearch</span><br><span class="line">[<span class="string">2017-03-13T15:19:11,746</span>][<span class="symbol">INFO </span>][<span class="string">o.e.n.Node               </span>] [] initializing ...</span><br><span class="line">[<span class="string">2017-03-13T15:19:11,819</span>][<span class="symbol">INFO </span>][<span class="string">o.e.e.NodeEnvironment    </span>] [Vz87mNE] using [1] data paths, mounts [[/ (/dev/mapper/hadoopmaster--vg-root)]], net usable<span class="emphasis">_space [40.9gb], net total_</span>space [50.8gb], spins? [possibly], types [ext4]</span><br><span class="line">[<span class="string">2017-03-13T15:19:11,819</span>][<span class="symbol">INFO </span>][<span class="string">o.e.e.NodeEnvironment    </span>] [Vz87mNE] heap size [1.9gb], compressed ordinary object pointers [true]</span><br><span class="line">[<span class="string">2017-03-13T15:19:11,837</span>][<span class="symbol">INFO </span>][<span class="string">o.e.n.Node               </span>] node name [Vz87mNE] derived from node ID [Vz87mNE2QAmvwodx2uB94Q]; set [node.name] to override</span><br><span class="line">[<span class="string">2017-03-13T15:19:11,839</span>][<span class="symbol">INFO </span>][<span class="string">o.e.n.Node               </span>] version[5.2.2], pid[5208], build[f9d9b74/2017-02-24T17:26:45.835Z], OS[Linux/4.2.0-27-generic/amd64], JVM[Oracle Corporation/Java HotSpot(TM) 64-Bit Server VM/1.8.0_121/25.121-b13]</span><br><span class="line">[<span class="string">2017-03-13T15:19:12,810</span>][<span class="symbol">INFO </span>][<span class="string">o.e.p.PluginsService     </span>] [Vz87mNE] loaded module [aggs-matrix-stats]</span><br><span class="line">[<span class="string">2017-03-13T15:19:12,811</span>][<span class="symbol">INFO </span>][<span class="string">o.e.p.PluginsService     </span>] [Vz87mNE] loaded module [ingest-common]</span><br><span class="line">[<span class="string">2017-03-13T15:19:12,811</span>][<span class="symbol">INFO </span>][<span class="string">o.e.p.PluginsService     </span>] [Vz87mNE] loaded module [lang-expression]</span><br><span class="line">[<span class="string">2017-03-13T15:19:12,811</span>][<span class="symbol">INFO </span>][<span class="string">o.e.p.PluginsService     </span>] [Vz87mNE] loaded module [lang-groovy]</span><br><span class="line">[<span class="string">2017-03-13T15:19:12,811</span>][<span class="symbol">INFO </span>][<span class="string">o.e.p.PluginsService     </span>] [Vz87mNE] loaded module [lang-mustache]</span><br><span class="line">[<span class="string">2017-03-13T15:19:12,812</span>][<span class="symbol">INFO </span>][<span class="string">o.e.p.PluginsService     </span>] [Vz87mNE] loaded module [lang-painless]</span><br><span class="line">[<span class="string">2017-03-13T15:19:12,812</span>][<span class="symbol">INFO </span>][<span class="string">o.e.p.PluginsService     </span>] [Vz87mNE] loaded module [percolator]</span><br><span class="line">[<span class="string">2017-03-13T15:19:12,812</span>][<span class="symbol">INFO </span>][<span class="string">o.e.p.PluginsService     </span>] [Vz87mNE] loaded module [reindex]</span><br><span class="line">[<span class="string">2017-03-13T15:19:12,812</span>][<span class="symbol">INFO </span>][<span class="string">o.e.p.PluginsService     </span>] [Vz87mNE] loaded module [transport-netty3]</span><br><span class="line">[<span class="string">2017-03-13T15:19:12,818</span>][<span class="symbol">INFO </span>][<span class="string">o.e.p.PluginsService     </span>] [Vz87mNE] loaded module [transport-netty4]</span><br><span class="line">[<span class="string">2017-03-13T15:19:12,819</span>][<span class="symbol">INFO </span>][<span class="string">o.e.p.PluginsService     </span>] [Vz87mNE] loaded plugin [analysis-icu]</span><br><span class="line">[<span class="string">2017-03-13T15:19:15,112</span>][<span class="symbol">INFO </span>][<span class="string">o.e.n.Node               </span>] initialized</span><br><span class="line">[<span class="string">2017-03-13T15:19:15,115</span>][<span class="symbol">INFO </span>][<span class="string">o.e.n.Node               </span>] [Vz87mNE] starting ...</span><br><span class="line">[<span class="string">2017-03-13T15:19:15,319</span>][<span class="symbol">INFO </span>][<span class="string">o.e.t.TransportService   </span>] [Vz87mNE] publish<span class="emphasis">_address &#123;192.168.1.159:9300&#125;, bound_</span>addresses &#123;192.168.1.159:9300&#125;</span><br><span class="line">[<span class="string">2017-03-13T15:19:15,322</span>][<span class="symbol">INFO </span>][<span class="string">o.e.b.BootstrapChecks    </span>] [Vz87mNE] bound or publishing to a non-loopback or non-link-local address, enforcing bootstrap checks</span><br><span class="line">[<span class="string">2017-03-13T15:19:18,386</span>][<span class="symbol">INFO </span>][<span class="string">o.e.c.s.ClusterService   </span>] [Vz87mNE] new_master &#123;Vz87mNE&#125;&#123;Vz87mNE2QAmvwodx2uB94Q&#125;&#123;q1ibuBcJQDOjdyySwkrHOw&#125;&#123;192.168.1.159&#125;&#123;192.168.1.159:9300&#125;, reason: zen-disco-elected-as-master ([0] nodes joined)</span><br><span class="line">[<span class="string">2017-03-13T15:19:18,424</span>][<span class="symbol">INFO </span>][<span class="string">o.e.h.HttpServer         </span>] [Vz87mNE] publish<span class="emphasis">_address &#123;192.168.1.159:9200&#125;, bound_</span>addresses &#123;192.168.1.159:9200&#125;</span><br><span class="line">[<span class="string">2017-03-13T15:19:18,424</span>][<span class="symbol">INFO </span>][<span class="string">o.e.n.Node               </span>] [Vz87mNE] started</span><br><span class="line">[<span class="string">2017-03-13T15:19:18,995</span>][<span class="symbol">INFO </span>][<span class="string">o.e.g.GatewayService     </span>] [Vz87mNE] recovered [2] indices into cluster_state</span><br><span class="line">[<span class="string">2017-03-13T15:19:19,255</span>][<span class="symbol">INFO </span>][<span class="string">o.e.c.r.a.AllocationService</span>] [<span class="string">Vz87mNE</span>] Cluster health status changed from [<span class="string">RED</span>] to [<span class="string">YELLOW</span>] (reason: [<span class="string">shards started [[.kibana</span>][<span class="symbol">0</span>]] ...]).</span><br></pre></td></tr></table></figure>
<p><img src="/img/hadoop/21/2017030901.png" alt></p>
<h2 id="ElasticSearch插件"><a href="#ElasticSearch插件" class="headerlink" title="ElasticSearch插件"></a>ElasticSearch插件</h2><p>ElasticSearch有各种插件，可以简化诸如管理索引、集群等任务。其中一些常用的插件有kopf Marvel Sense Shield等等。</p>
<h2 id="ElasticSearch安装错误FAQ"><a href="#ElasticSearch安装错误FAQ" class="headerlink" title="ElasticSearch安装错误FAQ"></a>ElasticSearch安装错误FAQ</h2><p>Elasticsearch5.0 安装问题集锦</p>
<p>elasticsearch 5.0 安装过程中遇到了一些问题，通过查找资料几乎都解决掉了，这里简单记录一下 ，供以后查阅参考，也希望可以帮助遇到同样问题的你。</p>
<ul>
<li>1.问题一：警告提示</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2016</span>-<span class="number">11</span>-<span class="number">06</span>T16:<span class="number">27</span>:<span class="number">21</span>,<span class="number">712</span>][WARN ][o<span class="selector-class">.e</span><span class="selector-class">.b</span><span class="selector-class">.JNANatives</span> ] unable to install syscall <span class="attribute">filter</span>: </span><br><span class="line"></span><br><span class="line">java<span class="selector-class">.lang</span><span class="selector-class">.UnsupportedOperationException</span>: seccomp unavailable: requires kernel <span class="number">3.5</span>+ with CONFIG_SECCOMP and CONFIG_SECCOMP_FILTER compiled <span class="keyword">in</span></span><br><span class="line">at org<span class="selector-class">.elasticsearch</span><span class="selector-class">.bootstrap</span><span class="selector-class">.Seccomp</span><span class="selector-class">.linuxImpl</span>(Seccomp<span class="selector-class">.java</span>:<span class="number">349</span>) ~[elasticsearch-<span class="number">5.0</span>.<span class="number">0</span><span class="selector-class">.jar</span>:<span class="number">5.0</span>.<span class="number">0</span>]</span><br><span class="line">at org<span class="selector-class">.elasticsearch</span><span class="selector-class">.bootstrap</span><span class="selector-class">.Seccomp</span><span class="selector-class">.init</span>(Seccomp<span class="selector-class">.java</span>:<span class="number">630</span>) ~[elasticsearch-<span class="number">5.0</span>.<span class="number">0</span><span class="selector-class">.jar</span>:<span class="number">5.0</span>.<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">报了一大串错误，其实只是一个警告。</span><br><span class="line"></span><br><span class="line">解决：使用比较新的linux版本，就不会出现此类问题了。</span><br></pre></td></tr></table></figure>
<ul>
<li>2.问题二：ERROR: bootstrap checks failed</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">max file descriptors [4096] <span class="keyword">for</span> elasticsearch process likely too low, increase <span class="keyword">to</span> at least [65536]</span><br><span class="line">max number of threads [1024] <span class="keyword">for</span><span class="built_in"> user </span>[lishang] likely too low, increase <span class="keyword">to</span> at least [2048]</span><br><span class="line"></span><br><span class="line">解决：切换到root用户，编辑limits.conf 添加类似如下内容</span><br><span class="line"></span><br><span class="line">vi /etc/security/limits.conf </span><br><span class="line"></span><br><span class="line">添加如下内容:</span><br><span class="line"></span><br><span class="line">* soft nofile 65536</span><br><span class="line"></span><br><span class="line">* hard nofile 131072</span><br><span class="line"></span><br><span class="line">* soft nproc 2048</span><br><span class="line"></span><br><span class="line">* hard nproc 4096</span><br></pre></td></tr></table></figure>
<ul>
<li>3.问题三：max number of threads [1024] for user [lish] likely too low, increase to at least [2048]</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">解决：切换到root用户，进入limits.d目录下修改配置文件。</span><br><span class="line"></span><br><span class="line">vi <span class="regexp">/etc/</span>security<span class="regexp">/limits.d/</span><span class="number">90</span>-nproc.conf </span><br><span class="line"></span><br><span class="line">修改如下内容：</span><br><span class="line"></span><br><span class="line">* soft nproc <span class="number">2048</span></span><br></pre></td></tr></table></figure>
<ul>
<li>4.问题四：max virtual memory areas vm.max_map_count [65530] likely too low, increase to at least [262144]</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">解决：切换到root用户修改配置sysctl.conf</span><br><span class="line"></span><br><span class="line">vi /etc/sysctl<span class="selector-class">.conf</span> </span><br><span class="line"></span><br><span class="line">添加下面配置：</span><br><span class="line"></span><br><span class="line">vm.max_map_count=<span class="number">655360</span></span><br><span class="line"></span><br><span class="line">并执行命令：</span><br><span class="line"></span><br><span class="line">sysctl -p</span><br><span class="line"></span><br><span class="line">然后，重新启动elasticsearch，即可启动成功。</span><br></pre></td></tr></table></figure>
<h2 id="LogStash"><a href="#LogStash" class="headerlink" title="LogStash"></a>LogStash</h2><p>Logstash是一个完全开源的工具，可以对你的日志进行收集、过滤，并将其存储供以后使用，参考官网的介绍图：</p>
<p><img src="/img/hadoop/21/175856_Lzw9_159239.png" alt></p>
<p>写到一半，发现一个非常好的Logstash的文章集合，大家直接参考吧。</p>
<p><a href="http://udn.yyuap.com/doc/logstash-best-practice-cn/index.html" target="_blank" rel="noopener">Logstash 最佳实践</a></p>
<p><a href="https://fuxiaopang.gitbooks.io/learnelasticsearch/" target="_blank" rel="noopener">Elasticsearch 权威指南</a></p>
<p><a href="https://www.gitbook.com/book/chenryn/elk-stack-guide-cn/details" target="_blank" rel="noopener">ELKstack 中文指南</a></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ul>
<li>1.解压进入目录</li>
</ul>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:~</span><span class="variable">$ </span>unzip logstash-<span class="number">5.2</span>.<span class="number">2</span>.zip</span><br></pre></td></tr></table></figure>
<ul>
<li>2.添加配置文件</li>
</ul>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:~/logstash-</span><span class="number">5.2</span>.<span class="number">2</span>/config<span class="variable">$ </span>nano logstash.conf</span><br></pre></td></tr></table></figure>
<ul>
<li>3.添加如下内容</li>
</ul>
<p>我们通过一个股票的例子（从yahoo下载下来的数据），来讲解通过logstash导入数据到elasticsearch中,<a href="http://finance.yahoo.com/q/hp?s=GOOG" target="_blank" rel="noopener">http://finance.yahoo.com/q/hp?s=GOOG</a></p>
<p>这个数据集中最重要的字段包括 date(日期) open price(开盘价格) close price(收盘价格) high price(最高价) volume(成交量) adjusted price(调整价格)</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Date,Open,High,Low,Close,Volume,Adj Close</span><br><span class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-10</span>,<span class="number">843.280029</span>,<span class="number">844.909973</span>,<span class="number">839.50</span>,<span class="number">843.25</span>,<span class="number">1701100</span>,<span class="number">843.25</span></span><br><span class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-09</span>,<span class="number">836.00</span>,<span class="number">842.00</span>,<span class="number">834.210022</span>,<span class="number">838.679993</span>,<span class="number">1259900</span>,<span class="number">838.679993</span></span><br><span class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span>,<span class="number">833.51001</span>,<span class="number">838.150024</span>,<span class="number">831.789978</span>,<span class="number">835.369995</span>,<span class="number">988700</span>,<span class="number">835.369995</span></span><br><span class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-07</span>,<span class="number">827.400024</span>,<span class="number">833.409973</span>,<span class="number">826.52002</span>,<span class="number">831.909973</span>,<span class="number">1016600</span>,<span class="number">831.909973</span></span><br><span class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-06</span>,<span class="number">826.950012</span>,<span class="number">828.880005</span>,<span class="number">822.400024</span>,<span class="number">827.780029</span>,<span class="number">1105800</span>,<span class="number">827.780029</span></span><br><span class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-03</span>,<span class="number">830.559998</span>,<span class="number">831.359985</span>,<span class="number">825.750977</span>,<span class="number">829.080017</span>,<span class="number">888900</span>,<span class="number">829.080017</span></span><br><span class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-02</span>,<span class="number">833.849976</span>,<span class="number">834.51001</span>,<span class="number">829.640015</span>,<span class="number">830.630005</span>,<span class="number">937700</span>,<span class="number">830.630005</span></span><br><span class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-01</span>,<span class="number">828.849976</span>,<span class="number">836.255005</span>,<span class="number">827.26001</span>,<span class="number">835.23999</span>,<span class="number">1491400</span>,<span class="number">835.23999</span></span><br><span class="line"><span class="number">2017</span><span class="number">-02</span><span class="number">-28</span>,<span class="number">825.609985</span>,<span class="number">828.539978</span>,<span class="number">820.200012</span>,<span class="number">823.210022</span>,<span class="number">2252300</span>,<span class="number">823.210022</span></span><br><span class="line"><span class="number">2017</span><span class="number">-02</span><span class="number">-27</span>,<span class="number">824.549988</span>,<span class="number">830.50</span>,<span class="number">824.00</span>,<span class="number">829.280029</span>,<span class="number">1099500</span>,<span class="number">829.280029</span></span><br><span class="line"><span class="number">2017</span><span class="number">-02</span><span class="number">-24</span>,<span class="number">827.72998</span>,<span class="number">829.00</span>,<span class="number">824.200012</span>,<span class="number">828.640015</span>,<span class="number">1386600</span>,<span class="number">828.640015</span></span><br><span class="line"><span class="number">2017</span><span class="number">-02</span><span class="number">-23</span>,<span class="number">830.119995</span>,<span class="number">832.460022</span>,<span class="number">822.880005</span>,<span class="number">831.330017</span>,<span class="number">1470100</span>,<span class="number">831.330017</span></span><br><span class="line"><span class="number">2017</span><span class="number">-02</span><span class="number">-22</span>,<span class="number">828.659973</span>,<span class="number">833.25</span>,<span class="number">828.640015</span>,<span class="number">830.76001</span>,<span class="number">982900</span>,<span class="number">830.76001</span></span><br><span class="line"><span class="number">2017</span><span class="number">-02</span><span class="number">-21</span>,<span class="number">828.659973</span>,<span class="number">833.450012</span>,<span class="number">828.349976</span>,<span class="number">831.659973</span>,<span class="number">1247700</span>,<span class="number">831.659973</span></span><br><span class="line"><span class="number">2017</span><span class="number">-02</span><span class="number">-17</span>,<span class="number">823.02002</span>,<span class="number">828.070007</span>,<span class="number">821.655029</span>,<span class="number">828.070007</span>,<span class="number">1597800</span>,<span class="number">828.070007</span></span><br><span class="line"><span class="number">2017</span><span class="number">-02</span><span class="number">-16</span>,<span class="number">819.929993</span>,<span class="number">824.400024</span>,<span class="number">818.97998</span>,<span class="number">824.159973</span>,<span class="number">1281700</span>,<span class="number">824.159973</span></span><br></pre></td></tr></table></figure>
<p>每行代表了某一天的股票价格，字段之间以逗号分割.</p>
<figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">input</span><br><span class="line">&#123;</span><br><span class="line">	file</span><br><span class="line">	&#123;</span><br><span class="line">		path=&gt;<span class="string">"/home/chu888chu888/table.csv"</span></span><br><span class="line">		start_position=&gt;<span class="string">"beginning"</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">filter</span><br><span class="line">&#123;</span><br><span class="line">	csv</span><br><span class="line">	&#123;</span><br><span class="line">		columns=&gt;[<span class="string">"date_of_record"</span>,<span class="string">"open"</span>,<span class="string">"high"</span>,<span class="string">"low"</span>,<span class="string">"close"</span>,<span class="string">"volume"</span>,<span class="string">"adj_close"</span>]</span><br><span class="line">		separator=&gt;<span class="string">","</span></span><br><span class="line">	&#125;</span><br><span class="line">	date</span><br><span class="line">	&#123;</span><br><span class="line">		match=&gt;[<span class="string">"date_of_record"</span>,<span class="string">"yyyy-MM-dd"</span>]</span><br><span class="line">	&#125;</span><br><span class="line">	mutate</span><br><span class="line">	&#123;</span><br><span class="line">		convert=&gt;[<span class="string">"open"</span>,<span class="string">"float"</span>]</span><br><span class="line">		convert=&gt;[<span class="string">"high"</span>,<span class="string">"float"</span>]</span><br><span class="line">		convert=&gt;[<span class="string">"low"</span>,<span class="string">"float"</span>]</span><br><span class="line">		convert=&gt;[<span class="string">"close"</span>,<span class="string">"float"</span>]</span><br><span class="line">		convert=&gt;[<span class="string">"volume"</span>,<span class="string">"integer"</span>]</span><br><span class="line">		convert=&gt;[<span class="string">"adj_close"</span>,<span class="string">"float"</span>]</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output</span><br><span class="line">&#123;</span><br><span class="line">	elasticsearch</span><br><span class="line">	&#123;</span><br><span class="line">		 hosts =&gt; [ <span class="string">"192.168.1.159:9200"</span> ]</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>4.启动服务</li>
</ul>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:~/logstash-</span><span class="number">5.2</span>.<span class="number">2</span>/bin<span class="variable">$ </span>./logstash -f /home/chu888chu888/logstash.conf</span><br></pre></td></tr></table></figure>
<ul>
<li>5.启动成功后的日志</li>
</ul>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888@hadoopmaster:~/logstash<span class="number">-5.2</span><span class="number">.2</span>/bin$ ./logstash -f /home/chu888chu888/logstash.conf</span><br><span class="line">Sending Logstash's logs to /home/chu888chu888/logstash<span class="number">-5.2</span><span class="number">.2</span>/logs which is now configured via log4j2.properties</span><br><span class="line">[<span class="number">2017</span><span class="number">-03</span><span class="number">-13</span>T15:<span class="number">25</span>:<span class="number">37</span>,<span class="number">977</span>][INFO ][logstash.outputs.elasticsearch] Elasticsearch pool URLs updated &#123;:changes=&gt;&#123;:removed=&gt;[], :added=&gt;[http://<span class="number">192.168</span><span class="number">.1</span><span class="number">.159</span>:<span class="number">9200</span>/]&#125;&#125;</span><br><span class="line">[<span class="number">2017</span><span class="number">-03</span><span class="number">-13</span>T15:<span class="number">25</span>:<span class="number">37</span>,<span class="number">979</span>][INFO ][logstash.outputs.elasticsearch] Running health check to see <span class="keyword">if</span> an Elasticsearch connection is working &#123;:healthcheck_url=&gt;http://<span class="number">192.168</span><span class="number">.1</span><span class="number">.159</span>:<span class="number">9200</span>/, :path=&gt;<span class="string">"/"</span>&#125;</span><br><span class="line">[<span class="number">2017</span><span class="number">-03</span><span class="number">-13</span>T15:<span class="number">25</span>:<span class="number">38</span>,<span class="number">173</span>][WARN ][logstash.outputs.elasticsearch] Restored connection to ES instance &#123;:url=&gt;#&lt;URI::HTTP:<span class="number">0x63e64c30</span> URL:http://<span class="number">192.168</span><span class="number">.1</span><span class="number">.159</span>:<span class="number">9200</span>/&gt;&#125;</span><br><span class="line">[<span class="number">2017</span><span class="number">-03</span><span class="number">-13</span>T15:<span class="number">25</span>:<span class="number">38</span>,<span class="number">178</span>][INFO ][logstash.outputs.elasticsearch] Using mapping template from &#123;:path=&gt;nil&#125;</span><br><span class="line">[<span class="number">2017</span><span class="number">-03</span><span class="number">-13</span>T15:<span class="number">25</span>:<span class="number">38</span>,<span class="number">288</span>][INFO ][logstash.outputs.elasticsearch] Attempting to install template &#123;:manage_template=&gt;&#123;<span class="string">"template"</span>=&gt;<span class="string">"logstash-*"</span>, <span class="string">"version"</span>=&gt;<span class="number">50001</span>, <span class="string">"settings"</span>=&gt;&#123;<span class="string">"index.refresh_interval"</span>=&gt;<span class="string">"5s"</span>&#125;, <span class="string">"mappings"</span>=&gt;&#123;<span class="string">"_default_"</span>=&gt;&#123;<span class="string">"_all"</span>=&gt;&#123;<span class="string">"enabled"</span>=&gt;true, <span class="string">"norms"</span>=&gt;false&#125;, <span class="string">"dynamic_templates"</span>=&gt;[&#123;<span class="string">"message_field"</span>=&gt;&#123;<span class="string">"path_match"</span>=&gt;<span class="string">"message"</span>, <span class="string">"match_mapping_type"</span>=&gt;<span class="string">"string"</span>, <span class="string">"mapping"</span>=&gt;&#123;<span class="string">"type"</span>=&gt;<span class="string">"text"</span>, <span class="string">"norms"</span>=&gt;false&#125;&#125;&#125;, &#123;<span class="string">"string_fields"</span>=&gt;&#123;<span class="string">"match"</span>=&gt;<span class="string">"*"</span>, <span class="string">"match_mapping_type"</span>=&gt;<span class="string">"string"</span>, <span class="string">"mapping"</span>=&gt;&#123;<span class="string">"type"</span>=&gt;<span class="string">"text"</span>, <span class="string">"norms"</span>=&gt;false, <span class="string">"fields"</span>=&gt;&#123;<span class="string">"keyword"</span>=&gt;&#123;<span class="string">"type"</span>=&gt;<span class="string">"keyword"</span>&#125;&#125;&#125;&#125;&#125;], <span class="string">"properties"</span>=&gt;&#123;<span class="string">"@timestamp"</span>=&gt;&#123;<span class="string">"type"</span>=&gt;<span class="string">"date"</span>, <span class="string">"include_in_all"</span>=&gt;false&#125;, <span class="string">"@version"</span>=&gt;&#123;<span class="string">"type"</span>=&gt;<span class="string">"keyword"</span>, <span class="string">"include_in_all"</span>=&gt;false&#125;, <span class="string">"geoip"</span>=&gt;&#123;<span class="string">"dynamic"</span>=&gt;true, <span class="string">"properties"</span>=&gt;&#123;<span class="string">"ip"</span>=&gt;&#123;<span class="string">"type"</span>=&gt;<span class="string">"ip"</span>&#125;, <span class="string">"location"</span>=&gt;&#123;<span class="string">"type"</span>=&gt;<span class="string">"geo_point"</span>&#125;, <span class="string">"latitude"</span>=&gt;&#123;<span class="string">"type"</span>=&gt;<span class="string">"half_float"</span>&#125;, <span class="string">"longitude"</span>=&gt;&#123;<span class="string">"type"</span>=&gt;<span class="string">"half_float"</span>&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;</span><br><span class="line">[<span class="number">2017</span><span class="number">-03</span><span class="number">-13</span>T15:<span class="number">25</span>:<span class="number">38</span>,<span class="number">315</span>][INFO ][logstash.outputs.elasticsearch] New Elasticsearch output &#123;:class=&gt;<span class="string">"LogStash::Outputs::ElasticSearch"</span>, :hosts=&gt;[#&lt;URI::Generic:<span class="number">0x2fc46ddb</span> URL://<span class="number">192.168</span><span class="number">.1</span><span class="number">.159</span>:<span class="number">9200</span>&gt;]&#125;</span><br><span class="line">[<span class="number">2017</span><span class="number">-03</span><span class="number">-13</span>T15:<span class="number">25</span>:<span class="number">38</span>,<span class="number">316</span>][INFO ][logstash.pipeline        ] Starting pipeline &#123;<span class="string">"id"</span>=&gt;<span class="string">"main"</span>, <span class="string">"pipeline.workers"</span>=&gt;<span class="number">1</span>, <span class="string">"pipeline.batch.size"</span>=&gt;<span class="number">125</span>, <span class="string">"pipeline.batch.delay"</span>=&gt;<span class="number">5</span>, <span class="string">"pipeline.max_inflight"</span>=&gt;<span class="number">125</span>&#125;</span><br><span class="line">[<span class="number">2017</span><span class="number">-03</span><span class="number">-13</span>T15:<span class="number">25</span>:<span class="number">38</span>,<span class="number">646</span>][INFO ][logstash.pipeline        ] Pipeline main started</span><br><span class="line">[<span class="number">2017</span><span class="number">-03</span><span class="number">-13</span>T15:<span class="number">25</span>:<span class="number">38</span>,<span class="number">742</span>][INFO ][logstash.agent           ] Successfully started Logstash API endpoint &#123;:port=&gt;<span class="number">9600</span>&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Kibana"><a href="#Kibana" class="headerlink" title="Kibana"></a>Kibana</h2><p>Kibana可以为Logstash和ElasticSearch提供的日志分析友好的Web界面，可以帮助您汇总、分析和搜索重要数据日志。</p>
<ol>
<li>解压进入目录</li>
</ol>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:~</span><span class="variable">$ </span>tar xvfz kibana-<span class="number">5.2</span>.<span class="number">2</span>-linux-x86_64.tar.gz</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>修改配置文件</li>
</ol>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano <span class="built_in">config</span>/kibana.yml</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>添加如下配置项</li>
</ol>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">server<span class="selector-class">.port</span>: <span class="number">5601</span></span><br><span class="line">server<span class="selector-class">.host</span>: <span class="string">"192.168.1.159"</span></span><br><span class="line">elasticsearch<span class="selector-class">.url</span>: <span class="string">"http://192.168.1.159:9200"</span></span><br><span class="line">kibana<span class="selector-class">.index</span>: <span class="string">".kibana"</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>启动服务</li>
</ol>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/bin/</span>kibana</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>启动成功日志如下</li>
</ol>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chu888chu888<span class="variable">@hadoopmaster</span><span class="symbol">:~/kibana-</span><span class="number">5.2</span>.<span class="number">2</span>-linux-x86_64/bin<span class="variable">$ </span>./kibana</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>浏览器访问</li>
</ol>
<p>默认第一次需要Configure an index pattern，默认的Index name是logstash-*，直接create就行了。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">1.159</span>:<span class="number">5601</span><span class="regexp">/app/</span>kibana<span class="comment">#/management/kibana/index/?_g=()</span></span><br></pre></td></tr></table></figure>
<p><img src="/img/hadoop/21/kibna.png" alt></p>

    </div>
    
    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="/" target="_blank">Ljjyy.com</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/archives/2019/07/100366.html" class="pre-post btn btn-default" title='大数据hadoop之 六十.数据采集与爬虫'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">大数据hadoop之 六十.数据采集与爬虫</span>
        </a>
    
    
        <a href="/archives/2019/07/100364.html" class="next-post btn btn-default" title='大数据hadoop之 五十八.Hue安装与配置'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">大数据hadoop之 五十八.Hue安装与配置</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
    <div id="vcomments" class="valine"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>

    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: '5MzTXYXkt03k101j0PmSDN34-gzGzoHsz',
            appKey: 'iwjYgwno6qj3wtDVVSbe8nYQ',
            placeholder: '说点什么吧',
            notify: false,
            verify: true,
            avatar: 'mm',
            meta: 'nick,mail'.split(','),
            pageSize: '10',
            path: window.location.pathname,
            lang: 'zh-CN'.toLowerCase()
        })
    </script>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#概述"><span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#环境要求"><span class="toc-text">环境要求:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装过程"><span class="toc-text">安装过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ElasticSearch插件"><span class="toc-text">ElasticSearch插件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ElasticSearch安装错误FAQ"><span class="toc-text">ElasticSearch安装错误FAQ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LogStash"><span class="toc-text">LogStash</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装"><span class="toc-text">安装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kibana"><span class="toc-text">Kibana</span></a></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2019-2023&emsp;<a href="/" class="copyright-links" target="_blank" rel="nofollow">Ljjyy.com</a>
                </span> |
                <span>
                    <a href="/about/" class="copyright-links" target="_blank" rel="nofollow">关于我们</a>
                </span> |                
                <span>
                    <a href="/sitemap.xml" class="copyright-links" target="_blank" rel="nofollow">网站地图</a>
                </span> |
                <span>
                    <a href="/archives/" class="copyright-links" target="_blank" rel="nofollow">时间轴</a>
                </span>              
            </div>
        </div>
    </div>
</div>







<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>