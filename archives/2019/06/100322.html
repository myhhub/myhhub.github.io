<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.2.3">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="https://www.ljjyy.com">
    <!--SEO-->

    <meta name="keywords" content="hadoop,hive">


    <meta name="description" content="一 安装环境
Hadoop 2.7.2
JDK 1.7 U79
Hive 2.1.0
Mysql(apt-get 安装)
192.168.1.166为Mysql server meta serv...">



<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">

    <!--Title-->


<title>大数据hadoop之 十六.Hive2.1.0的安装 | 来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</title>


    <link rel="alternate" href="/atom.xml" title="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
	<div class="hide">
        <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
        <script>LA.init({id: "JgbNOaw1xxsmUUsQ",ck: "JgbNOaw1xxsmUUsQ"})</script>
	</div>






    
    <meta name="baidu-site-verification" content="dTHILoORpx">


    <script>
        (function(){
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  >
    <div class="main-header-box">
        <!--a class="header-avatar" href="/" title='Ljjyy.com'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a-->
        <div class="branding">
            
                <h2> 多读书多实践，勤思考善领悟 </h2>
            
    	  </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">

        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="web-logo"  href="/" title='Ljjyy.com'></a>
                    <!--a class="navbar-brand" href="https://www.ljjyy.com">来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</a-->
                </div>
                <div class="collapse navbar-collapse" id="main-menu" style="">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/cloud/"><i class="fa "></i>云计算</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/front/"><i class="fa "></i>前端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/back/"><i class="fa "></i>后端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/devops/"><i class="fa "></i>运维</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/crack/"><i class="fa "></i>破解</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/penetration/"><i class="fa "></i>渗透</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/tool/"><i class="fa "></i>工具</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/other/"><i class="fa "></i>其他</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="大数据hadoop之 十六.Hive2.1.0的安装">
            
	            大数据hadoop之 十六.Hive2.1.0的安装
            
        </h1>
        <div class="post-meta">
    
        <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
            <a class="category-link" href="/categories/cloud/">云计算</a>
        </span>
    

    
        <span class="fa-wrap">
            <i class="fa fa-tags"></i>
            <span class="tags-meta">
                
                    <a class="tag-link" href="/tags/hadoop/">hadoop</a> <a class="tag-link" href="/tags/hive/">hive</a>
                
            </span>
        </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2019/06/14</span>
        </span>
        
    
</div>
            
            
            <p class="fa fa-exclamation-triangle warning">
                本文于<strong>1395</strong>天之前发表，文中内容可能已经过时。
            </p>
        
    </div>
    
    <div class="post-body post-content">
        <h2 id="一-安装环境"><a href="#一-安装环境" class="headerlink" title="一 安装环境"></a>一 安装环境</h2><ul>
<li>Hadoop 2.7.2</li>
<li>JDK 1.7 U79</li>
<li>Hive 2.1.0</li>
<li>Mysql(apt-get 安装)</li>
<li>192.168.1.166为Mysql server meta server安装位置</li>
<li>192.168.1.159为Hive数据仓库安装位置</li>
</ul>
<h2 id="二-Hive的安装-MySQL作为元数据库"><a href="#二-Hive的安装-MySQL作为元数据库" class="headerlink" title="二 Hive的安装-MySQL作为元数据库"></a>二 Hive的安装-MySQL作为元数据库</h2><ul>
<li>安装JDK-略过</li>
<li>安装Hadoop-略过</li>
<li>安装Mysql-略过</li>
</ul>
<h2 id="三-在192-168-1-166上建立Hive-meta数据库-用户-赋予权限"><a href="#三-在192-168-1-166上建立Hive-meta数据库-用户-赋予权限" class="headerlink" title="三 在192.168.1.166上建立Hive meta数据库,用户,赋予权限"></a>三 在192.168.1.166上建立Hive meta数据库,用户,赋予权限</h2><p><strong>mysql虚拟机的默认密码,在我做试验的时候是123456</strong></p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta"><span class="meta-keyword">$mysql</span> -u root -p</span></span><br><span class="line">mysql&gt;grant <span class="keyword">all</span> privileges on *.* to hive@<span class="string">"%"</span> identified by <span class="string">"hive"</span> with grant <span class="keyword">option</span>;</span><br><span class="line">mysql&gt;flush privileges;</span><br><span class="line">Mysql在Ubuntu中默认安装后,只能在本机访问,如果要开启远程访问,需要做以下两个步骤:</span><br><span class="line"><span class="meta"><span class="meta-keyword">$nano</span> /etc/mysql/my.cnf</span></span><br><span class="line"></span><br><span class="line">找到bind-address=<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> ,把这一行注释掉</span><br><span class="line"><span class="meta"><span class="meta-keyword">$service</span> mysql restart</span></span><br></pre></td></tr></table></figure>
<h2 id="四-在192-168-1-159上安装Hive"><a href="#四-在192-168-1-159上安装Hive" class="headerlink" title="四 在192.168.1.159上安装Hive"></a>四 在192.168.1.159上安装Hive</h2><h3 id="1-安装Hive"><a href="#1-安装Hive" class="headerlink" title="1 安装Hive"></a>1 安装Hive</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hadoop<span class="variable">@hadoopmaster</span><span class="symbol">:~</span><span class="variable">$ </span>sudo tar xvfz apache-hive-<span class="number">2.1</span>.<span class="number">0</span>-bin.tar.gz </span><br><span class="line">hadoop<span class="variable">@hadoopmaster</span><span class="symbol">:~</span><span class="variable">$ </span>sudo cp -R apache-hive-<span class="number">2.1</span>.<span class="number">0</span>-bin /usr/local/hive </span><br><span class="line">hadoop<span class="variable">@hadoopmaster</span><span class="symbol">:~</span><span class="variable">$ </span>sudo chmod -R <span class="number">775</span> /usr/local/hive/</span><br><span class="line">hadoop<span class="variable">@hadoopmaster</span><span class="symbol">:~</span><span class="variable">$ </span>sudo chown -R <span class="symbol">hadoop:</span>hadoop /usr/local/hive</span><br></pre></td></tr></table></figure>
<h3 id="2-修改-etc-profile加入HIVE-HOME的变量"><a href="#2-修改-etc-profile加入HIVE-HOME的变量" class="headerlink" title="2 修改/etc/profile加入HIVE_HOME的变量"></a>2 修改/etc/profile加入HIVE_HOME的变量</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">HIVE_HOME</span>=/usr/local/hive</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$HIVE_HOME/bin</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CLASSPATH</span>=.:$&#123;JAVA_HOME&#125;/lib:<span class="variable">$&#123;JRE_HOME&#125;</span>/lib:/usr/local/hive/lib</span><br><span class="line"><span class="variable">$source</span> /etc/profile</span><br></pre></td></tr></table></figure>
<h3 id="3-修改hive-conf下的几个template模板并重命名为其他"><a href="#3-修改hive-conf下的几个template模板并重命名为其他" class="headerlink" title="3 修改hive/conf下的几个template模板并重命名为其他"></a>3 修改hive/conf下的几个template模板并重命名为其他</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp hive-env<span class="selector-class">.sh</span><span class="selector-class">.template</span> hive-env.sh</span><br><span class="line">cp hive-default<span class="selector-class">.xml</span><span class="selector-class">.template</span> hive-site.xml</span><br></pre></td></tr></table></figure>
<p><strong>配置hive-env.sh文件，指定HADOOP_HOME</strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">HADOOP_HOME</span>=/usr/local/hadoop</span><br></pre></td></tr></table></figure>
<h3 id="4-修改hive-site-xml文件，指定MySQL数据库驱动、数据库名、用户名及密码，修改的内容如下所示"><a href="#4-修改hive-site-xml文件，指定MySQL数据库驱动、数据库名、用户名及密码，修改的内容如下所示" class="headerlink" title="4 修改hive-site.xml文件，指定MySQL数据库驱动、数据库名、用户名及密码，修改的内容如下所示"></a>4 修改hive-site.xml文件，指定MySQL数据库驱动、数据库名、用户名及密码，修改的内容如下所示</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax<span class="selector-class">.jdo</span><span class="selector-class">.option</span><span class="selector-class">.ConnectionURL</span>&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;jdbc:mysql:<span class="comment">//192.168.1.178:3306/hive?createDatabaseIfNotExist=true&lt;/value&gt;</span></span><br><span class="line">  &lt;description&gt;JDBC connect string <span class="keyword">for</span> <span class="selector-tag">a</span> JDBC metastore&lt;/description&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax<span class="selector-class">.jdo</span><span class="selector-class">.option</span><span class="selector-class">.ConnectionDriverName</span>&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;com<span class="selector-class">.mysql</span><span class="selector-class">.jdbc</span><span class="selector-class">.Driver</span>&lt;/value&gt;</span><br><span class="line">  &lt;description&gt;Driver class name <span class="keyword">for</span> <span class="selector-tag">a</span> JDBC metastore&lt;/description&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax<span class="selector-class">.jdo</span><span class="selector-class">.option</span><span class="selector-class">.ConnectionUserName</span>&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;hive&lt;/value&gt;</span><br><span class="line">  &lt;description&gt;username to use against metastore database&lt;/description&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax<span class="selector-class">.jdo</span><span class="selector-class">.option</span><span class="selector-class">.ConnectionPassword</span>&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;hive&lt;/value&gt;</span><br><span class="line">  &lt;description&gt;password to use against metastore database&lt;/description&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">其中：</span><br><span class="line">javax<span class="selector-class">.jdo</span><span class="selector-class">.option</span><span class="selector-class">.ConnectionURL</span>参数指定的是Hive连接数据库的连接字符串；</span><br><span class="line">javax<span class="selector-class">.jdo</span><span class="selector-class">.option</span><span class="selector-class">.ConnectionDriverName</span>参数指定的是驱动的类入口名称；</span><br><span class="line">javax<span class="selector-class">.jdo</span><span class="selector-class">.option</span><span class="selector-class">.ConnectionUserName</span>参数指定了数据库的用户名；</span><br><span class="line">javax<span class="selector-class">.jdo</span><span class="selector-class">.option</span><span class="selector-class">.ConnectionPassword</span>参数指定了数据库的密码。</span><br></pre></td></tr></table></figure>
<h3 id="5-缓存目录的问题-如果不配置也会出错的"><a href="#5-缓存目录的问题-如果不配置也会出错的" class="headerlink" title="5 缓存目录的问题,如果不配置也会出错的"></a>5 缓存目录的问题,如果不配置也会出错的</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">&lt;property&gt;</span> </span><br><span class="line"><span class="params">&lt;name&gt;</span>hive.exec.local.scratchdir<span class="params">&lt;/name&gt;</span></span><br><span class="line"><span class="params">&lt;value&gt;</span><span class="meta-keyword">/home/</span>hadoop/iotmp<span class="params">&lt;/value&gt;</span></span><br><span class="line"><span class="params">&lt;description&gt;</span>Local scratch space for Hive jobs<span class="params">&lt;/description&gt;</span></span><br><span class="line"><span class="params">&lt;/property&gt;</span></span><br><span class="line"><span class="params">&lt;property&gt;</span></span><br><span class="line"><span class="params">&lt;name&gt;</span>hive.downloaded.resources.dir<span class="params">&lt;/name&gt;</span></span><br><span class="line"><span class="params">&lt;value&gt;</span><span class="meta-keyword">/home/</span>hadoop/iotmp<span class="params">&lt;/value&gt;</span></span><br><span class="line"><span class="params">&lt;description&gt;</span>Temporary local directory for added resources in the remote file system.<span class="params">&lt;/description&gt;</span></span><br><span class="line"><span class="params">&lt;/property&gt;</span></span><br></pre></td></tr></table></figure>
<p>并且需要对目录进行权限设定<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /<span class="built_in">home</span>/hadoop/iotmp </span><br><span class="line">chmod -R <span class="number">775</span> /<span class="built_in">home</span>/hadoop/iotmp</span><br></pre></td></tr></table></figure></p>
<h2 id="五-修改hive-bin下的hive-config-sh文件，设置JAVA-HOME-HADOOP-HOME"><a href="#五-修改hive-bin下的hive-config-sh文件，设置JAVA-HOME-HADOOP-HOME" class="headerlink" title="五 修改hive/bin下的hive-config.sh文件，设置JAVA_HOME,HADOOP_HOME"></a>五 修改hive/bin下的hive-config.sh文件，设置JAVA_HOME,HADOOP_HOME</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/lib/jvm</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HADOOP_HOME</span>=/usr/local/hadoop</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HIVE_HOME</span>=/usr/local/hive</span><br></pre></td></tr></table></figure>
<h2 id="六-下载mysql-connector-java-5-1-27-bin-jar文件，并放到-HIVE-HOME-lib目录下"><a href="#六-下载mysql-connector-java-5-1-27-bin-jar文件，并放到-HIVE-HOME-lib目录下" class="headerlink" title="六 下载mysql-connector-java-5.1.27-bin.jar文件，并放到$HIVE_HOME/lib目录下"></a>六 下载mysql-connector-java-5.1.27-bin.jar文件，并放到$HIVE_HOME/lib目录下</h2><p><strong>可以从Mysql的官方网站下载,但是记得一定要解压呀,下载的是一个tar.gz文件</strong></p>
<h2 id="七-在HDFS中创建-tmp和-user-hive-warehouse并设置权限"><a href="#七-在HDFS中创建-tmp和-user-hive-warehouse并设置权限" class="headerlink" title="七 在HDFS中创建/tmp和/user/hive/warehouse并设置权限"></a>七 在HDFS中创建/tmp和/user/hive/warehouse并设置权限</h2><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hadoop <span class="built_in">fs</span> -<span class="built_in">mkdir</span> /tmp</span><br><span class="line">hadoop <span class="built_in">fs</span> -<span class="built_in">mkdir</span> -p /user/hive/warehouse</span><br><span class="line">hadoop <span class="built_in">fs</span> -chmod g+w /tmp</span><br><span class="line">hadoop <span class="built_in">fs</span> -chmod g+w /user/hive/warehouse</span><br></pre></td></tr></table></figure>
<h3 id="1-初始化meta数据库"><a href="#1-初始化meta数据库" class="headerlink" title="1. 初始化meta数据库"></a>1. 初始化meta数据库</h3><p>进入之前需要初始化数据库</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">schematool -initSchema -dbType mysql</span><br><span class="line"></span><br><span class="line">hadoop@<span class="symbol">hadoopmaster:</span>/usr/local/hive/<span class="class"><span class="keyword">lib</span>$ <span class="title">schematool</span> -<span class="title">initSchema</span> -<span class="title">dbType</span> <span class="title">mysql</span> </span></span><br><span class="line"><span class="symbol">SLF4J:</span> Class path contains multiple SLF4J bindings.</span><br><span class="line"><span class="symbol">SLF4J:</span> Found binding in [<span class="symbol">jar:</span><span class="symbol">file:</span>/usr/local/hive/<span class="class"><span class="keyword">lib</span>/<span class="title">log4j</span>-<span class="title">slf4j</span>-<span class="title">impl</span>-2.4.1.<span class="title">jar!</span>/<span class="title">org</span>/<span class="title">slf4j</span>/<span class="title">impl</span>/<span class="title">StaticLoggerBinder</span>.<span class="title">class</span>]</span></span><br><span class="line"><span class="symbol">SLF4J:</span> Found binding in [<span class="symbol">jar:</span><span class="symbol">file:</span>/usr/local/hadoop/share/hadoop/common/<span class="class"><span class="keyword">lib</span>/<span class="title">slf4j</span>-<span class="title">log4j12</span>-1.7.10.<span class="title">jar!</span>/<span class="title">org</span>/<span class="title">slf4j</span>/<span class="title">impl</span>/<span class="title">StaticLoggerBinder</span>.<span class="title">class</span>]</span></span><br><span class="line"><span class="symbol">SLF4J:</span> See <span class="symbol">http:</span>/<span class="regexp">/www.slf4j.org/codes</span>.html<span class="comment">#multiple_bindings for an explanation.</span></span><br><span class="line"><span class="symbol">SLF4J:</span> Actual binding is <span class="keyword">of</span> <span class="keyword">type</span> [org.apache.logging.slf4j.Log4jLoggerFactory]</span><br><span class="line">Metastore connection <span class="symbol">URL:</span> <span class="symbol">jdbc:</span><span class="symbol">mysql:</span>/<span class="regexp">/192.168.1.166:3306/hive</span>?createDatabaseIfNotExist=<span class="literal">true</span></span><br><span class="line">Metastore Connection Driver : com.mysql.jdbc.Driver</span><br><span class="line">Metastore connection <span class="symbol">User:</span> hive</span><br><span class="line">Starting metastore schema initialization to <span class="number">2.1</span>.<span class="number">0</span></span><br><span class="line">Initialization script hive-schema-<span class="number">2.1</span>.<span class="number">0</span>.mysql.sql</span><br><span class="line">Initialization script completed</span><br><span class="line">schemaTool completed</span><br></pre></td></tr></table></figure>
<h3 id="2-测试hive-shell"><a href="#2-测试hive-shell" class="headerlink" title="2. 测试hive shell"></a>2. 测试hive shell</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br></pre></td></tr></table></figure>
<h3 id="3-可以在hadoop中查看hive生产的文件"><a href="#3-可以在hadoop中查看hive生产的文件" class="headerlink" title="3. 可以在hadoop中查看hive生产的文件"></a>3. 可以在hadoop中查看hive生产的文件</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop dfs -ls <span class="regexp">/user/</span>hive<span class="regexp">/warehouse</span></span><br></pre></td></tr></table></figure>
<h2 id="七-Hive-shell使用实例"><a href="#七-Hive-shell使用实例" class="headerlink" title="七 Hive shell使用实例"></a>七 Hive shell使用实例</h2><p>在正式讲解HiveQL之前,先在命令行下运行几样命令是有好处的,可以感受一下HiveQL是如何工作的,也可以自已随便探索一下.</p>
<h3 id="1-创建数据-文本以tab分隔"><a href="#1-创建数据-文本以tab分隔" class="headerlink" title="1. 创建数据(文本以tab分隔)"></a>1. 创建数据(文本以tab分隔)</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">~ vi /home/cos/demo/t_hive.txt</span><br><span class="line"></span><br><span class="line"><span class="number">16</span>      <span class="number">2</span>       <span class="number">3</span></span><br><span class="line"><span class="number">61</span>      <span class="number">12</span>      <span class="number">13</span></span><br><span class="line"><span class="number">41</span>      <span class="number">2</span>       <span class="number">31</span></span><br><span class="line"><span class="number">17</span>      <span class="number">21</span>      <span class="number">3</span></span><br><span class="line"><span class="number">71</span>      <span class="number">2</span>       <span class="number">31</span></span><br><span class="line"><span class="number">1</span>       <span class="number">12</span>      <span class="number">34</span></span><br><span class="line"><span class="number">11</span>      <span class="number">2</span>       <span class="number">34</span></span><br></pre></td></tr></table></figure>
<h3 id="2-创建新表"><a href="#2-创建新表" class="headerlink" title="2. 创建新表"></a>2. 创建新表</h3><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; CREATE TABLE t_hive (a <span class="built_in">int</span>, b <span class="built_in">int</span>, c <span class="built_in">int</span>) <span class="built_in">ROW</span> FORMAT DELIMITED FIELDS TERMINATED BY '\t';</span><br><span class="line">OK</span><br><span class="line"><span class="built_in">Time</span> tak<span class="symbol">en:</span> <span class="number">0.121</span> seconds</span><br></pre></td></tr></table></figure>
<h3 id="3-导入数据t-hive-txt到t-hive表"><a href="#3-导入数据t-hive-txt到t-hive表" class="headerlink" title="3. 导入数据t_hive.txt到t_hive表"></a>3. 导入数据t_hive.txt到t_hive表</h3><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; LOAD DATA LOCAL INPATH <span class="string">'/tmp/t_hive.txt'</span> OVERWRITE INTO <span class="keyword">TABLE</span> t_hive ;</span><br><span class="line">Loading data to <span class="keyword">table</span> default.t_hive</span><br><span class="line">OK</span><br><span class="line">Time taken: <span class="number">0.609</span> seconds</span><br></pre></td></tr></table></figure>
<h3 id="4-查看表"><a href="#4-查看表" class="headerlink" title="4. 查看表"></a>4. 查看表</h3><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">show</span> tables;</span><br><span class="line">OK</span><br><span class="line">t_hive</span><br><span class="line"><span class="built_in">Time</span> taken: <span class="number">0.099</span> seconds</span><br></pre></td></tr></table></figure>
<h3 id="5-正则匹配表名"><a href="#5-正则匹配表名" class="headerlink" title="5. 正则匹配表名"></a>5. 正则匹配表名</h3><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt;show tables '*<span class="built_in">t</span>*';</span><br><span class="line">OK</span><br><span class="line">t_hive</span><br><span class="line"><span class="built_in">Time</span> tak<span class="symbol">en:</span> <span class="number">0.065</span> seconds</span><br></pre></td></tr></table></figure>
<h3 id="6-查看表数据"><a href="#6-查看表数据" class="headerlink" title="6. 查看表数据"></a>6. 查看表数据</h3><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select * from t_hive;</span><br><span class="line"><span class="symbol">OK</span></span><br><span class="line">16     <span class="number"> 2 </span>      3</span><br><span class="line">61     <span class="number"> 12 </span>     13</span><br><span class="line">41     <span class="number"> 2 </span>      31</span><br><span class="line">17     <span class="number"> 21 </span>     3</span><br><span class="line">71     <span class="number"> 2 </span>      31</span><br><span class="line">1      <span class="number"> 12 </span>     34</span><br><span class="line">11     <span class="number"> 2 </span>      34</span><br><span class="line">Time taken: 0.264 seconds</span><br></pre></td></tr></table></figure>
<h3 id="7-查看表结构"><a href="#7-查看表结构" class="headerlink" title="7. 查看表结构"></a>7. 查看表结构</h3><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">desc</span> t_hive;</span><br><span class="line">OK</span><br><span class="line">a       <span class="keyword">int</span></span><br><span class="line">b       <span class="keyword">int</span></span><br><span class="line">c       <span class="keyword">int</span></span><br><span class="line">Time taken: <span class="number">0.1</span> seconds</span><br></pre></td></tr></table></figure>
<h3 id="8-增加一个字段"><a href="#8-增加一个字段" class="headerlink" title="8. 增加一个字段"></a>8. 增加一个字段</h3><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; ALTER TABLE t_hive ADD COLUMNS (new_col <span class="built_in">String</span>);</span><br><span class="line">OK</span><br><span class="line"><span class="built_in">Time</span> taken: <span class="number">0.186</span> seconds</span><br><span class="line">hive&gt; desc t_hive;</span><br><span class="line">OK</span><br><span class="line">a       <span class="built_in">int</span></span><br><span class="line">b       <span class="built_in">int</span></span><br><span class="line">c       <span class="built_in">int</span></span><br><span class="line">new_col <span class="built_in">string</span></span><br><span class="line"><span class="built_in">Time</span> taken: <span class="number">0.086</span> seconds</span><br></pre></td></tr></table></figure>
<h3 id="9-重命令表名"><a href="#9-重命令表名" class="headerlink" title="9. 重命令表名"></a>9. 重命令表名</h3><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">~ ALTER <span class="keyword">TABLE</span> t_hive <span class="comment">RENAME TO t_hadoop</span>;</span><br><span class="line">OK</span><br><span class="line">Time taken: <span class="number">0.45</span> seconds</span><br><span class="line">hive&gt; show tables;</span><br><span class="line">OK</span><br><span class="line">t_hadoop</span><br><span class="line">Time taken: <span class="number">0.07</span> seconds</span><br></pre></td></tr></table></figure>
<h3 id="10-删除表"><a href="#10-删除表" class="headerlink" title="10. 删除表"></a>10. 删除表</h3><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="built_in">DROP</span> TABLE t_hadoop;</span><br><span class="line">OK</span><br><span class="line"><span class="built_in">Time</span> taken: <span class="number">0.767</span> seconds</span><br><span class="line"></span><br><span class="line">hive&gt; <span class="keyword">show</span> tables;</span><br><span class="line">OK</span><br><span class="line"><span class="built_in">Time</span> taken: <span class="number">0.064</span> seconds</span><br></pre></td></tr></table></figure>
<h2 id="八-使用beeline"><a href="#八-使用beeline" class="headerlink" title="八 使用beeline"></a>八 使用beeline</h2><p>HiveServer2提供了一个新的命令行工具Beeline，它是基于SQLLine CLI的JDBC客户端。<br>关于SQLLine的的知识，可以参考这个网站：<a href="http://sqlline.sourceforge.net/#manual" target="_blank" rel="noopener">http://sqlline.sourceforge.net/#manual</a></p>
<p>Beeline工作模式有两种，即本地嵌入模式和远程模式。嵌入模式情况下，它返回一个嵌入式的Hive（类似于Hive CLI）。而远程模式则是通过Thrift协议与某个单独的HiveServer2进程进行连接通信。下面给一个简单的登录Beeline的使用实例：</p>
<h3 id="1-首先把驱动拷贝到Lib中"><a href="#1-首先把驱动拷贝到Lib中" class="headerlink" title="1. 首先把驱动拷贝到Lib中"></a>1. 首先把驱动拷贝到Lib中</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp jdbc/hive-jdbc-<span class="number">2.1</span>.<span class="number">0</span>-standalone.jar /usr/local/hive/<span class="class"><span class="keyword">lib</span>/</span></span><br></pre></td></tr></table></figure>
<h3 id="2-启动hiveserver2的服务"><a href="#2-启动hiveserver2的服务" class="headerlink" title="2. 启动hiveserver2的服务"></a>2. 启动hiveserver2的服务</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">命令行模式:</span><br><span class="line"></span><br><span class="line">hive --service hiveserver2 --hiveconf hive<span class="selector-class">.server2</span><span class="selector-class">.thrift</span><span class="selector-class">.port</span>=<span class="number">10001</span></span><br><span class="line"></span><br><span class="line">服务模式：</span><br><span class="line"></span><br><span class="line">hiveserver2 start</span><br></pre></td></tr></table></figure>
<h3 id="3-执行操作"><a href="#3-执行操作" class="headerlink" title="3. 执行操作"></a>3. 执行操作</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">% bin/beeline</span><br><span class="line">Hive version 0.11.0-SNAPSHOT by Apache</span><br><span class="line">beeline&gt; !connect jdbc:hive2://localhost:10000/default </span><br><span class="line">!connect jdbc:hive2://localhost:10000/default </span><br><span class="line">Connecting to jdbc:hive2://localhost:10000/default</span><br><span class="line">Connected to: Hive (version 0.10.0)</span><br><span class="line">Driver: Hive (version 0.10.0-SNAPSHOT)</span><br><span class="line">Transaction isolation: TRANSACTION<span class="emphasis">_REPEATABLE_</span>READ</span><br><span class="line">0: jdbc:hive2://localhost:10000&gt; show tables;</span><br><span class="line">show tables;</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">|     tab<span class="emphasis">_name      |</span></span><br><span class="line"><span class="emphasis">+-------------------+</span></span><br><span class="line"><span class="emphasis">| primitives        |</span></span><br><span class="line"><span class="emphasis">| src               |</span></span><br><span class="line"><span class="emphasis">| src1              |</span></span><br><span class="line"><span class="emphasis">| src_</span>json          |</span><br><span class="line">| src<span class="emphasis">_sequencefile  |</span></span><br><span class="line"><span class="emphasis">| src_</span>thrift        |</span><br><span class="line">| srcbucket         |</span><br><span class="line">| srcbucket2        |</span><br><span class="line">| srcpart           |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">9 rows selected (1.079 seconds)</span><br></pre></td></tr></table></figure>
<h2 id="九-FAQ"><a href="#九-FAQ" class="headerlink" title="九 FAQ"></a>九 FAQ</h2><h3 id="出错信息1"><a href="#出错信息1" class="headerlink" title="出错信息1"></a>出错信息1</h3><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">hadoop@hadoopmaster:/usr/local/hive/conf$ hive </span><br><span class="line">SLF4J: Class path contains multiple SLF4J bindings.</span><br><span class="line">SLF4J: Found binding <span class="keyword">in</span> [jar:file:/usr/local/hive/lib/log4j-slf4j-impl-<span class="number">2.4</span>.<span class="number">1</span>.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span><br><span class="line">SLF4J: Found binding <span class="keyword">in</span> [jar:file:/usr/local/hadoop/share/hadoop/common/lib/slf4j-log4j12-<span class="number">1.7</span>.<span class="number">10</span>.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span><br><span class="line">SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings <span class="keyword">for</span> an explanation.</span><br><span class="line">SLF4J: Actual binding <span class="keyword">is</span> <span class="keyword">of</span> <span class="keyword">type</span> <span class="type">[org.apache.logging.slf4j.Log4jLoggerFactory]</span></span><br><span class="line"><span class="type"></span></span><br><span class="line"><span class="type">Logging </span>initialized using configuration <span class="keyword">in</span> jar:file:/usr/local/hive/lib/hive-common-<span class="number">2.1</span>.<span class="number">0</span>.jar!/hive-log4j2.properties Async: <span class="literal">true</span></span><br><span class="line"><span class="keyword">Exception</span> <span class="keyword">in</span> thread <span class="string">"main"</span> java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: org.apache.hadoop.hive.ql.metadata.HiveException: MetaException(message:Hive metastore database <span class="keyword">is</span> <span class="keyword">not</span> initialized. Please <span class="keyword">use</span> schematool (e.g. ./schematool -initSchema -dbType ...) to create the schema. <span class="keyword">If</span> needed, don<span class="symbol">'t</span> forget to include the option to auto-create the underlying database <span class="keyword">in</span> your JDBC connection string (e.g. ?createDatabaseIfNotExist=<span class="literal">true</span> <span class="keyword">for</span> mysql))</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:<span class="number">578</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.session.SessionState.beginStart(SessionState.java:<span class="number">518</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:<span class="number">705</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:<span class="number">641</span>)</span><br><span class="line"> <span class="keyword">at</span> sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line"> <span class="keyword">at</span> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:<span class="number">57</span>)</span><br><span class="line"> <span class="keyword">at</span> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class="number">43</span>)</span><br><span class="line"> <span class="keyword">at</span> java.lang.reflect.Method.invoke(Method.java:<span class="number">606</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.util.RunJar.run(RunJar.java:<span class="number">221</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.util.RunJar.main(RunJar.java:<span class="number">136</span>)</span><br><span class="line">Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: org.apache.hadoop.hive.ql.metadata.HiveException: MetaException(message:Hive metastore database <span class="keyword">is</span> <span class="keyword">not</span> initialized. Please <span class="keyword">use</span> schematool (e.g. ./schematool -initSchema -dbType ...) to create the schema. <span class="keyword">If</span> needed, don<span class="symbol">'t</span> forget to include the option to auto-create the underlying database <span class="keyword">in</span> your JDBC connection string (e.g. ?createDatabaseIfNotExist=<span class="literal">true</span> <span class="keyword">for</span> mysql))</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:<span class="number">226</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.metadata.Hive.&lt;init&gt;(Hive.java:<span class="number">366</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:<span class="number">310</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:<span class="number">290</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:<span class="number">266</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:<span class="number">545</span>)</span><br><span class="line"> ... <span class="number">9</span> more</span><br><span class="line">Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: MetaException(message:Hive metastore database <span class="keyword">is</span> <span class="keyword">not</span> initialized. Please <span class="keyword">use</span> schematool (e.g. ./schematool -initSchema -dbType ...) to create the schema. <span class="keyword">If</span> needed, don<span class="symbol">'t</span> forget to include the option to auto-create the underlying database <span class="keyword">in</span> your JDBC connection string (e.g. ?createDatabaseIfNotExist=<span class="literal">true</span> <span class="keyword">for</span> mysql))</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:<span class="number">3593</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:<span class="number">236</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:<span class="number">221</span>)</span><br><span class="line"> ... <span class="number">14</span> more</span><br><span class="line">Caused by: MetaException(message:Hive metastore database <span class="keyword">is</span> <span class="keyword">not</span> initialized. Please <span class="keyword">use</span> schematool (e.g. ./schematool -initSchema -dbType ...) to create the schema. <span class="keyword">If</span> needed, don<span class="symbol">'t</span> forget to include the option to auto-create the underlying database <span class="keyword">in</span> your JDBC connection string (e.g. ?createDatabaseIfNotExist=<span class="literal">true</span> <span class="keyword">for</span> mysql))</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:<span class="number">3364</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:<span class="number">3336</span>)</span><br><span class="line"> <span class="keyword">at</span> org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:<span class="number">3590</span>)</span><br><span class="line"> ... <span class="number">16</span> more</span><br></pre></td></tr></table></figure>
<p><strong>没有执行</strong></p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">schematool -initSchema -dbType mysql</span></span><br></pre></td></tr></table></figure>
<p>执行之后搞定</p>
<h3 id="出错信息2"><a href="#出错信息2" class="headerlink" title="出错信息2"></a>出错信息2</h3><figure class="highlight roboconf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> hadoop@hadoopmaster:/usr/local/hive/lib$ hive </span><br><span class="line">SLF4J: Class path contains multiple SLF4J bindings.</span><br><span class="line">SLF4J: Found binding in [jar:file:/usr/local/hive/lib/log4j-slf4j-impl-2.4.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span><br><span class="line">SLF4J: Found binding in [jar:file:/usr/local/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span><br><span class="line">SLF4J: See http://www.slf4j.org/codes.html<span class="comment">#multiple_bindings for an explanation.</span></span><br><span class="line">SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]</span><br><span class="line"></span><br><span class="line">Logging initialized using configuration in jar:file:/usr/local/hive/lib/hive-common-2.1.0.jar!/hive-log4j2.properties Async: true</span><br><span class="line">Exception in thread "main" java.lang.IllegalArgumentException: java.net.URISyntaxException: Relative path in absolute URI: $&#123;<span class="attribute">system</span>:java<span class="variable">.io</span><span class="variable">.tmpdir</span>%7D/$%7Bsystem:user<span class="variable">.name</span>%7D</span><br><span class="line"> at org<span class="variable">.apache</span><span class="variable">.hadoop</span><span class="variable">.fs</span><span class="variable">.Path</span><span class="variable">.initialize</span>(Path<span class="variable">.java</span>:205)</span><br><span class="line"> at org<span class="variable">.apache</span><span class="variable">.hadoop</span><span class="variable">.fs</span><span class="variable">.Path</span>.&lt;init&gt;(Path<span class="variable">.java</span>:171)</span><br><span class="line"> at org<span class="variable">.apache</span><span class="variable">.hadoop</span><span class="variable">.hive</span><span class="variable">.ql</span><span class="variable">.session</span><span class="variable">.SessionState</span><span class="variable">.createSessionDirs</span>(SessionState<span class="variable">.java</span>:631)</span><br><span class="line"> at org<span class="variable">.apache</span><span class="variable">.hadoop</span><span class="variable">.hive</span><span class="variable">.ql</span><span class="variable">.session</span><span class="variable">.SessionState</span><span class="variable">.start</span>(SessionState<span class="variable">.java</span>:550)</span><br><span class="line"> at org<span class="variable">.apache</span><span class="variable">.hadoop</span><span class="variable">.hive</span><span class="variable">.ql</span><span class="variable">.session</span><span class="variable">.SessionState</span><span class="variable">.beginStart</span>(SessionState<span class="variable">.java</span>:518)</span><br><span class="line"> at org<span class="variable">.apache</span><span class="variable">.hadoop</span><span class="variable">.hive</span><span class="variable">.cli</span><span class="variable">.CliDriver</span><span class="variable">.run</span>(CliDriver<span class="variable">.java</span>:705)</span><br><span class="line"> at org<span class="variable">.apache</span><span class="variable">.hadoop</span><span class="variable">.hive</span><span class="variable">.cli</span><span class="variable">.CliDriver</span><span class="variable">.main</span>(CliDriver<span class="variable">.java</span>:641)</span><br><span class="line"> at sun<span class="variable">.reflect</span><span class="variable">.NativeMethodAccessorImpl</span><span class="variable">.invoke</span>0(Native Method)</span><br><span class="line"> at sun<span class="variable">.reflect</span><span class="variable">.NativeMethodAccessorImpl</span><span class="variable">.invoke</span>(NativeMethodAccessorImpl<span class="variable">.java</span>:57)</span><br><span class="line"> at sun<span class="variable">.reflect</span><span class="variable">.DelegatingMethodAccessorImpl</span><span class="variable">.invoke</span>(DelegatingMethodAccessorImpl<span class="variable">.java</span>:43)</span><br><span class="line"> at java<span class="variable">.lang</span><span class="variable">.reflect</span><span class="variable">.Method</span><span class="variable">.invoke</span>(Method<span class="variable">.java</span>:606)</span><br><span class="line"> at org<span class="variable">.apache</span><span class="variable">.hadoop</span><span class="variable">.util</span><span class="variable">.RunJar</span><span class="variable">.run</span>(RunJar<span class="variable">.java</span>:221)</span><br><span class="line"> at org<span class="variable">.apache</span><span class="variable">.hadoop</span><span class="variable">.util</span><span class="variable">.RunJar</span><span class="variable">.main</span>(RunJar<span class="variable">.java</span>:136)</span><br><span class="line">Caused by: java<span class="variable">.net</span><span class="variable">.URISyntaxException</span>: Relative path in absolute URI: $&#123;system:java<span class="variable">.io</span><span class="variable">.tmpdir</span>%7D/$%7Bsystem:user<span class="variable">.name</span>%7D</span><br><span class="line"> at java<span class="variable">.net</span><span class="variable">.URI</span><span class="variable">.checkPath</span>(URI<span class="variable">.java</span>:1804)</span><br><span class="line"> at java<span class="variable">.net</span><span class="variable">.URI</span>.&lt;init&gt;(URI<span class="variable">.java</span>:752)</span><br><span class="line"> at org<span class="variable">.apache</span><span class="variable">.hadoop</span><span class="variable">.fs</span><span class="variable">.Path</span><span class="variable">.initialize</span>(Path<span class="variable">.java</span>:202)</span><br><span class="line"> ... 12 more</span><br></pre></td></tr></table></figure>
<p><strong>hive-site.xml中没有配置合理临时目录的问题</strong></p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">&lt;property&gt;</span> </span><br><span class="line"><span class="params">&lt;name&gt;</span>hive.exec.local.scratchdir<span class="params">&lt;/name&gt;</span></span><br><span class="line"><span class="params">&lt;value&gt;</span><span class="meta-keyword">/home/</span>hadoop/iotmp<span class="params">&lt;/value&gt;</span></span><br><span class="line"><span class="params">&lt;description&gt;</span>Local scratch space for Hive jobs<span class="params">&lt;/description&gt;</span></span><br><span class="line"><span class="params">&lt;/property&gt;</span></span><br><span class="line"><span class="params">&lt;property&gt;</span></span><br><span class="line"><span class="params">&lt;name&gt;</span>hive.downloaded.resources.dir<span class="params">&lt;/name&gt;</span></span><br><span class="line"><span class="params">&lt;value&gt;</span><span class="meta-keyword">/home/</span>hadoop/iotmp<span class="params">&lt;/value&gt;</span></span><br><span class="line"><span class="params">&lt;description&gt;</span>Temporary local directory for added resources in the remote file system.<span class="params">&lt;/description&gt;</span></span><br><span class="line"><span class="params">&lt;/property&gt;</span></span><br><span class="line"><span class="params">&lt;property&gt;</span></span><br></pre></td></tr></table></figure>
<p>并且需要对目录进行权限设定</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /<span class="built_in">home</span>/hadoop/iotmp</span><br><span class="line">chmod -R <span class="number">775</span> /<span class="built_in">home</span>/hadoop/iotmp</span><br></pre></td></tr></table></figure>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ul>
<li><a href="http://blog.csdn.net/zwx19921215/article/details/42776589" target="_blank" rel="noopener">出错信息解决</a></li>
<li><a href="http://blog.csdn.net/lnho2015/article/details/51307438" target="_blank" rel="noopener">配置参考</a></li>
<li><a href="http://blog.csdn.net/lnho2015/article/details/51355511" target="_blank" rel="noopener">配置参考</a></li>
<li><a href="http://blog.csdn.net/zwx19921215/article/details/42776589" target="_blank" rel="noopener">出错信息解决</a></li>
</ul>

    </div>
    
    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="/" target="_blank">Ljjyy.com</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/archives/2019/06/100323.html" class="pre-post btn btn-default" title='大数据hadoop之 十七.Hive的数据导入导出'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">大数据hadoop之 十七.Hive的数据导入导出</span>
        </a>
    
    
        <a href="/archives/2019/06/100321.html" class="next-post btn btn-default" title='大数据hadoop之 十五.Hive1.1.1的安装'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">大数据hadoop之 十五.Hive1.1.1的安装</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
    <div id="vcomments" class="valine"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>

    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: '5MzTXYXkt03k101j0PmSDN34-gzGzoHsz',
            appKey: 'iwjYgwno6qj3wtDVVSbe8nYQ',
            placeholder: '说点什么吧',
            notify: false,
            verify: true,
            avatar: 'mm',
            meta: 'nick,mail'.split(','),
            pageSize: '10',
            path: window.location.pathname,
            lang: 'zh-CN'.toLowerCase()
        })
    </script>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一-安装环境"><span class="toc-text">一 安装环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二-Hive的安装-MySQL作为元数据库"><span class="toc-text">二 Hive的安装-MySQL作为元数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三-在192-168-1-166上建立Hive-meta数据库-用户-赋予权限"><span class="toc-text">三 在192.168.1.166上建立Hive meta数据库,用户,赋予权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四-在192-168-1-159上安装Hive"><span class="toc-text">四 在192.168.1.159上安装Hive</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-安装Hive"><span class="toc-text">1 安装Hive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-修改-etc-profile加入HIVE-HOME的变量"><span class="toc-text">2 修改/etc/profile加入HIVE_HOME的变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-修改hive-conf下的几个template模板并重命名为其他"><span class="toc-text">3 修改hive/conf下的几个template模板并重命名为其他</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-修改hive-site-xml文件，指定MySQL数据库驱动、数据库名、用户名及密码，修改的内容如下所示"><span class="toc-text">4 修改hive-site.xml文件，指定MySQL数据库驱动、数据库名、用户名及密码，修改的内容如下所示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-缓存目录的问题-如果不配置也会出错的"><span class="toc-text">5 缓存目录的问题,如果不配置也会出错的</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五-修改hive-bin下的hive-config-sh文件，设置JAVA-HOME-HADOOP-HOME"><span class="toc-text">五 修改hive/bin下的hive-config.sh文件，设置JAVA_HOME,HADOOP_HOME</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六-下载mysql-connector-java-5-1-27-bin-jar文件，并放到-HIVE-HOME-lib目录下"><span class="toc-text">六 下载mysql-connector-java-5.1.27-bin.jar文件，并放到$HIVE_HOME/lib目录下</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#七-在HDFS中创建-tmp和-user-hive-warehouse并设置权限"><span class="toc-text">七 在HDFS中创建/tmp和/user/hive/warehouse并设置权限</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-初始化meta数据库"><span class="toc-text">1. 初始化meta数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-测试hive-shell"><span class="toc-text">2. 测试hive shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-可以在hadoop中查看hive生产的文件"><span class="toc-text">3. 可以在hadoop中查看hive生产的文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#七-Hive-shell使用实例"><span class="toc-text">七 Hive shell使用实例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-创建数据-文本以tab分隔"><span class="toc-text">1. 创建数据(文本以tab分隔)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-创建新表"><span class="toc-text">2. 创建新表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-导入数据t-hive-txt到t-hive表"><span class="toc-text">3. 导入数据t_hive.txt到t_hive表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-查看表"><span class="toc-text">4. 查看表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-正则匹配表名"><span class="toc-text">5. 正则匹配表名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-查看表数据"><span class="toc-text">6. 查看表数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-查看表结构"><span class="toc-text">7. 查看表结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-增加一个字段"><span class="toc-text">8. 增加一个字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-重命令表名"><span class="toc-text">9. 重命令表名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-删除表"><span class="toc-text">10. 删除表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#八-使用beeline"><span class="toc-text">八 使用beeline</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-首先把驱动拷贝到Lib中"><span class="toc-text">1. 首先把驱动拷贝到Lib中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-启动hiveserver2的服务"><span class="toc-text">2. 启动hiveserver2的服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-执行操作"><span class="toc-text">3. 执行操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#九-FAQ"><span class="toc-text">九 FAQ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#出错信息1"><span class="toc-text">出错信息1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#出错信息2"><span class="toc-text">出错信息2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文档"><span class="toc-text">参考文档</span></a></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2019-2023&emsp;<a href="/" class="copyright-links" target="_blank" rel="nofollow">Ljjyy.com</a>
                </span> |
                <span>
                    <a href="/about/" class="copyright-links" target="_blank" rel="nofollow">关于我们</a>
                </span> |                
                <span>
                    <a href="/sitemap.xml" class="copyright-links" target="_blank" rel="nofollow">网站地图</a>
                </span> |
                <span>
                    <a href="/archives/" class="copyright-links" target="_blank" rel="nofollow">时间轴</a>
                </span>              
            </div>
        </div>
    </div>
</div>







<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>