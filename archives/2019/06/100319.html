<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.2.3">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="https://www.ljjyy.com">
    <!--SEO-->

    <meta name="keywords" content="hadoop,ambari">


    <meta name="description" content="Ambari简介Ambari概述Apache Ambari是一种基于Web的工具，支持Apache Hadoop集群的创建、管理和监控。Ambari已支持大多数Hadoop组件，Hadoop 整...">



<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">

    <!--Title-->


<title>大数据hadoop之 十三.Ambari集群管理 | 来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</title>


    <link rel="alternate" href="/atom.xml" title="来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
	<div class="hide">
        <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
        <script>LA.init({id: "JgbNOaw1xxsmUUsQ",ck: "JgbNOaw1xxsmUUsQ"})</script>
	</div>






    
    <meta name="baidu-site-verification" content="dTHILoORpx">


    <script>
        (function(){
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  >
    <div class="main-header-box">
        <!--a class="header-avatar" href="/" title='Ljjyy.com'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a-->
        <div class="branding">
            
                <h2> 多读书多实践，勤思考善领悟 </h2>
            
    	  </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">

        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="web-logo"  href="/" title='Ljjyy.com'></a>
                    <!--a class="navbar-brand" href="https://www.ljjyy.com">来唧唧歪歪(Ljjyy.com) - 多读书多实践，勤思考善领悟</a-->
                </div>
                <div class="collapse navbar-collapse" id="main-menu" style="">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/cloud/"><i class="fa "></i>云计算</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/front/"><i class="fa "></i>前端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/back/"><i class="fa "></i>后端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/devops/"><i class="fa "></i>运维</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/crack/"><i class="fa "></i>破解</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/penetration/"><i class="fa "></i>渗透</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/tool/"><i class="fa "></i>工具</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/other/"><i class="fa "></i>其他</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="大数据hadoop之 十三.Ambari集群管理">
            
	            大数据hadoop之 十三.Ambari集群管理
            
        </h1>
        <div class="post-meta">
    
        <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
            <a class="category-link" href="/categories/cloud/">云计算</a>
        </span>
    

    
        <span class="fa-wrap">
            <i class="fa fa-tags"></i>
            <span class="tags-meta">
                
                    <a class="tag-link" href="/tags/ambari/">ambari</a> <a class="tag-link" href="/tags/hadoop/">hadoop</a>
                
            </span>
        </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2019/06/12</span>
        </span>
        
    
</div>
            
            
            <p class="fa fa-exclamation-triangle warning">
                本文于<strong>1406</strong>天之前发表，文中内容可能已经过时。
            </p>
        
    </div>
    
    <div class="post-body post-content">
        <h1 id="Ambari简介"><a href="#Ambari简介" class="headerlink" title="Ambari简介"></a>Ambari简介</h1><h2 id="Ambari概述"><a href="#Ambari概述" class="headerlink" title="Ambari概述"></a>Ambari概述</h2><p>Apache Ambari是一种基于Web的工具，支持Apache Hadoop集群的创建、管理和监控。Ambari已支持大多数Hadoop组件，Hadoop 整个生态圈包括HDFS、MapReduce、Hive、Pig、 Hbase、Zookeeper、Sqoop和Hcatalog等；除此之外，Ambari还支持Spark、Storm等计算框架及资源调度平台YARN。</p>
<p>Apache Ambari 从集群节点和服务收集大量信息，并把它们表现为容易使用的，集中化的接口：Ambari Web.</p>
<p>Ambari Web显示诸如服务特定的摘要、图表以及警报信息。可通过Ambari Web对Hadoop集群进行创建、管理、监视、添加主机、更新服务配置等；也可以利用Ambari Web执行集群管理任务，例如启用 Kerberos 安全以及执行Stack升级。任何用户都可以查看Ambari Web特性。拥有administrator-level 角色的用户可以访问比 operator-level 或 view-only 的用户能访问的更多选项。例如，Ambari administrator 可以管理集群安全，一个 operator 用户可以监控集群，而 view-only 用户只能访问系统管理员授予他的必要的权限。<br>Ambari提供了对Hadoop更加方便快捷的管理功能，主要包含：</p>
<ul>
<li>通过一步一步的安装向导简化了集群供应。</li>
<li>预先配置好关键的运维指标（metrics），可以直接查看Hadoop Core（HDFS和MapReduce）及相关项目（如HBase、Hive和HCatalog）是否健康。</li>
<li>支持作业与任务执行的可视化与分析，能够更好地查看依赖和性能。</li>
<li>通过一个完整的RESTful API把监控信息暴露出来，集成了现有的运维工具。</li>
<li>用户界面非常直观，用户可以轻松有效地查看信息并控制集群。</li>
</ul>
<h2 id="Ambari体系结构"><a href="#Ambari体系结构" class="headerlink" title="Ambari体系结构"></a>Ambari体系结构</h2><p>Ambari 自身也是一个分布式架构的软件，主要由两部分组成：Ambari Server 和 Ambari Agent。简单来说，用户通过Ambari Server通知 Ambari Agent 安装对应的软件；Agent 会定时地发送各个机器每个软件模块的状态给 Ambari Server，最终这些状态信息会呈现在 Ambari 的 GUI，方便用户了解到集群的各种状态，并进行相应的维护。</p>
<p>Ambari Server 从整个集群上收集信息。每个主机上都有 Ambari Agent, Ambari Server 通过 Ambari Agent 控制每部主机。</p>
<h1 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h1><h2 id="一、配置说明"><a href="#一、配置说明" class="headerlink" title="一、配置说明"></a>一、配置说明</h2><ol>
<li>硬件环境</li>
</ol>
<table>
<thead>
<tr>
<th>节点类型</th>
<th>操作系统</th>
<th>ip地址</th>
<th>主机名</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>主节点</td>
<td>Centos-7</td>
<td>192.168.162.41</td>
<td>node1.ambari.com</td>
<td>内存：8G+</td>
</tr>
<tr>
<td>从节点</td>
<td>Centos-7</td>
<td>192.168.162.42</td>
<td>node2.ambari.com</td>
<td>内存：8G+</td>
</tr>
<tr>
<td>从节点</td>
<td>Centos-7</td>
<td>192.168.162.43</td>
<td>node3.ambari.com</td>
<td>内存：8G+</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>软件环境</li>
</ol>
<table>
<thead>
<tr>
<th>软件名称</th>
<th>版本号</th>
</tr>
</thead>
<tbody>
<tr>
<td>JDK</td>
<td>jdk1.8.0_151</td>
</tr>
<tr>
<td>Mysql</td>
<td>5.7.23</td>
</tr>
<tr>
<td>Ambari</td>
<td>2.7.1</td>
</tr>
<tr>
<td>HDP</td>
<td>3.0.1</td>
</tr>
</tbody>
</table>
<h2 id="二、修改主机名和hosts文件"><a href="#二、修改主机名和hosts文件" class="headerlink" title="二、修改主机名和hosts文件"></a>二、修改主机名和hosts文件</h2><h3 id="1-修改主机名（三台主机都执行）"><a href="#1-修改主机名（三台主机都执行）" class="headerlink" title="1. 修改主机名（三台主机都执行）"></a>1. 修改主机名（三台主机都执行）</h3><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">vim </span>/<span class="string">etc/</span><span class="string">hostname </span>  *<span class="comment"># 该命令需要重启后生效*</span></span><br><span class="line">*<span class="comment"># 还有另外一种方式，执行该命令后立即生效，只不过需要重启Xshell连接*</span></span><br><span class="line"><span class="string">hostnamectl </span><span class="built_in">set-hostname</span> <span class="string">node1.</span><span class="string">ambari.</span><span class="string">com</span></span><br></pre></td></tr></table></figure>
<h3 id="2-修改hosts文件"><a href="#2-修改hosts文件" class="headerlink" title="2. 修改hosts文件"></a>2. 修改hosts文件</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="regexp">/etc/</span>hosts</span><br></pre></td></tr></table></figure>
<h2 id="三、关闭防火墙和selinux"><a href="#三、关闭防火墙和selinux" class="headerlink" title="三、关闭防火墙和selinux"></a>三、关闭防火墙和selinux</h2><h3 id="1-防火墙设置"><a href="#1-防火墙设置" class="headerlink" title="1. 防火墙设置"></a>1. 防火墙设置</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看防火墙状态</span></span><br><span class="line">systemctl status firewalld</span><br><span class="line"><span class="comment"># 查看开机是否启动防火墙服务</span></span><br><span class="line">systemctl is-enabled firewalld</span><br><span class="line"><span class="comment"># 关闭防火墙</span></span><br><span class="line">systemctl <span class="keyword">stop</span> firewalld</span><br><span class="line">systemctl <span class="keyword">disable</span> firewalld</span><br><span class="line"><span class="comment"># 再次查看防火墙状态和开机防火墙是否启动</span></span><br><span class="line">systemctl <span class="keyword">status</span> firewalld</span><br><span class="line">systemctl <span class="keyword">is</span>-enabled firewalld</span><br></pre></td></tr></table></figure>
<h3 id="2-禁用selinux"><a href="#2-禁用selinux" class="headerlink" title="2. 禁用selinux"></a>2. 禁用selinux</h3><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 永久性关闭selinux（重启服务器生效）</span></span><br><span class="line">sed -i <span class="string">'s/SELINUX=enforcing/SELINUX =disabled/'</span> /etc/selinux/config</span><br><span class="line"><span class="meta"># 临时关闭selinux（立即生效，重启服务器失效）</span></span><br><span class="line">setenforce <span class="number">0</span></span><br><span class="line"><span class="meta"># 查看selinux状态</span></span><br><span class="line">getenforce</span><br><span class="line"><span class="meta"># disabled为永久关闭，permissive为临时关闭，enforcing为开启</span></span><br></pre></td></tr></table></figure>
<h2 id="四、免密登陆"><a href="#四、免密登陆" class="headerlink" title="四、免密登陆"></a>四、免密登陆</h2><p>各个主机均执行以下操作：</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">## 生成密钥对</span><br><span class="line">ssh-keygen -t rsa   ## 一路回车即可</span><br><span class="line">## 进入.ssh目录，如果目录不存在则创建</span><br><span class="line">cd ~/.ssh</span><br><span class="line">## 将公钥导入至authorized_keys</span><br><span class="line">cat id_rsa.pub &gt;&gt; authorized_keys</span><br><span class="line">## 修改文件权限</span><br><span class="line">chmod <span class="number">700</span> ~/.ssh</span><br><span class="line">chmod <span class="number">600</span> authorized_keys</span><br></pre></td></tr></table></figure>
<p>在node1.ambari.com上执行：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">## 配置主从互相免密登陆</span><br><span class="line">[root@node1 ~]# <span class="keyword">cat</span> ~/.ssh/id_rsa.pub | ssh root@node2.ambari.<span class="keyword">com</span> <span class="string">'cat - &gt;&gt; ~/.ssh/authorized_keys'</span></span><br><span class="line">[root@node1 ~]# <span class="keyword">cat</span> ~/.ssh/id_rsa.pub | ssh root@node3.ambari.<span class="keyword">com</span> <span class="string">'cat - &gt;&gt; ~/.ssh/authorized_keys'</span></span><br><span class="line">ssh node2.ambari.<span class="keyword">com</span> </span><br><span class="line">ssh node3.ambari.<span class="keyword">com</span> # 验证主机点是否可以免密登陆从节点，执行<span class="keyword">exit</span>命令退出即可。</span><br></pre></td></tr></table></figure>
<p><strong>备注：</strong>要想实现多主机互相免密，可参考文章：<a href="https://841809077.github.io/2018/10/16/Linux多台主机互相免密.html" target="_blank" rel="noopener">Linux多台主机互相免密</a></p>
<h2 id="五、安装JDK"><a href="#五、安装JDK" class="headerlink" title="五、安装JDK"></a>五、安装JDK</h2><p>下载链接: <a href="https://pan.baidu.com/s/1rlqZejpZZqio9RPzgnGOEg" target="_blank" rel="noopener">https://pan.baidu.com/s/1rlqZejpZZqio9RPzgnGOEg</a> 提取码: j47n ；内有jdk-8u151-linux-x64.tar.gz和mysql-connector-java.jar文件。</p>
<ul>
<li>mkdir /usr/java；将下载的压缩包上传到java文件夹内</li>
<li>解压压缩包：tar zxvf jdk-8u151-linux-x64.tar.gz</li>
<li>配置jdk环境变量：</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑/etc/profile,文末插入以下内容：</span></span><br><span class="line"><span class="comment"># set java</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/java/jdk1.8.0_151</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$JAVA_HOME</span>/bin:$PATH</span><br></pre></td></tr></table></figure>
<ul>
<li>使环境变量生效：source /etc/profile</li>
<li>安装验证：java -version</li>
</ul>
<h2 id="六、安装mysql"><a href="#六、安装mysql" class="headerlink" title="六、安装mysql"></a>六、安装mysql</h2><p>mysql5.7 centos7:</p>
<p><a href="https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm" target="_blank" rel="noopener">https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm</a></p>
<p>mysql5.7 centos6:</p>
<p><a href="https://dev.mysql.com/get/mysql57-community-release-el6-11.noarch.rpm" target="_blank" rel="noopener">https://dev.mysql.com/get/mysql57-community-release-el6-11.noarch.rpm</a></p>
<p>mysql5.6 centos7:</p>
<p><a href="https://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm" target="_blank" rel="noopener">https://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm</a></p>
<p>mysql5.6 centos6:</p>
<p><a href="https://dev.mysql.com/get/mysql-community-release-el6-5.noarch.rpm" target="_blank" rel="noopener">https://dev.mysql.com/get/mysql-community-release-el6-5.noarch.rpm</a></p>
<h3 id="1-检查本地资源库中是否有mysql的rpm包"><a href="#1-检查本地资源库中是否有mysql的rpm包" class="headerlink" title="1. 检查本地资源库中是否有mysql的rpm包"></a>1. 检查本地资源库中是否有mysql的rpm包</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa <span class="string">| grep mysql</span></span><br><span class="line"><span class="meta"># 删除相关rpm包</span></span><br><span class="line">rpm -ev &lt;rpm包名&gt; --nodeps</span><br></pre></td></tr></table></figure>
<h3 id="2-搭建mysql5-7的yum源"><a href="#2-搭建mysql5-7的yum源" class="headerlink" title="2. 搭建mysql5.7的yum源"></a>2. 搭建mysql5.7的yum源</h3><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 下载mysql5.7的rpm包</span></span><br><span class="line">wget https:<span class="comment">//dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm</span></span><br><span class="line"><span class="meta"># 安装第一步下载的rpm文件，安装成功后/etc/yum.repos.d/目录下会增加两个文件</span></span><br><span class="line">yum -y install mysql57-community-release-el7<span class="number">-11.</span>noarch.rpm</span><br><span class="line"><span class="meta"># 查看mysql57的安装源是否可用，如不可用请自行修改配置文件（/etc/yum.repos.d/mysql-community.repo）使mysql57下面的enable=1</span></span><br><span class="line"><span class="meta"># 若有mysql其它版本的安装源可用，也请自行修改配置文件使其enable=0</span></span><br><span class="line">yum repolist enabled | grep mysql</span><br></pre></td></tr></table></figure>
<h3 id="3-安装mysql"><a href="#3-安装mysql" class="headerlink" title="3. 安装mysql"></a>3. 安装mysql</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> mysql-community-<span class="keyword">server</span></span><br></pre></td></tr></table></figure>
<h3 id="4-设置mysql"><a href="#4-设置mysql" class="headerlink" title="4. 设置mysql"></a>4. 设置mysql</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动mysql服务</span></span><br><span class="line">service mysqld <span class="keyword">start</span></span><br><span class="line"><span class="comment"># 查看root密码</span></span><br><span class="line">grep <span class="string">"password"</span> /<span class="keyword">var</span>/<span class="keyword">log</span>/mysqld.log</span><br><span class="line"><span class="comment"># 登陆mysql</span></span><br><span class="line">mysql -u root -p</span><br><span class="line">Enter <span class="keyword">password</span>: </span><br><span class="line"><span class="comment"># 为了可以设置简单密码</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> validate_password_policy=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> validate_password_length=<span class="number">4</span>;</span><br><span class="line"><span class="comment"># 立即修改密码，执行其他操作报错：</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">PASSWORD</span> <span class="keyword">FOR</span> <span class="string">'root'</span>@<span class="string">'localhost'</span> = <span class="keyword">PASSWORD</span>(<span class="string">'newpass'</span>);</span><br><span class="line"><span class="comment"># 我们创建密码为root123</span></span><br></pre></td></tr></table></figure>
<h3 id="5-新增ambari用户并增加权限"><a href="#5-新增ambari用户并增加权限" class="headerlink" title="5. 新增ambari用户并增加权限"></a>5. 新增ambari用户并增加权限</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -proot123</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">'ambari'</span>@<span class="string">'%'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'ambari'</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'ambari'</span>@<span class="string">'%'</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">'ambari'</span>@<span class="string">'localhost'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'ambari'</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'ambari'</span>@<span class="string">'localhost'</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">'ambari'</span>@<span class="string">'node1.ambari.com'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'ambari'</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'ambari'</span>@<span class="string">'node1.ambari.com'</span>;  //本地主机名</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br></pre></td></tr></table></figure>
<p><strong>注：</strong>删除用户命令：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Delete <span class="keyword">FROM</span><span class="built_in"> user </span>Where <span class="attribute">User</span>=<span class="string">'your_user'</span> <span class="keyword">and</span> <span class="attribute">Host</span>=<span class="string">'your_host'</span>;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<h3 id="6-使用ambari用户登陆并创建数据库"><a href="#6-使用ambari用户登陆并创建数据库" class="headerlink" title="6. 使用ambari用户登陆并创建数据库"></a>6. 使用ambari用户登陆并创建数据库</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -uambari -pambari</span><br><span class="line">CREATE DATABASE ambari;</span><br><span class="line"><span class="keyword">exit</span>;</span><br></pre></td></tr></table></figure>
<h2 id="七、设置时钟同步"><a href="#七、设置时钟同步" class="headerlink" title="七、设置时钟同步"></a>七、设置时钟同步</h2><p>自己写了一个脚本，前提条件是获取<code>/etc/hosts</code>文件内的主机ip</p>
<p>脚本如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line">host_list=$(sed -n <span class="string">'3,$p'</span> /etc/hosts | awk <span class="string">'&#123;print $1&#125;'</span>)</span><br><span class="line">master_hostip=$(sed -n 3p /etc/hosts | awk <span class="string">'&#123;print $1&#125;'</span>)</span><br><span class="line">ips_no_host=$(sed -n <span class="string">'4,$p'</span> /etc/hosts | awk <span class="string">'&#123;print $1&#125;'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历所有节点</span></span><br><span class="line"><span class="keyword">for</span> host <span class="keyword">in</span> <span class="variable">$host_list</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="comment"># 设置时区</span></span><br><span class="line">    ssh <span class="variable">$host</span> ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line">    <span class="comment"># 同步硬件时间</span></span><br><span class="line">    ssh <span class="variable">$host</span> hwclock --systohc</span><br><span class="line">    <span class="comment"># 开机自启动</span></span><br><span class="line">    ssh <span class="variable">$host</span> <span class="built_in">echo</span> service ntpd restart &gt;&gt; /etc/rc.d/rc.local</span><br><span class="line">    ssh <span class="variable">$host</span> <span class="built_in">echo</span> <span class="string">"hwclock --systohc"</span> &gt;&gt; /etc/rc.d/rc.local</span><br><span class="line">    ssh <span class="variable">$host</span> chmod +x /etc/rc.d/rc.local</span><br><span class="line">    <span class="comment"># 安装ntp服务</span></span><br><span class="line">    ssh <span class="variable">$host</span> yum install -y -q ntp</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment"># 主节点操作，修改配置文件</span></span><br><span class="line">sed -i -e <span class="string">'21 s/^/# /'</span> -i -e <span class="string">'22 s/^/# /'</span> -i -e <span class="string">'23 s/^/# /'</span> -i -e <span class="string">'24 s/^/# /'</span> /etc/ntp.conf</span><br><span class="line"><span class="built_in">echo</span> server 127.127.1.0 &gt;&gt; /etc/ntp.conf</span><br><span class="line"><span class="built_in">echo</span> fudge 127.127.1.0 stratum 10 &gt;&gt; /etc/ntp.conf</span><br><span class="line">service ntpd start</span><br><span class="line"><span class="comment"># 从节点操作，开启ntp服务，使用ntpdate命令进行时钟同步</span></span><br><span class="line"><span class="keyword">for</span> slave <span class="keyword">in</span> <span class="variable">$ips_no_host</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    ssh <span class="variable">$slave</span> service ntpd start</span><br><span class="line">    ssh <span class="variable">$slave</span> ntpdate -u <span class="variable">$master_hostip</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="八、搭建yum本地源"><a href="#八、搭建yum本地源" class="headerlink" title="八、搭建yum本地源"></a>八、搭建yum本地源</h2><h3 id="1-安装httpd和wget服务"><a href="#1-安装httpd和wget服务" class="headerlink" title="1. 安装httpd和wget服务"></a>1. 安装httpd和wget服务</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装httpd</span></span><br><span class="line">yum -y <span class="keyword">install</span> httpd.x86_64</span><br><span class="line">systemctl <span class="keyword">enable</span> httpd.service</span><br><span class="line">systemctl <span class="keyword">start</span> httpd.service</span><br><span class="line"><span class="comment"># 安装wget</span></span><br><span class="line">yum -y <span class="keyword">install</span> wget</span><br></pre></td></tr></table></figure>
<h3 id="2-下载ambari和hdp包"><a href="#2-下载ambari和hdp包" class="headerlink" title="2. 下载ambari和hdp包"></a>2. 下载ambari和hdp包</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 将tar包下载到/var/www/html</span><br><span class="line">cd /var/www/html</span><br><span class="line">wget http://<span class="meta">public</span>-repo-<span class="number">1.</span>hortonworks.com/ambari/centos7/<span class="number">2.</span>x/updates/<span class="number">2.7</span><span class="meta">.1</span><span class="meta">.0</span>/ambari-<span class="number">2.7</span><span class="meta">.1</span><span class="meta">.0</span>-centos7.tar.gz</span><br><span class="line">wget http://<span class="meta">public</span>-repo-<span class="number">1.</span>hortonworks.com/HDP/centos7/<span class="number">3.</span>x/updates/<span class="number">3.0</span><span class="meta">.1</span><span class="meta">.0</span>/HDP-<span class="number">3.0</span><span class="meta">.1</span><span class="meta">.0</span>-centos7-rpm.tar.gz</span><br><span class="line">wget http://<span class="meta">public</span>-repo-<span class="number">1.</span>hortonworks.com/HDP-UTILS-<span class="number">1.1</span><span class="meta">.0</span><span class="meta">.22</span>/repos/centos7/HDP-UTILS-<span class="number">1.1</span><span class="meta">.0</span><span class="meta">.22</span>-centos7.tar.gz</span><br><span class="line"># 解压上面三个包</span><br><span class="line">tar zxvf ambari-<span class="number">2.7</span><span class="meta">.1</span><span class="meta">.0</span>-centos7.tar.gz</span><br><span class="line">tar zxvf HDP-<span class="number">3.0</span><span class="meta">.1</span><span class="meta">.0</span>-centos7-rpm.tar.gz</span><br><span class="line">tar zxvf HDP-UTILS-<span class="number">1.1</span><span class="meta">.0</span><span class="meta">.22</span>-centos7.tar.gz</span><br></pre></td></tr></table></figure>
<h3 id="3-新建repo文件"><a href="#3-新建repo文件" class="headerlink" title="3. 新建repo文件"></a>3. 新建repo文件</h3><ul>
<li>新建ambari.repo文件</li>
</ul>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[ambari]</span></span><br><span class="line"><span class="attr">name</span>=ambari</span><br><span class="line"><span class="attr">baseurl</span>=http://node1.ambari.com/CentOS-<span class="number">7</span>/ambari-<span class="number">2.6</span>.<span class="number">0.0</span></span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">0</span></span><br></pre></td></tr></table></figure>
<ul>
<li>新建HDP.repo文件</li>
</ul>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[HDP]</span></span><br><span class="line"><span class="attr">name</span>=HDP</span><br><span class="line"><span class="attr">baseurl</span>=http://node1.ambari.com/CentOS-<span class="number">7</span>/HDP</span><br><span class="line"><span class="attr">path</span>=/</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">0</span></span><br></pre></td></tr></table></figure>
<ul>
<li>新建HDP-UTILS.repo文件</li>
</ul>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[HDP-UTILS]</span></span><br><span class="line"><span class="attr">name</span>=HDP-UTILS</span><br><span class="line"><span class="attr">baseurl</span>=http://liuyzh1.xdata/CentOS-<span class="number">7</span>/HDP-UTILS</span><br><span class="line"><span class="attr">path</span>=/</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>将以上文件放入<code>/etc/yum.repos.d/</code>目录下。</p>
<h2 id="九、在主节点安装ambari-server"><a href="#九、在主节点安装ambari-server" class="headerlink" title="九、在主节点安装ambari-server"></a>九、在主节点安装ambari-server</h2><h3 id="1-安装"><a href="#1-安装" class="headerlink" title="1. 安装"></a>1. 安装</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y <span class="keyword">install</span> ambari-<span class="keyword">server</span></span><br></pre></td></tr></table></figure>
<h3 id="2-将mysql-connector-java-jar拷贝到-usr-share-java目录下"><a href="#2-将mysql-connector-java-jar拷贝到-usr-share-java目录下" class="headerlink" title="2. 将mysql-connector-java.jar拷贝到/usr/share/java目录下"></a>2. 将mysql-connector-java.jar拷贝到/usr/share/java目录下</h3><h3 id="3-修改配置文件"><a href="#3-修改配置文件" class="headerlink" title="3. 修改配置文件"></a>3. 修改配置文件</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo server<span class="selector-class">.jdbc</span><span class="selector-class">.driver</span><span class="selector-class">.path</span>=/usr/share/java/mysql-connector-java<span class="selector-class">.jar</span> &gt;&gt; /etc/ambari-server/conf/ambari.properties</span><br></pre></td></tr></table></figure>
<h3 id="4-安装ambari-server"><a href="#4-安装ambari-server" class="headerlink" title="4. 安装ambari-server"></a>4. 安装ambari-server</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ambari-server <span class="built_in">setup</span></span><br></pre></td></tr></table></figure>
<h3 id="5-初始化数据库"><a href="#5-初始化数据库" class="headerlink" title="5. 初始化数据库"></a>5. 初始化数据库</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -uambari -pambari</span><br><span class="line">use ambari;</span><br><span class="line">source /var/<span class="class"><span class="keyword">lib</span>/<span class="title">ambari</span>-<span class="title">server</span>/<span class="title">resources</span>/<span class="title">Ambari</span>-<span class="title">DDL</span>-<span class="title">MySQL</span>-<span class="title">CREATE</span>.<span class="title">sql</span></span></span><br></pre></td></tr></table></figure>
<h3 id="6-启动ambari-server"><a href="#6-启动ambari-server" class="headerlink" title="6. 启动ambari-server"></a>6. 启动ambari-server</h3><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ambari-<span class="keyword">server</span> start</span><br></pre></td></tr></table></figure>
<p>登陆浏览器访问: <a href="http://192.168.162.41:8080/" target="_blank" rel="noopener">http://192.168.162.41:8080/</a> ，利用界面部署集群。</p>
<p>默认登陆账号/密码为：admin/admin。</p>
<h2 id="十-通过Ambari部署hadoop集群"><a href="#十-通过Ambari部署hadoop集群" class="headerlink" title="十. 通过Ambari部署hadoop集群"></a>十. 通过Ambari部署hadoop集群</h2><h3 id="1-打开-http-192-168-162-41-8080"><a href="#1-打开-http-192-168-162-41-8080" class="headerlink" title="1. 打开 http://192.168.162.41:8080/"></a>1. 打开 <a href="http://192.168.162.41:8080/" target="_blank" rel="noopener">http://192.168.162.41:8080/</a></h3><h3 id="2-点击-“LAUNCH-INSTALL-WIZARD”，开始创建一个集群"><a href="#2-点击-“LAUNCH-INSTALL-WIZARD”，开始创建一个集群" class="headerlink" title="2. 点击 “LAUNCH INSTALL WIZARD”，开始创建一个集群"></a>2. 点击 “LAUNCH INSTALL WIZARD”，开始创建一个集群</h3><p><img src="/img/posts/1018938-20190213153345489-1926070939.png" alt="img"></p>
<h3 id="3-为集群取一个名字"><a href="#3-为集群取一个名字" class="headerlink" title="3. 为集群取一个名字"></a>3. 为集群取一个名字</h3><p><img src="/img/posts/1018938-20190213153523347-52923322.png" alt="img"></p>
<h3 id="4-前面我们建了本地的资源库，这里选择-“Use-Local-Repository”。删除其它的-OS，只留-redhat7-那一行。并且在-Base-URL-那一列里填入前面搭建的-web-服务对应的地址。"><a href="#4-前面我们建了本地的资源库，这里选择-“Use-Local-Repository”。删除其它的-OS，只留-redhat7-那一行。并且在-Base-URL-那一列里填入前面搭建的-web-服务对应的地址。" class="headerlink" title="4. 前面我们建了本地的资源库，这里选择 “Use Local Repository”。删除其它的 OS，只留 redhat7 那一行。并且在 Base URL 那一列里填入前面搭建的 web 服务对应的地址。"></a>4. 前面我们建了本地的资源库，这里选择 “Use Local Repository”。删除其它的 OS，只留 redhat7 那一行。并且在 Base URL 那一列里填入前面搭建的 web 服务对应的地址。</h3><p><img src="/img/posts/1018938-20190213154624127-1706048039.png" alt="img"></p>
<h3 id="5-在-“Target-Hosts”-里填入-hadoop-集群需要部署到哪些机器。可以填-IP。"><a href="#5-在-“Target-Hosts”-里填入-hadoop-集群需要部署到哪些机器。可以填-IP。" class="headerlink" title="5. 在 “Target Hosts” 里填入 hadoop 集群需要部署到哪些机器。可以填 IP。"></a>5. 在 “Target Hosts” 里填入 hadoop 集群需要部署到哪些机器。可以填 IP。</h3><p>   SSH Private Key 里选择的文件是Ambari中配置免密登陆到其它机器的那台机器的 id_rsa 这个文件。我用的是 root 帐号，所以这个文件是在 /root/.ssh/ 目录下。</p>
<p><img src="/img/posts/1018938-20190213155152959-1760562938.png" alt="img"></p>
<h3 id="6-“Confirm-Hosts”-这一步，ambari-会在上面的配置的-hosts-中安装-ambari-agent，只需等待即可。"><a href="#6-“Confirm-Hosts”-这一步，ambari-会在上面的配置的-hosts-中安装-ambari-agent，只需等待即可。" class="headerlink" title="6. “Confirm Hosts” 这一步，ambari 会在上面的配置的 hosts 中安装 ambari agent，只需等待即可。"></a>6. “Confirm Hosts” 这一步，ambari 会在上面的配置的 hosts 中安装 ambari agent，只需等待即可。</h3><h3 id="7-根据需要，选择服务。如果某些服务依赖其它服务，而没有选择依赖的服务的话，点击“Next”时，会做相应的提示。"><a href="#7-根据需要，选择服务。如果某些服务依赖其它服务，而没有选择依赖的服务的话，点击“Next”时，会做相应的提示。" class="headerlink" title="7. 根据需要，选择服务。如果某些服务依赖其它服务，而没有选择依赖的服务的话，点击“Next”时，会做相应的提示。"></a>7. 根据需要，选择服务。如果某些服务依赖其它服务，而没有选择依赖的服务的话，点击“Next”时，会做相应的提示。</h3><p><img src="/img/posts/1018938-20190213160805482-832416055.png" alt="img"></p>
<h3 id="8-点击-“Next”，如果出现类似下面的警告的话，可以不用管，后续如果需要的话，可以再安装"><a href="#8-点击-“Next”，如果出现类似下面的警告的话，可以不用管，后续如果需要的话，可以再安装" class="headerlink" title="8. 点击 “Next”，如果出现类似下面的警告的话，可以不用管，后续如果需要的话，可以再安装"></a>8. 点击 “Next”，如果出现类似下面的警告的话，可以不用管，后续如果需要的话，可以再安装</h3><p><img src="/img/posts/1018938-20190213161023760-747911424.png" alt="img"></p>
<h3 id="9-“Assign-Masters”-这一步，ambari-会自动分配各种服务到不同的机器上。可以手动进行调整。"><a href="#9-“Assign-Masters”-这一步，ambari-会自动分配各种服务到不同的机器上。可以手动进行调整。" class="headerlink" title="9. “Assign Masters” 这一步，ambari 会自动分配各种服务到不同的机器上。可以手动进行调整。"></a>9. “Assign Masters” 这一步，ambari 会自动分配各种服务到不同的机器上。可以手动进行调整。</h3><p><img src="/img/posts/1018938-20190213161420248-1335496466.png" alt="img"></p>
<h3 id="10-“Assign-Slaves-and-Clients”-这一步，手动分配-Hadoop-的-DataNode-节点位置，YARN-的-NodeManager-的位置……"><a href="#10-“Assign-Slaves-and-Clients”-这一步，手动分配-Hadoop-的-DataNode-节点位置，YARN-的-NodeManager-的位置……" class="headerlink" title="10. “Assign Slaves and Clients” 这一步，手动分配 Hadoop 的 DataNode 节点位置，YARN 的 NodeManager 的位置……"></a>10. “Assign Slaves and Clients” 这一步，手动分配 Hadoop 的 DataNode 节点位置，YARN 的 NodeManager 的位置……</h3><p>​      其中 NFSGateway 是通过挂载的方式，像访问本地文件系统一样访问 Hadoop 的文件系统。</p>
<p>​     Phoenix Query Server 是一个HBase的开源SQL引擎。你可以使用标准的JDBC API代替HBase客户端API来创建表，插入数据，查询你的HBase数据。</p>
<p><img src="/img/posts/1018938-20190213161641118-570282848.png" alt="img"></p>
<h3 id="11-设置密码。（有一行的-username-是-N-A，比较奇怪，不知道用在哪）"><a href="#11-设置密码。（有一行的-username-是-N-A，比较奇怪，不知道用在哪）" class="headerlink" title="11. 设置密码。（有一行的 username 是 N/A，比较奇怪，不知道用在哪）"></a>11. 设置密码。（有一行的 username 是 N/A，比较奇怪，不知道用在哪）</h3><p><img src="/img/posts/1018938-20190213162420460-2048281560.png" alt="img"></p>
<h3 id="12-数据库配置。如果选择了安装-hive-或-Ranger，需要输入相关的数据库的信息。此例中没有这一步。"><a href="#12-数据库配置。如果选择了安装-hive-或-Ranger，需要输入相关的数据库的信息。此例中没有这一步。" class="headerlink" title="12. 数据库配置。如果选择了安装 hive 或 Ranger，需要输入相关的数据库的信息。此例中没有这一步。"></a>12. 数据库配置。如果选择了安装 hive 或 Ranger，需要输入相关的数据库的信息。此例中没有这一步。</h3><h3 id="13-目录配置。配置各个服务需要用到的目录。使用默认值即可。"><a href="#13-目录配置。配置各个服务需要用到的目录。使用默认值即可。" class="headerlink" title="13. 目录配置。配置各个服务需要用到的目录。使用默认值即可。"></a>13. 目录配置。配置各个服务需要用到的目录。使用默认值即可。</h3><p><img src="/img/posts/1018938-20190213162702914-100179058.png" alt="img"></p>
<h3 id="14-创建用户。默认情况下，-ambari-会为每个服务创建一个-linux-的用户，用不同的用户启动不同的服务。我设成了同一个用户。"><a href="#14-创建用户。默认情况下，-ambari-会为每个服务创建一个-linux-的用户，用不同的用户启动不同的服务。我设成了同一个用户。" class="headerlink" title="14. 创建用户。默认情况下， ambari 会为每个服务创建一个 linux 的用户，用不同的用户启动不同的服务。我设成了同一个用户。"></a>14. 创建用户。默认情况下， ambari 会为每个服务创建一个 linux 的用户，用不同的用户启动不同的服务。我设成了同一个用户。</h3><p><img src="/img/posts/1018938-20190213163109597-2035489965.png" alt="img"></p>
<h3 id="15-“ALL-CONFIGURATIONS”，这一步可以修改前面的一些配置"><a href="#15-“ALL-CONFIGURATIONS”，这一步可以修改前面的一些配置" class="headerlink" title="15. “ALL CONFIGURATIONS”，这一步可以修改前面的一些配置"></a>15. “ALL CONFIGURATIONS”，这一步可以修改前面的一些配置</h3><p><img src="/img/posts/1018938-20190213163315310-1496310353.png" alt="img"></p>
<h3 id="16-点击-“Next”后，出现总结页。可以下载创建这个集群的元数据信息。点击-“DEPLOY”-后，就开始部署了。"><a href="#16-点击-“Next”后，出现总结页。可以下载创建这个集群的元数据信息。点击-“DEPLOY”-后，就开始部署了。" class="headerlink" title="16. 点击 “Next”后，出现总结页。可以下载创建这个集群的元数据信息。点击 “DEPLOY” 后，就开始部署了。"></a>16. 点击 “Next”后，出现总结页。可以下载创建这个集群的元数据信息。点击 “DEPLOY” 后，就开始部署了。</h3><p> <img src="/img/posts/1018938-20190213163717889-1369946602.png" alt="img"></p>

    </div>
    
    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="/" target="_blank">Ljjyy.com</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/archives/2019/06/100320.html" class="pre-post btn btn-default" title='大数据hadoop之 十四.Hive原理解析'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">大数据hadoop之 十四.Hive原理解析</span>
        </a>
    
    
        <a href="/archives/2019/06/100318.html" class="next-post btn btn-default" title='大数据hadoop之 十二.SSH免密钥登录'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">大数据hadoop之 十二.SSH免密钥登录</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
    <div id="vcomments" class="valine"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>

    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: '5MzTXYXkt03k101j0PmSDN34-gzGzoHsz',
            appKey: 'iwjYgwno6qj3wtDVVSbe8nYQ',
            placeholder: '说点什么吧',
            notify: false,
            verify: true,
            avatar: 'mm',
            meta: 'nick,mail'.split(','),
            pageSize: '10',
            path: window.location.pathname,
            lang: 'zh-CN'.toLowerCase()
        })
    </script>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Ambari简介"><span class="toc-text">Ambari简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ambari概述"><span class="toc-text">Ambari概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ambari体系结构"><span class="toc-text">Ambari体系结构</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#安装配置"><span class="toc-text">安装配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、配置说明"><span class="toc-text">一、配置说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、修改主机名和hosts文件"><span class="toc-text">二、修改主机名和hosts文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-修改主机名（三台主机都执行）"><span class="toc-text">1. 修改主机名（三台主机都执行）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-修改hosts文件"><span class="toc-text">2. 修改hosts文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、关闭防火墙和selinux"><span class="toc-text">三、关闭防火墙和selinux</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-防火墙设置"><span class="toc-text">1. 防火墙设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-禁用selinux"><span class="toc-text">2. 禁用selinux</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、免密登陆"><span class="toc-text">四、免密登陆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、安装JDK"><span class="toc-text">五、安装JDK</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、安装mysql"><span class="toc-text">六、安装mysql</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-检查本地资源库中是否有mysql的rpm包"><span class="toc-text">1. 检查本地资源库中是否有mysql的rpm包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-搭建mysql5-7的yum源"><span class="toc-text">2. 搭建mysql5.7的yum源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-安装mysql"><span class="toc-text">3. 安装mysql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-设置mysql"><span class="toc-text">4. 设置mysql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-新增ambari用户并增加权限"><span class="toc-text">5. 新增ambari用户并增加权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-使用ambari用户登陆并创建数据库"><span class="toc-text">6. 使用ambari用户登陆并创建数据库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#七、设置时钟同步"><span class="toc-text">七、设置时钟同步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#八、搭建yum本地源"><span class="toc-text">八、搭建yum本地源</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-安装httpd和wget服务"><span class="toc-text">1. 安装httpd和wget服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-下载ambari和hdp包"><span class="toc-text">2. 下载ambari和hdp包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-新建repo文件"><span class="toc-text">3. 新建repo文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#九、在主节点安装ambari-server"><span class="toc-text">九、在主节点安装ambari-server</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-安装"><span class="toc-text">1. 安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-将mysql-connector-java-jar拷贝到-usr-share-java目录下"><span class="toc-text">2. 将mysql-connector-java.jar拷贝到/usr/share/java目录下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-修改配置文件"><span class="toc-text">3. 修改配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-安装ambari-server"><span class="toc-text">4. 安装ambari-server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-初始化数据库"><span class="toc-text">5. 初始化数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-启动ambari-server"><span class="toc-text">6. 启动ambari-server</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#十-通过Ambari部署hadoop集群"><span class="toc-text">十. 通过Ambari部署hadoop集群</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-打开-http-192-168-162-41-8080"><span class="toc-text">1. 打开 http://192.168.162.41:8080/</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-点击-“LAUNCH-INSTALL-WIZARD”，开始创建一个集群"><span class="toc-text">2. 点击 “LAUNCH INSTALL WIZARD”，开始创建一个集群</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-为集群取一个名字"><span class="toc-text">3. 为集群取一个名字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-前面我们建了本地的资源库，这里选择-“Use-Local-Repository”。删除其它的-OS，只留-redhat7-那一行。并且在-Base-URL-那一列里填入前面搭建的-web-服务对应的地址。"><span class="toc-text">4. 前面我们建了本地的资源库，这里选择 “Use Local Repository”。删除其它的 OS，只留 redhat7 那一行。并且在 Base URL 那一列里填入前面搭建的 web 服务对应的地址。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-在-“Target-Hosts”-里填入-hadoop-集群需要部署到哪些机器。可以填-IP。"><span class="toc-text">5. 在 “Target Hosts” 里填入 hadoop 集群需要部署到哪些机器。可以填 IP。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-“Confirm-Hosts”-这一步，ambari-会在上面的配置的-hosts-中安装-ambari-agent，只需等待即可。"><span class="toc-text">6. “Confirm Hosts” 这一步，ambari 会在上面的配置的 hosts 中安装 ambari agent，只需等待即可。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-根据需要，选择服务。如果某些服务依赖其它服务，而没有选择依赖的服务的话，点击“Next”时，会做相应的提示。"><span class="toc-text">7. 根据需要，选择服务。如果某些服务依赖其它服务，而没有选择依赖的服务的话，点击“Next”时，会做相应的提示。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-点击-“Next”，如果出现类似下面的警告的话，可以不用管，后续如果需要的话，可以再安装"><span class="toc-text">8. 点击 “Next”，如果出现类似下面的警告的话，可以不用管，后续如果需要的话，可以再安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-“Assign-Masters”-这一步，ambari-会自动分配各种服务到不同的机器上。可以手动进行调整。"><span class="toc-text">9. “Assign Masters” 这一步，ambari 会自动分配各种服务到不同的机器上。可以手动进行调整。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-“Assign-Slaves-and-Clients”-这一步，手动分配-Hadoop-的-DataNode-节点位置，YARN-的-NodeManager-的位置……"><span class="toc-text">10. “Assign Slaves and Clients” 这一步，手动分配 Hadoop 的 DataNode 节点位置，YARN 的 NodeManager 的位置……</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-设置密码。（有一行的-username-是-N-A，比较奇怪，不知道用在哪）"><span class="toc-text">11. 设置密码。（有一行的 username 是 N/A，比较奇怪，不知道用在哪）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-数据库配置。如果选择了安装-hive-或-Ranger，需要输入相关的数据库的信息。此例中没有这一步。"><span class="toc-text">12. 数据库配置。如果选择了安装 hive 或 Ranger，需要输入相关的数据库的信息。此例中没有这一步。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-目录配置。配置各个服务需要用到的目录。使用默认值即可。"><span class="toc-text">13. 目录配置。配置各个服务需要用到的目录。使用默认值即可。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-创建用户。默认情况下，-ambari-会为每个服务创建一个-linux-的用户，用不同的用户启动不同的服务。我设成了同一个用户。"><span class="toc-text">14. 创建用户。默认情况下， ambari 会为每个服务创建一个 linux 的用户，用不同的用户启动不同的服务。我设成了同一个用户。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-“ALL-CONFIGURATIONS”，这一步可以修改前面的一些配置"><span class="toc-text">15. “ALL CONFIGURATIONS”，这一步可以修改前面的一些配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-点击-“Next”后，出现总结页。可以下载创建这个集群的元数据信息。点击-“DEPLOY”-后，就开始部署了。"><span class="toc-text">16. 点击 “Next”后，出现总结页。可以下载创建这个集群的元数据信息。点击 “DEPLOY” 后，就开始部署了。</span></a></li></ol></li></ol></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2019-2023&emsp;<a href="/" class="copyright-links" target="_blank" rel="nofollow">Ljjyy.com</a>
                </span> |
                <span>
                    <a href="/about/" class="copyright-links" target="_blank" rel="nofollow">关于我们</a>
                </span> |                
                <span>
                    <a href="/sitemap.xml" class="copyright-links" target="_blank" rel="nofollow">网站地图</a>
                </span> |
                <span>
                    <a href="/archives/" class="copyright-links" target="_blank" rel="nofollow">时间轴</a>
                </span>              
            </div>
        </div>
    </div>
</div>







<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>